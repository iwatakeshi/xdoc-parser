"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _ = require("lodash");
/* Documentation */
/**
 * Removes undefined, null, and false properties from an object.
 *
 * # API
 *
 * ```
 * @param object
 * ```
 */
function sanitize(object) {
    // Object.keys(object).forEach((key) => (object[key] == null) && delete object[key]);
    return _.pickBy(object);
}
/**
 * Creates a Documentation node.
 *
 * # API
 *
 * ```
 * @param body: BodyNode - The body node. See. {@link XDocASTNode.ts::BodyNode}
 * @param text?: string - The string representation of the body node.
 * @return DocumentationNode - See {@link XDocASTNode.ts::DocumentationNode}.
 * ```
 */
function createDocumentationNode(body, text) {
    return { documentation: sanitize({ body, text }) };
}
exports.createDocumentationNode = createDocumentationNode;
/**
 * Creates a Body node.
 */
function createBodyNode(annotations, text) {
    return sanitize({ annotations, text });
}
exports.createBodyNode = createBodyNode;
/* Tag */
function createTagNode(name, identifier, type, expression, description, text) {
    return sanitize(Object.assign({}, name, identifier, { type }, expression, description, text));
}
exports.createTagNode = createTagNode;
function createTagNameNode(name, text) {
    return sanitize({ name, text });
}
exports.createTagNameNode = createTagNameNode;
function createTagIdentifierNode(identifier, property, text) {
    let node = {};
    if (identifier)
        Object.assign(node, { identifier, text });
    else if (property)
        Object.assign(node, { property, text });
    return sanitize(node);
}
exports.createTagIdentifierNode = createTagIdentifierNode;
function createOptionalTagIdentifierNode(identifier) {
    return identifier;
}
exports.createOptionalTagIdentifierNode = createOptionalTagIdentifierNode;
function createPropertyTagIdentifierNode(property, text) {
    return sanitize({ property, text });
}
exports.createPropertyTagIdentifierNode = createPropertyTagIdentifierNode;
function createIdentifierNode(text, optional = false, property) {
    if (!optional)
        optional = false;
    if (!property)
        property = [];
    return { identifier: sanitize({ optional, property, text }) };
}
exports.createIdentifierNode = createIdentifierNode;
function createOptionalIdentifierNode(optional = true, property, text) {
    return createIdentifierNode(text, optional, property);
}
exports.createOptionalIdentifierNode = createOptionalIdentifierNode;
/* Type */
/**
 *
 * Creates a Type node.
 *
 * # API
 *
 * ```
 * @export
 * @function createTypeNode
 * @param type: UnionTypeNode
 * | LambdaTypeNode
 * | TupleTypeNode
 * | PrimaryTypeNode
 * | ParenthesizedTypeNode
 * | UnaryTypeNode
 * | ObjectTypeNode
 * | ArrayTypeNode
 * | PropertyTypeNode
 * - The type of node to create.
 * @param optional = false
 * - Determines whether the type of node is optional.
 * ```
 */
function createTypeNode(type, optional = false, text) {
    return Object.assign({}, type, sanitize({ optional, text }));
}
exports.createTypeNode = createTypeNode;
/**
 * Creates an IntersectionType node.
 *
 * # API
 *
 * ```
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createIntersectTypeNode(left, right, text) {
    return { intersect: sanitize({ left, right, text }) };
}
exports.createIntersectTypeNode = createIntersectTypeNode;
/**
 * Creates an UnionType node.
 *
 * # API
 *
 * ```
 * @export
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createUnionTypeNode(left, right, text) {
    return { union: sanitize({ left, right, text }) };
}
exports.createUnionTypeNode = createUnionTypeNode;
/**
 * Creates a LambdaType node.
 *
 * # API
 *
 * ```
 * - The single parameter in a lambda type.
 * @param parameters: FormalParameterSequencce | undefined[] | null
 * - The sequence of parameters in a lambda type.
 * @param type: TypeNode
 * - The return type in a lambda type.
 * ```
 */
function createLambdaTypeNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return { lambda: sanitize({ parameters, type, text }) };
}
exports.createLambdaTypeNode = createLambdaTypeNode;
function createFormalParemeterSequenceNode(parameters, text) {
    return { parameters, text };
}
exports.createFormalParemeterSequenceNode = createFormalParemeterSequenceNode;
function createParameterNode(identifier, type, text) {
    return sanitize({ identifier, type, text });
}
exports.createParameterNode = createParameterNode;
function createTupleTypeNode(identifier, types, text) {
    return sanitize({ identifier, types, text });
}
exports.createTupleTypeNode = createTupleTypeNode;
function createPrimaryTypeNode(primary, text) {
    return sanitize({ primary, text });
}
exports.createPrimaryTypeNode = createPrimaryTypeNode;
function createKeywordNode(text) {
    return { keyword: { text } };
}
exports.createKeywordNode = createKeywordNode;
function createParenthesizedTypeNode(type, optional = false, text) {
    return { parenthesized: sanitize({ type, optional, text }) };
}
exports.createParenthesizedTypeNode = createParenthesizedTypeNode;
function createUnaryTypeNode(operator, right, text) {
    return { unary: sanitize({ operator, right, text }) };
}
exports.createUnaryTypeNode = createUnaryTypeNode;
function createObjectTypeNode(object, text) {
    if (!object)
        object = [];
    return sanitize({ object, text });
}
exports.createObjectTypeNode = createObjectTypeNode;
function createObjectPairTypeNode(key, value, text) {
    return sanitize({ key, value, text });
}
exports.createObjectPairTypeNode = createObjectPairTypeNode;
function createArrayTypeNode(type, types, text) {
    if (!types)
        types = [];
    return { array: sanitize({ type, types, text }) };
}
exports.createArrayTypeNode = createArrayTypeNode;
function createPropertyIdentifierNode(property, text) {
    return createIdentifierNode(text, false, property);
}
exports.createPropertyIdentifierNode = createPropertyIdentifierNode;
;
/* Expression */
function createExpressionNode(expression, text) {
    return sanitize({ expression, text });
}
exports.createExpressionNode = createExpressionNode;
function createUnaryExpressionNode(operator, right, text) {
    return { unary: sanitize({ operator, right, text }) };
}
exports.createUnaryExpressionNode = createUnaryExpressionNode;
function createBinaryExpressionNode(operator, left, right, text) {
    return { binary: sanitize({ left, right, operator, text }) };
}
exports.createBinaryExpressionNode = createBinaryExpressionNode;
function createArrayExpressionNode(array, text) {
    if (!array)
        array = [];
    return sanitize({ array, text });
}
exports.createArrayExpressionNode = createArrayExpressionNode;
function createObjectExpressionNode(object, text) {
    if (!object)
        object = [];
    return sanitize({ object, text });
}
exports.createObjectExpressionNode = createObjectExpressionNode;
function createObjectPairExpressionNode(key, value, text) {
    return sanitize({ key, value, text });
}
exports.createObjectPairExpressionNode = createObjectPairExpressionNode;
function createLambdaExpressionNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return createLambdaTypeNode(parameters, type, text);
}
exports.createLambdaExpressionNode = createLambdaExpressionNode;
function createParenthesizedExpressioneNode(expression, optional = false, text) {
    return { parenthesized: sanitize({ expression, optional, text }) };
}
exports.createParenthesizedExpressioneNode = createParenthesizedExpressioneNode;
;
function createLiteralExpressionNode(type, text) {
    return { literal: sanitize({ type, text }) };
}
exports.createLiteralExpressionNode = createLiteralExpressionNode;
function createDescriptionNode(text, inlines) {
    if (!inlines)
        inlines = [];
    return { description: sanitize({ text, inlines }) };
}
exports.createDescriptionNode = createDescriptionNode;
function createInlineTagNode(identifier, body, text) {
    return sanitize({ identifier, body, text });
}
exports.createInlineTagNode = createInlineTagNode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVE5vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVE5vZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0QkFBNEI7QUFDNUIsbUJBQW1CO0FBRW5COzs7Ozs7OztHQVFHO0FBQ0gsU0FBUyxRQUFRLENBQUksTUFBTTtJQUN6QixxRkFBcUY7SUFDckYsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBZSxDQUFBO0FBQ3ZDLENBQUM7QUFFRDs7Ozs7Ozs7OztHQVVHO0FBQ0gsU0FBZ0IsdUJBQXVCLENBQ3JDLElBQXVCLEVBQ3ZCLElBQWE7SUFFYixPQUFPLEVBQUUsYUFBYSxFQUFFLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUE7QUFDcEQsQ0FBQztBQUxELDBEQUtDO0FBU0Q7O0dBRUc7QUFDSCxTQUFnQixjQUFjLENBQzVCLFdBQXFDLEVBQ3JDLElBQWE7SUFFYixPQUFPLFFBQVEsQ0FBQyxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO0FBQ3hDLENBQUM7QUFMRCx3Q0FLQztBQVNELFNBQVM7QUFFVCxTQUFnQixhQUFhLENBQzNCLElBQTBCLEVBQzFCLFVBQWdFLEVBQ2hFLElBQXVCLEVBQ3ZCLFVBQW1DLEVBQ25DLFdBQXFDLEVBQ3JDLElBQWE7SUFFYixPQUFPLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ2hHLENBQUM7QUFURCxzQ0FTQztBQVdELFNBQWdCLGlCQUFpQixDQUMvQixJQUE2QixFQUM3QixJQUFhO0lBRWIsT0FBTyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtBQUNqQyxDQUFDO0FBTEQs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QVUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO0FBQ3JFLENBQUM7QUFORCxnRkFNQztBQU9BLENBQUM7QUFHRixTQUFnQiwyQkFBMkIsQ0FDekMsSUFBWSxFQUNaLElBQVk7SUFFWixPQUFPLEVBQUUsT0FBTyxFQUFFLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUE7QUFDOUMsQ0FBQztBQUxELGtFQUtDO0FBU0QsU0FBZ0IscUJBQXFCLENBQ25DLElBQVksRUFDWixPQUFrQztJQUVsQyxJQUFJLENBQUMsT0FBTztRQUFFLE9BQU8sR0FBRyxFQUFFLENBQUE7SUFDMUIsT0FBTyxFQUFFLFdBQVcsRUFBRSxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUFBO0FBQ3JELENBQUM7QUFORCxzREFNQztBQVNELFNBQWdCLG1CQUFtQixDQUNqQyxVQUFtQyxFQUNuQyxJQUFZLEVBQ1osSUFBYTtJQUViLE9BQU8sUUFBUSxDQUFDLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO0FBQzdDLENBQUM7QUFORCxrREFNQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuLyogRG9jdW1lbnRhdGlvbiAqL1xuXG4vKipcbiAqIFJlbW92ZXMgdW5kZWZpbmVkLCBudWxsLCBhbmQgZmFsc2UgcHJvcGVydGllcyBmcm9tIGFuIG9iamVjdC5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAcGFyYW0gb2JqZWN0XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gc2FuaXRpemU8VD4ob2JqZWN0KSB7XG4gIC8vIE9iamVjdC5rZXlzKG9iamVjdCkuZm9yRWFjaCgoa2V5KSA9PiAob2JqZWN0W2tleV0gPT0gbnVsbCkgJiYgZGVsZXRlIG9iamVjdFtrZXldKTtcbiAgcmV0dXJuIF8ucGlja0J5KG9iamVjdCkgYXMgUGFydGlhbDxUPlxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBEb2N1bWVudGF0aW9uIG5vZGUuXG4gKiBcbiAqICMgQVBJXG4gKiBcbiAqIGBgYFxuICogQHBhcmFtIGJvZHk6IEJvZHlOb2RlIC0gVGhlIGJvZHkgbm9kZS4gU2VlLiB7QGxpbmsgWERvY0FTVE5vZGUudHM6OkJvZHlOb2RlfVxuICogQHBhcmFtIHRleHQ/OiBzdHJpbmcgLSBUaGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBib2R5IG5vZGUuXG4gKiBAcmV0dXJuIERvY3VtZW50YXRpb25Ob2RlIC0gU2VlIHtAbGluayBYRG9jQVNUTm9kZS50czo6RG9jdW1lbnRhdGlvbk5vZGV9LlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEb2N1bWVudGF0aW9uTm9kZShcbiAgYm9keTogUGFydGlhbDxCb2R5Tm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8RG9jdW1lbnRhdGlvbk5vZGU+IHtcbiAgcmV0dXJuIHsgZG9jdW1lbnRhdGlvbjogc2FuaXRpemUoeyBib2R5LCB0ZXh0IH0pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudGF0aW9uTm9kZSB7XG4gIGRvY3VtZW50YXRpb246IHtcbiAgICBib2R5PzogUGFydGlhbDxCb2R5Tm9kZT4sXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIEJvZHkgbm9kZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJvZHlOb2RlKFxuICBhbm5vdGF0aW9uczogUGFydGlhbDxBbm5vdGF0aW9uc05vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPEJvZHlOb2RlPiB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IGFubm90YXRpb25zLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9keU5vZGUge1xuICBhbm5vdGF0aW9uczogUGFydGlhbDxBbm5vdGF0aW9uc05vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCB0eXBlIEFubm90YXRpb25zTm9kZSA9IFBhcnRpYWw8VGFnTm9kZT5bXSB8IHVuZGVmaW5lZFtdO1xuXG4vKiBUYWcgKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhZ05vZGUoXG4gIG5hbWU6IFBhcnRpYWw8VGFnTmFtZU5vZGU+LFxuICBpZGVudGlmaWVyOiBQYXJ0aWFsPFRhZ0lkZW50aWZpZXJOb2RlPiB8IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxuICB0eXBlOiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgZXhwcmVzc2lvbjogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXG4gIGRlc2NyaXB0aW9uOiBQYXJ0aWFsPERlc2NyaXB0aW9uTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFRhZ05vZGUge1xuICByZXR1cm4gc2FuaXRpemUoT2JqZWN0LmFzc2lnbih7fSwgbmFtZSwgaWRlbnRpZmllciwgeyB0eXBlIH0sIGV4cHJlc3Npb24sIGRlc2NyaXB0aW9uLCB0ZXh0KSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGFnTm9kZSB7XG4gIG5hbWU/OiBQYXJ0aWFsPFRhZ05hbWVOb2RlPixcbiAgaWRlbnRpZmllcj86UGFydGlhbCA8VGFnSWRlbnRpZmllck5vZGU+LFxuICB0eXBlPzogUGFydGlhbDxUeXBlTm9kZT4sXG4gIGV4cHJlc3Npb24/OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgZGVzY3JpcHRpb24/OiBQYXJ0aWFsPERlc2NyaXB0aW9uTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhZ05hbWVOb2RlKFxuICBuYW1lOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxUYWdOYW1lTm9kZT4ge1xuICByZXR1cm4gc2FuaXRpemUoeyBuYW1lLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGFnTmFtZU5vZGUge1xuICBuYW1lOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFnSWRlbnRpZmllck5vZGUoXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxPcHRpb25hbElkZW50aWZpZXJOb2RlPiB8IHVuZGVmaW5lZCxcbiAgcHJvcGVydHk/OiBQYXJ0aWFsPFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGU+IHwgdW5kZWZpbmVkLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPFRhZ0lkZW50aWZpZXJOb2RlPiB7XG4gIGxldCBub2RlID0ge31cbiAgaWYgKGlkZW50aWZpZXIpIE9iamVjdC5hc3NpZ24obm9kZSwgeyBpZGVudGlmaWVyLCB0ZXh0IH0pXG4gIGVsc2UgaWYgKHByb3BlcnR5KSBPYmplY3QuYXNzaWduKG5vZGUsIHsgcHJvcGVydHksIHRleHQgfSlcbiAgcmV0dXJuIHNhbml0aXplKG5vZGUpO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ0lkZW50aWZpZXJOb2RlIHtcbiAgaWRlbnRpZmllcj86IElkZW50aWZpZXJOb2RlIHwgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZVxuICBwcm9wZXJ0eT86IFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUoXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8T3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZT5cbik6IFBhcnRpYWw8T3B0aW9uYWxJZGVudGlmaWVyTm9kZT4ge1xuICByZXR1cm4gaWRlbnRpZmllcjtcbn1cblxuZXhwb3J0IHR5cGUgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSA9IE9wdGlvbmFsSWRlbnRpZmllck5vZGU7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUoXG4gIHByb3BlcnR5OiBQYXJ0aWFsPChJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUpPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT4ge1xuICByZXR1cm4gc2FuaXRpemU8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT4oeyBwcm9wZXJ0eSwgdGV4dCB9KVxufVxuZXhwb3J0IGludGVyZmFjZSBQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlIHtcbiAgLy8gU2hvcnRjdXQgb2YgT3B0aW9uYWxUYWdPcklkZW50aWZpZXJcbiAgcHJvcGVydHk6IChJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUpW10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSWRlbnRpZmllck5vZGUoXG4gIHRleHQ6IHN0cmluZyxcbiAgb3B0aW9uYWwgPSBmYWxzZSxcbiAgcHJvcGVydHk/OiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4pOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPiB7XG4gIGlmICghb3B0aW9uYWwpIG9wdGlvbmFsID0gZmFsc2U7XG4gIGlmICghcHJvcGVydHkpIHByb3BlcnR5ID0gW11cblxuICByZXR1cm4geyBpZGVudGlmaWVyOiBzYW5pdGl6ZSh7IG9wdGlvbmFsLCBwcm9wZXJ0eSwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSWRlbnRpZmllck5vZGUge1xuICBpZGVudGlmaWVyOiB7XG4gICAgb3B0aW9uYWw/OiBib29sZWFuLFxuICAgIHByb3BlcnR5PzogSWRlbnRpZmllck5vZGVbXSB8IHVuZGVmaW5lZFtdXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPcHRpb25hbElkZW50aWZpZXJOb2RlKFxuICBvcHRpb25hbCA9IHRydWUsXG4gIHByb3BlcnR5OiBJZGVudGlmaWVyTm9kZVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8T3B0aW9uYWxJZGVudGlmaWVyTm9kZT4ge1xuICByZXR1cm4gY3JlYXRlSWRlbnRpZmllck5vZGUodGV4dCwgb3B0aW9uYWwsIHByb3BlcnR5KTtcbn1cblxuZXhwb3J0IHR5cGUgT3B0aW9uYWxJZGVudGlmaWVyTm9kZSA9IElkZW50aWZpZXJOb2RlXG5cblxuLyogVHlwZSAqL1xuXG4vKipcbiAqIFxuICogQ3JlYXRlcyBhIFR5cGUgbm9kZS5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAZXhwb3J0XG4gKiBAZnVuY3Rpb24gY3JlYXRlVHlwZU5vZGVcbiAqIEBwYXJhbSB0eXBlOiBVbmlvblR5cGVOb2RlXG4gKiB8IExhbWJkYVR5cGVOb2RlXG4gKiB8IFR1cGxlVHlwZU5vZGVcbiAqIHwgUHJpbWFyeVR5cGVOb2RlXG4gKiB8IFBhcmVudGhlc2l6ZWRUeXBlTm9kZVxuICogfCBVbmFyeVR5cGVOb2RlXG4gKiB8IE9iamVjdFR5cGVOb2RlXG4gKiB8IEFycmF5VHlwZU5vZGVcbiAqIHwgUHJvcGVydHlUeXBlTm9kZVxuICogLSBUaGUgdHlwZSBvZiBub2RlIHRvIGNyZWF0ZS5cbiAqIEBwYXJhbSBvcHRpb25hbCA9IGZhbHNlIFxuICogLSBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHR5cGUgb2Ygbm9kZSBpcyBvcHRpb25hbC5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHlwZU5vZGUoXG4gIHR5cGU6IFBhcnRpYWw8SW50ZXJzZWN0VHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPFVuaW9uVHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPExhbWJkYVR5cGVOb2RlPlxuICAgIHwgUGFydGlhbDxUdXBsZVR5cGVOb2RlPlxuICAgIHwgUGFydGlhbDxQcmltYXJ5VHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRUeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8VW5hcnlUeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8T2JqZWN0VHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPEFycmF5VHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPFByb3BlcnR5SWRlbnRpZmllck5vZGU+LFxuICBvcHRpb25hbCA9IGZhbHNlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPFR5cGVOb2RlPiB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0eXBlLCBzYW5pdGl6ZSh7IG9wdGlvbmFsLCB0ZXh0IH0pKVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFR5cGVOb2RlIHtcbiAgaW50ZXJzZWN0PzogSW50ZXJzZWN0VHlwZU5vZGUsXG4gIHVuaW9uPzogVW5pb25UeXBlTm9kZSxcbiAgbGFtYmRhPzogTGFtYmRhVHlwZU5vZGUsXG4gIHR1cGxlPzogVHVwbGVUeXBlTm9kZSxcbiAgcHJpbWFyeT86IFByaW1hcnlUeXBlTm9kZSxcbiAgcGFyZW50aGVzaXplZD86IFBhcmVudGhlc2l6ZWRUeXBlTm9kZSxcbiAgdW5hcnk/OiBVbmFyeVR5cGVOb2RlLFxuICBvYmplY3Q/OiBPYmplY3RUeXBlTm9kZSxcbiAgYXJyYXk/OiBBcnJheVR5cGVOb2RlLFxuICBwcm9wZXJ0eT86IFByb3BlcnR5SWRlbnRpZmllck5vZGUsXG4gIG9wdGlvbmFsPzogYm9vbGVhbixcbiAgdGV4dD86IHN0cmluZ1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gSW50ZXJzZWN0aW9uVHlwZSBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBwdWJsaWMgbGVmdDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgbGVmdC1oYW5kIHNpZGUuXG4gKiBAcHVibGljIHJpZ2h0OiBUeXBlTm9kZSAtIFRoZSB0eXBlIG9mIG5vZGUgdGhhdCBhcHBlYXJzIG9uIHRoZSByaWdodC1oYW5kIHNpZGUuXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludGVyc2VjdFR5cGVOb2RlKFxuICBsZWZ0OiBUeXBlTm9kZSxcbiAgcmlnaHQ6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPEludGVyc2VjdFR5cGVOb2RlPiB7XG4gIHJldHVybiB7IGludGVyc2VjdDogc2FuaXRpemUoeyBsZWZ0LCByaWdodCwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW50ZXJzZWN0VHlwZU5vZGUge1xuICBpbnRlcnNlY3Q6IHtcbiAgICBsZWZ0PzogVHlwZU5vZGUsXG4gICAgcmlnaHQ/OiBUeXBlTm9kZSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuXG4vKipcbiAqIENyZWF0ZXMgYW4gVW5pb25UeXBlIG5vZGUuXG4gKiBcbiAqICMgQVBJXG4gKiBcbiAqIGBgYFxuICogQGV4cG9ydFxuICogQHB1YmxpYyBsZWZ0OiBUeXBlTm9kZSAtIFRoZSB0eXBlIG9mIG5vZGUgdGhhdCBhcHBlYXJzIG9uIHRoZSBsZWZ0LWhhbmQgc2lkZS5cbiAqIEBwdWJsaWMgcmlnaHQ6IFR5cGVOb2RlIC0gVGhlIHR5cGUgb2Ygbm9kZSB0aGF0IGFwcGVhcnMgb24gdGhlIHJpZ2h0LWhhbmQgc2lkZS5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVW5pb25UeXBlTm9kZShcbiAgbGVmdDogVHlwZU5vZGUsXG4gIHJpZ2h0OiBUeXBlTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxVbmlvblR5cGVOb2RlPntcbiAgcmV0dXJuIHsgdW5pb246IHNhbml0aXplKHsgbGVmdCwgcmlnaHQsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuaW9uVHlwZU5vZGUge1xuICB1bmlvbjoge1xuICAgIGxlZnQ/OiBUeXBlTm9kZSxcbiAgICByaWdodD86IFR5cGVOb2RlLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBMYW1iZGFUeXBlIG5vZGUuXG4gKiBcbiAqICMgQVBJXG4gKiBcbiAqIGBgYFxuICogLSBUaGUgc2luZ2xlIHBhcmFtZXRlciBpbiBhIGxhbWJkYSB0eXBlLlxuICogQHBhcmFtIHBhcmFtZXRlcnM6IEZvcm1hbFBhcmFtZXRlclNlcXVlbmNjZSB8IHVuZGVmaW5lZFtdIHwgbnVsbFxuICogLSBUaGUgc2VxdWVuY2Ugb2YgcGFyYW1ldGVycyBpbiBhIGxhbWJkYSB0eXBlLlxuICogQHBhcmFtIHR5cGU6IFR5cGVOb2RlXG4gKiAtIFRoZSByZXR1cm4gdHlwZSBpbiBhIGxhbWJkYSB0eXBlLlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMYW1iZGFUeXBlTm9kZShcbiAgcGFyYW1ldGVyczogUGFydGlhbDxGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGU+IHwgdW5kZWZpbmVkW10sXG4gIHR5cGU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPExhbWJkYVR5cGVOb2RlPiB7XG4gIGlmICghcGFyYW1ldGVycykgcGFyYW1ldGVycyA9IFtdXG4gIHJldHVybiB7IGxhbWJkYTogc2FuaXRpemUoeyBwYXJhbWV0ZXJzLCB0eXBlLCB0ZXh0IH0pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMYW1iZGFUeXBlTm9kZSB7XG4gIGxhbWJkYToge1xuICAgIHBhcmFtZXRlcnM/OiBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUgfCB1bmRlZmluZWRbXSxcbiAgICB0eXBlPzogVHlwZU5vZGUsXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVGb3JtYWxQYXJlbWV0ZXJTZXF1ZW5jZU5vZGUoXG4gIHBhcmFtZXRlcnM6IFBhcnRpYWw8UGFyYW1ldGVyTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUge1xuICByZXR1cm4geyBwYXJhbWV0ZXJzLCB0ZXh0IH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUge1xuICBwYXJhbWV0ZXJzOiBQYXJ0aWFsPFBhcmFtZXRlck5vZGU+W10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGFyYW1ldGVyTm9kZShcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIHR5cGU/OiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxQYXJhbWV0ZXJOb2RlPiB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IGlkZW50aWZpZXIsIHR5cGUsIHRleHQgfSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXJhbWV0ZXJOb2RlIHtcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIHR5cGU/OiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHVwbGVUeXBlTm9kZShcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIHR5cGVzOiBQYXJ0aWFsPFR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8VHVwbGVUeXBlTm9kZT4ge1xuICByZXR1cm4gc2FuaXRpemUoeyBpZGVudGlmaWVyLCB0eXBlcywgdGV4dCB9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFR1cGxlVHlwZU5vZGUge1xuICBpZGVudGlmaWVyPzogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIHR5cGVzOiBQYXJ0aWFsPFR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByaW1hcnlUeXBlTm9kZShcbiAgcHJpbWFyeTogUGFydGlhbDxPcHRpb25hbElkZW50aWZpZXJOb2RlPiB8IFBhcnRpYWw8KElkZW50aWZpZXJOb2RlIHwgS2V5d29yZE5vZGUpPiB8IFBhcnRpYWw8UHJvcGVydHlJZGVudGlmaWVyTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8UHJpbWFyeVR5cGVOb2RlPiB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IHByaW1hcnksIHRleHQgfSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcmltYXJ5VHlwZU5vZGUge1xuICBwcmltYXJ5OiBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxJZGVudGlmaWVyTm9kZT4gfCBLZXl3b3JkTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlS2V5d29yZE5vZGUoXG4gIHRleHQ6IHN0cmluZyB8IFwibnVsbFwiIHwgXCJ1bmRlZmluZWRcIlxuKTogS2V5d29yZE5vZGUge1xuICByZXR1cm4geyBrZXl3b3JkOiB7IHRleHQgfSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2V5d29yZE5vZGUge1xuICBrZXl3b3JkOiB7XG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJlbnRoZXNpemVkVHlwZU5vZGUoXG4gIHR5cGU6IFBhcnRpYWw8VHlwZU5vZGU+LFxuICBvcHRpb25hbCA9IGZhbHNlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRUeXBlTm9kZT4ge1xuICByZXR1cm4geyBwYXJlbnRoZXNpemVkOiBzYW5pdGl6ZSh7IHR5cGUsIG9wdGlvbmFsLCB0ZXh0IH0pIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyZW50aGVzaXplZFR5cGVOb2RlIHtcbiAgcGFyZW50aGVzaXplZDoge1xuICAgIHR5cGU/OiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVW5hcnlUeXBlTm9kZShcbiAgb3BlcmF0b3I6IHN0cmluZyB8IFwiJlwiIHwgXCIqXCIsXG4gIHJpZ2h0OiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8VW5hcnlUeXBlTm9kZT4ge1xuICByZXR1cm4geyB1bmFyeTogc2FuaXRpemUoeyBvcGVyYXRvciwgcmlnaHQsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuYXJ5VHlwZU5vZGUge1xuICB1bmFyeToge1xuICAgIG9wZXJhdG9yPzogc3RyaW5nIHwgXCImXCIgfCBcIipcIixcbiAgICByaWdodD86IFBhcnRpYWw8UHJpbWFyeVR5cGVOb2RlPixcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdFR5cGVOb2RlKFxuICBvYmplY3Q/OiBQYXJ0aWFsPE9iamVjdFBhaXJUeXBlTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPE9iamVjdFR5cGVOb2RlPiB7XG4gIGlmICghb2JqZWN0KSBvYmplY3QgPSBbXTtcbiAgcmV0dXJuIHNhbml0aXplKHsgb2JqZWN0LCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0VHlwZU5vZGUge1xuICBvYmplY3Q6IFBhcnRpYWw8T2JqZWN0UGFpclR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdFBhaXJUeXBlTm9kZShcbiAga2V5OiBUeXBlTm9kZSxcbiAgdmFsdWU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPE9iamVjdFBhaXJUeXBlTm9kZT4ge1xuICByZXR1cm4gc2FuaXRpemUoeyBrZXksIHZhbHVlLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0UGFpclR5cGVOb2RlIHtcbiAga2V5OiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgdmFsdWU6IFBhcnRpYWw8VHlwZU5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBcnJheVR5cGVOb2RlKFxuICB0eXBlOiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgdHlwZXM6IFBhcnRpYWw8VHlwZU5vZGU+W10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogQXJyYXlUeXBlTm9kZSB7XG4gIGlmICghdHlwZXMpIHR5cGVzID0gW107XG5cbiAgcmV0dXJuIHsgYXJyYXk6IHNhbml0aXplKHsgdHlwZSwgdHlwZXMsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFycmF5VHlwZU5vZGUge1xuICBhcnJheToge1xuICAgIHR5cGU/OiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgICB0eXBlcz86IFBhcnRpYWw8VHlwZU5vZGU+W10gfCB1bmRlZmluZWRbXSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5SWRlbnRpZmllck5vZGUoXG4gIHByb3BlcnR5OiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ6IHN0cmluZ1xuKTogUGFydGlhbDxQcm9wZXJ0eUlkZW50aWZpZXJOb2RlPiB7XG4gIHJldHVybiBjcmVhdGVJZGVudGlmaWVyTm9kZSh0ZXh0LCBmYWxzZSwgcHJvcGVydHkpXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3BlcnR5SWRlbnRpZmllck5vZGUgZXh0ZW5kcyBJZGVudGlmaWVyTm9kZSB7IH1cblxuXG4vKiBFeHByZXNzaW9uICovXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUV4cHJlc3Npb25Ob2RlKFxuICBleHByZXNzaW9uOlxuICAgIFBhcnRpYWw8VW5hcnlFeHByZXNzaW9uTm9kZT5cbiAgICB8IFBhcnRpYWw8QmluYXJ5RXhwcmVzc2lvbk5vZGU+XG4gICAgfCBQYXJ0aWFsPEFycmF5RXhwcmVzc2lvbk5vZGU+XG4gICAgfCBQYXJ0aWFsPE9iamVjdEV4cHJlc3Npb25Ob2RlPlxuICAgIHwgUGFydGlhbDxMYW1iZGFFeHByZXNzaW9uTm9kZT5cbiAgICB8IFBhcnRpYWw8TGl0ZXJhbEV4cHJlc3Npb25Ob2RlPlxuICAgIHwgUGFydGlhbDxQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nLFxuKTogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4ge1xuICByZXR1cm4gc2FuaXRpemUoeyBleHByZXNzaW9uLCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXhwcmVzc2lvbk5vZGUge1xuICBleHByZXNzaW9uOlxuICBVbmFyeUV4cHJlc3Npb25Ob2RlXG4gIHwgQmluYXJ5RXhwcmVzc2lvbk5vZGVcbiAgfCBBcnJheUV4cHJlc3Npb25Ob2RlXG4gIHwgT2JqZWN0RXhwcmVzc2lvbk5vZGVcbiAgfCBMYW1iZGFFeHByZXNzaW9uTm9kZVxuICB8IExpdGVyYWxFeHByZXNzaW9uTm9kZVxuICB8IFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZVxuICB0ZXh0Pzogc3RyaW5nXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbk5vZGUoXG4gIG9wZXJhdG9yOiBzdHJpbmcgfCAnKycgfCAnLScsXG4gIHJpZ2h0OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxVbmFyeUV4cHJlc3Npb25Ob2RlPiB7XG4gIHJldHVybiB7IHVuYXJ5OiBzYW5pdGl6ZSh7IG9wZXJhdG9yLCByaWdodCwgdGV4dCB9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5hcnlFeHByZXNzaW9uTm9kZSB7XG4gIHVuYXJ5OiB7XG4gICAgb3BlcmF0b3I/OiBzdHJpbmcgfCAnKycgfCAnLScsXG4gICAgcmlnaHQ/OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJpbmFyeUV4cHJlc3Npb25Ob2RlKFxuICBvcGVyYXRvcjogc3RyaW5nIHwgJysnIHwgJy0nLFxuICBsZWZ0OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgcmlnaHQ6IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPEJpbmFyeUV4cHJlc3Npb25Ob2RlPiB7XG4gIHJldHVybiB7IGJpbmFyeTogc2FuaXRpemUoeyBsZWZ0LCByaWdodCwgb3BlcmF0b3IsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJpbmFyeUV4cHJlc3Npb25Ob2RlIHtcbiAgYmluYXJ5OiB7XG4gICAgb3BlcmF0b3I/OiBzdHJpbmcgfCAnKycgfCAnLScgfCAnKicgfCAnLycsXG4gICAgbGVmdD86IEV4cHJlc3Npb25Ob2RlLFxuICAgIHJpZ2h0PzogRXhwcmVzc2lvbk5vZGUsXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBcnJheUV4cHJlc3Npb25Ob2RlKFxuICBhcnJheT86IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+W10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8QXJyYXlFeHByZXNzaW9uTm9kZT4ge1xuICBpZiAoIWFycmF5KSBhcnJheSA9IFtdO1xuICByZXR1cm4gc2FuaXRpemUoeyBhcnJheSwgdGV4dCB9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFycmF5RXhwcmVzc2lvbk5vZGUge1xuICBhcnJheT86IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+W10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdEV4cHJlc3Npb25Ob2RlKFxuICBvYmplY3Q/OiBQYXJ0aWFsPE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZT5bXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxPYmplY3RFeHByZXNzaW9uTm9kZT4ge1xuICBpZiAoIW9iamVjdCkgb2JqZWN0ID0gW11cbiAgcmV0dXJuIHNhbml0aXplKHsgb2JqZWN0LCB0ZXh0IH0pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0RXhwcmVzc2lvbk5vZGUge1xuICBvYmplY3Q6IFBhcnRpYWw8T2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlPltdLFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUoXG4gIGtleTogUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+LFxuICB2YWx1ZTogUGFydGlhbDxPYmplY3RFeHByZXNzaW9uTm9kZT4gfCBQYXJ0aWFsPExpdGVyYWxFeHByZXNzaW9uTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8T2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlPiB7XG4gIHJldHVybiBzYW5pdGl6ZSh7IGtleSwgdmFsdWUsIHRleHQgfSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUge1xuICBrZXk6IFBhcnRpYWw8TGl0ZXJhbEV4cHJlc3Npb25Ob2RlPixcbiAgdmFsdWU6IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+IHwgUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMYW1iZGFFeHByZXNzaW9uTm9kZShcbiAgcGFyYW1ldGVyczogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHwgdW5kZWZpbmVkW10sXG4gIHR5cGU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPExhbWJkYUV4cHJlc3Npb25Ob2RlPiB7XG4gIGlmICghcGFyYW1ldGVycykgcGFyYW1ldGVycyA9IFtdXG4gIHJldHVybiBjcmVhdGVMYW1iZGFUeXBlTm9kZShwYXJhbWV0ZXJzLCB0eXBlLCB0ZXh0KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExhbWJkYUV4cHJlc3Npb25Ob2RlIGV4dGVuZHMgTGFtYmRhVHlwZU5vZGUgeyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJlbnRoZXNpemVkRXhwcmVzc2lvbmVOb2RlKFxuICBleHByZXNzaW9uOiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgb3B0aW9uYWwgPSBmYWxzZSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGU+IHtcbiAgcmV0dXJuIHsgcGFyZW50aGVzaXplZDogc2FuaXRpemUoeyBleHByZXNzaW9uLCBvcHRpb25hbCwgdGV4dCB9KSB9O1xufVxuZXhwb3J0IGludGVyZmFjZSBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGUgeyBcbiAgcGFyZW50aGVzaXplZDoge1xuICAgIGV4cHJlc3Npb24/OiBFeHByZXNzaW9uTm9kZSxcbiAgICBvcHRpb25hbD86IGJvb2xlYW4sXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59O1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMaXRlcmFsRXhwcmVzc2lvbk5vZGUoXG4gIHR5cGU6IHN0cmluZyxcbiAgdGV4dDogc3RyaW5nXG4pOiBQYXJ0aWFsPExpdGVyYWxFeHByZXNzaW9uTm9kZT4ge1xuICByZXR1cm4geyBsaXRlcmFsOiBzYW5pdGl6ZSh7IHR5cGUsIHRleHQgfSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpdGVyYWxFeHByZXNzaW9uTm9kZSB7XG4gIGxpdGVyYWw6IHtcbiAgICB0eXBlPzogc3RyaW5nLFxuICAgIHRleHQ/OiBzdHJpbmcsXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlc2NyaXB0aW9uTm9kZShcbiAgdGV4dDogc3RyaW5nLFxuICBpbmxpbmVzPzogUGFydGlhbDxJbmxpbmVUYWdOb2RlPltdXG4pOiBQYXJ0aWFsPERlc2NyaXB0aW9uTm9kZT4ge1xuICBpZiAoIWlubGluZXMpIGlubGluZXMgPSBbXVxuICByZXR1cm4geyBkZXNjcmlwdGlvbjogc2FuaXRpemUoeyB0ZXh0LCBpbmxpbmVzIH0pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXNjcmlwdGlvbk5vZGUge1xuICBkZXNjcmlwdGlvbjoge1xuICAgIHRleHQ/OiBzdHJpbmcsXG4gICAgaW5saW5lcz86IFBhcnRpYWw8SW5saW5lVGFnTm9kZT5bXVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbmxpbmVUYWdOb2RlKFxuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcbiAgYm9keTogc3RyaW5nLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPElubGluZVRhZ05vZGU+IHtcbiAgcmV0dXJuIHNhbml0aXplKHsgaWRlbnRpZmllciwgYm9keSwgdGV4dCB9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElubGluZVRhZ05vZGUge1xuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcbiAgYm9keT86IHN0cmluZyxcbiAgdGV4dD86IHN0cmluZ1xufSJdfQ==