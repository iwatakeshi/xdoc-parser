"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _ = require("lodash");
/* Documentation */
/**
 * Removes undefined, null, and false properties from an object.
 *
 * # API
 *
 * ```
 * @param object
 * ```
 */
function sanitize(object) {
    // Object.keys(object).forEach((key) => (object[key] == null) && delete object[key]);
    return _.pickBy(object);
}
/**
 *
 * Merges multiple objects into a single object
 *
 * # API
 *
 * ```
 * @function join
 * @param to: object - The target object.
 * @param from: object[] - The objects to merge.
 * ```
 */
function join(to, ...from) {
    return from.reduce(function (b, a) {
        for (var key in a)
            b[key] = a[key];
        return b;
    }, to);
}
/**
 * Creates a Documentation node.
 *
 * # API
 *
 * ```
 * @param body: BodyNode - The body node. See. {@link XDocASTNode.ts::BodyNode}
 * @param text?: string - The string representation of the body node.
 * @return DocumentationNode - See {@link XDocASTNode.ts::DocumentationNode}.
 * ```
 */
function createDocumentationNode(body, text) {
    return { documentation: join(sanitize({ body }), body.text ? { text: body.text } : {}) };
}
exports.createDocumentationNode = createDocumentationNode;
/**
 * Creates a Body node.
 */
function createBodyNode(annotations, text) {
    return join(sanitize({ annotations }), text ? { text } : {});
}
exports.createBodyNode = createBodyNode;
/* Tag */
function createTagNode(name, identifier, type, expression, description, text) {
    const object = Object.assign({}, name, identifier, type, expression, description);
    return join(sanitize(object), text ? { text } : {});
}
exports.createTagNode = createTagNode;
function createTagNameNode(name, text) {
    return join(sanitize({ name }), text ? { text } : {});
}
exports.createTagNameNode = createTagNameNode;
function createTagIdentifierNode(identifier, property, text) {
    let node = {};
    if (identifier)
        Object.assign(node, { identifier });
    else if (property)
        Object.assign(node, { property });
    return join(sanitize(node), text ? { text } : {});
}
exports.createTagIdentifierNode = createTagIdentifierNode;
function createOptionalTagIdentifierNode(identifier) {
    return identifier;
}
exports.createOptionalTagIdentifierNode = createOptionalTagIdentifierNode;
function createPropertyTagIdentifierNode(property, text) {
    return join(sanitize({ property }), text ? { text } : {});
}
exports.createPropertyTagIdentifierNode = createPropertyTagIdentifierNode;
function createIdentifierNode(text, optional = false, property) {
    if (!optional)
        optional = false;
    if (!property)
        property = [];
    return { identifier: join(sanitize({ optional, property }), text ? { text } : {}) };
}
exports.createIdentifierNode = createIdentifierNode;
function createOptionalIdentifierNode(optional = true, property, text) {
    return createIdentifierNode(text, optional, property);
}
exports.createOptionalIdentifierNode = createOptionalIdentifierNode;
/* Type */
/**
 *
 * Creates a Type node.
 *
 * # API
 *
 * ```
 * @export
 * @function createTypeNode
 * @param type: UnionTypeNode
 * | LambdaTypeNode
 * | TupleTypeNode
 * | PrimaryTypeNode
 * | ParenthesizedTypeNode
 * | UnaryTypeNode
 * | ObjectTypeNode
 * | ArrayTypeNode
 * | PropertyTypeNode
 * - The type of node to create.
 * @param optional = false
 * - Determines whether the type of node is optional.
 * ```
 */
function createTypeNode(type, optional = false, text) {
    return join({ type }, sanitize({ optional }), text ? { text } : {});
}
exports.createTypeNode = createTypeNode;
/**
 * Creates an IntersectionType node.
 *
 * # API
 *
 * ```
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createIntersectTypeNode(left, right, text) {
    return { intersect: join(sanitize({ left, right }), text ? { text } : {}) };
}
exports.createIntersectTypeNode = createIntersectTypeNode;
/**
 * Creates an UnionType node.
 *
 * # API
 *
 * ```
 * @export
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createUnionTypeNode(left, right, text) {
    return { union: join(sanitize({ left, right }), text ? { text } : {}) };
}
exports.createUnionTypeNode = createUnionTypeNode;
/**
 * Creates a LambdaType node.
 *
 * # API
 *
 * ```
 * - The single parameter in a lambda type.
 * @param parameters: FormalParameterSequencce | undefined[] | null
 * - The sequence of parameters in a lambda type.
 * @param type: TypeNode
 * - The return type in a lambda type.
 * ```
 */
function createLambdaTypeNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return { lambda: join(sanitize({ parameters, type }), text ? { text } : {}) };
}
exports.createLambdaTypeNode = createLambdaTypeNode;
function createFormalParemeterSequenceNode(parameters, text) {
    return { parameters, text };
}
exports.createFormalParemeterSequenceNode = createFormalParemeterSequenceNode;
function createParameterNode(identifier, type, text) {
    return join(sanitize({ identifier, type }), text ? { text } : {});
}
exports.createParameterNode = createParameterNode;
function createTupleTypeNode(identifier, types, text) {
    return { tuple: join(sanitize({ identifier, types }), text ? { text } : {}) };
}
exports.createTupleTypeNode = createTupleTypeNode;
function createTupleExtendedTypeNode(type, heritage, text) {
    return join(sanitize({ type, heritage }), text ? { text } : {});
}
exports.createTupleExtendedTypeNode = createTupleExtendedTypeNode;
function createPrimaryTypeNode(primary, text) {
    return join(sanitize({ primary }), text ? { text } : {});
}
exports.createPrimaryTypeNode = createPrimaryTypeNode;
function createKeywordNode(text) {
    return { keyword: text ? { text } : {} };
}
exports.createKeywordNode = createKeywordNode;
function createParenthesizedTypeNode(type, optional = false, text) {
    return { parenthesized: join(sanitize({ type, optional }), text ? { text } : {}) };
}
exports.createParenthesizedTypeNode = createParenthesizedTypeNode;
function createUnaryTypeNode(operator, right, text) {
    return { unary: join(sanitize({ operator, right }), text ? { text } : {}) };
}
exports.createUnaryTypeNode = createUnaryTypeNode;
function createObjectTypeNode(object, text) {
    if (!object)
        object = [];
    return join(sanitize({ object }), text ? { text } : {});
}
exports.createObjectTypeNode = createObjectTypeNode;
function createObjectPairTypeNode(key, value, text) {
    return join(sanitize({ key, value }), text ? { text } : {});
}
exports.createObjectPairTypeNode = createObjectPairTypeNode;
function createArrayTypeNode(type, types, text) {
    if (!types)
        types = [];
    return { array: join(sanitize({ type, types }), text ? { text } : {}) };
}
exports.createArrayTypeNode = createArrayTypeNode;
function createPropertyIdentifierNode(property, text) {
    return createIdentifierNode(text, false, property);
}
exports.createPropertyIdentifierNode = createPropertyIdentifierNode;
;
/* Expression */
function createExpressionNode(expression, text) {
    return join(sanitize({ expression }), text ? { text } : {});
}
exports.createExpressionNode = createExpressionNode;
function createUnaryExpressionNode(operator, right, text) {
    return { unary: join(sanitize({ operator, right }), text ? { text } : {}) };
}
exports.createUnaryExpressionNode = createUnaryExpressionNode;
function createBinaryExpressionNode(operator, left, right, text) {
    return { binary: join(sanitize({ left, right, operator }), text ? { text } : {}) };
}
exports.createBinaryExpressionNode = createBinaryExpressionNode;
function createArrayExpressionNode(array, text) {
    if (!array)
        array = [];
    return join(sanitize({ array }), text ? { text } : {});
}
exports.createArrayExpressionNode = createArrayExpressionNode;
function createObjectExpressionNode(object, text) {
    if (!object)
        object = [];
    return join(sanitize({ object }), text ? { text } : {});
}
exports.createObjectExpressionNode = createObjectExpressionNode;
function createObjectPairExpressionNode(key, value, text) {
    return join(sanitize({ key, value }), text ? { text } : {});
}
exports.createObjectPairExpressionNode = createObjectPairExpressionNode;
function createLambdaExpressionNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return createLambdaTypeNode(parameters, type, text);
}
exports.createLambdaExpressionNode = createLambdaExpressionNode;
function createParenthesizedExpressioneNode(expression, optional = false, text) {
    return { parenthesized: join(sanitize({ expression, optional }), text ? { text } : {}) };
}
exports.createParenthesizedExpressioneNode = createParenthesizedExpressioneNode;
;
function createLiteralExpressionNode(type, text) {
    return { literal: join(sanitize({ type }), text ? { text } : {}) };
}
exports.createLiteralExpressionNode = createLiteralExpressionNode;
function createDescriptionNode(text, inlines) {
    if (!inlines)
        inlines = [];
    return { description: join(sanitize({ inlines }), text ? { text } : {}) };
}
exports.createDescriptionNode = createDescriptionNode;
function createInlineTagNode(identifier, body, text) {
    return join(sanitize({ identifier, body }), text ? { text } : {});
}
exports.createInlineTagNode = createInlineTagNode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVE5vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVE5vZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0QkFBNEI7QUFDNUIsbUJBQW1CO0FBRW5COzs7Ozs7OztHQVFHO0FBQ0gsa0JBQXFCLE1BQWM7SUFDakMscUZBQXFGO0lBQ3JGLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQWUsQ0FBQTtBQUN2QyxDQUFDO0FBRUQ7Ozs7Ozs7Ozs7O0dBV0c7QUFDSCxjQUFpQixFQUFVLEVBQUUsR0FBRyxJQUFjO0lBQzVDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO1FBQy9CLEtBQUssSUFBSSxHQUFHLElBQUksQ0FBQztZQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbkMsT0FBTyxDQUFDLENBQUM7SUFDWCxDQUFDLEVBQUUsRUFBRSxDQUFlLENBQUM7QUFDdkIsQ0FBQztBQUVEOzs7Ozs7Ozs7O0dBVUc7QUFDSCxpQ0FDRSxJQUF1QixFQUN2QixJQUFhO0lBRWIsT0FBTyxFQUFFLGFBQWEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUE7QUFDMUYsQ0FBQztBQUxELDBEQUtDO0FBU0Q7O0dBRUc7QUFDSCx3QkFDRSxXQUFxQyxFQUNyQyxJQUFhO0lBRWIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQy9E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QyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztBQUMzRixDQUFDO0FBTkQsZ0ZBTUM7QUFPQSxDQUFDO0FBR0YscUNBQ0UsSUFBWSxFQUNaLElBQVk7SUFFWixPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQTtBQUNwRSxDQUFDO0FBTEQsa0VBS0M7QUFTRCwrQkFDRSxJQUFZLEVBQ1osT0FBa0M7SUFFbEMsSUFBSSxDQUFDLE9BQU87UUFBRSxPQUFPLEdBQUcsRUFBRSxDQUFBO0lBQzFCLE9BQU8sRUFBRSxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFBO0FBQzNFLENBQUM7QUFORCxzREFNQztBQVNELDZCQUNFLFVBQW1DLEVBQ25DLElBQVksRUFDWixJQUFhO0lBRWIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQTtBQUNuRSxDQUFDO0FBTkQsa0RBTUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBfIGZyb20gXCJsb2Rhc2hcIjtcclxuLyogRG9jdW1lbnRhdGlvbiAqL1xyXG5cclxuLyoqXHJcbiAqIFJlbW92ZXMgdW5kZWZpbmVkLCBudWxsLCBhbmQgZmFsc2UgcHJvcGVydGllcyBmcm9tIGFuIG9iamVjdC5cclxuICogXHJcbiAqICMgQVBJXHJcbiAqIFxyXG4gKiBgYGBcclxuICogQHBhcmFtIG9iamVjdFxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIHNhbml0aXplPFQ+KG9iamVjdDogb2JqZWN0KSB7XHJcbiAgLy8gT2JqZWN0LmtleXMob2JqZWN0KS5mb3JFYWNoKChrZXkpID0+IChvYmplY3Rba2V5XSA9PSBudWxsKSAmJiBkZWxldGUgb2JqZWN0W2tleV0pO1xyXG4gIHJldHVybiBfLnBpY2tCeShvYmplY3QpIGFzIFBhcnRpYWw8VD5cclxufVxyXG5cclxuLyoqXHJcbiAqIFxyXG4gKiBNZXJnZXMgbXVsdGlwbGUgb2JqZWN0cyBpbnRvIGEgc2luZ2xlIG9iamVjdFxyXG4gKiBcclxuICogIyBBUElcclxuICogXHJcbiAqIGBgYFxyXG4gKiBAZnVuY3Rpb24gam9pblxyXG4gKiBAcGFyYW0gdG86IG9iamVjdCAtIFRoZSB0YXJnZXQgb2JqZWN0LlxyXG4gKiBAcGFyYW0gZnJvbTogb2JqZWN0W10gLSBUaGUgb2JqZWN0cyB0byBtZXJnZS5cclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBqb2luPFQ+KHRvOiBvYmplY3QsIC4uLmZyb206IG9iamVjdFtdKSB7XHJcbiAgcmV0dXJuIGZyb20ucmVkdWNlKGZ1bmN0aW9uIChiLCBhKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gYSkgYltrZXldID0gYVtrZXldO1xyXG4gICAgcmV0dXJuIGI7XHJcbiAgfSwgdG8pIGFzIFBhcnRpYWw8VD47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgRG9jdW1lbnRhdGlvbiBub2RlLlxyXG4gKiBcclxuICogIyBBUElcclxuICogXHJcbiAqIGBgYFxyXG4gKiBAcGFyYW0gYm9keTogQm9keU5vZGUgLSBUaGUgYm9keSBub2RlLiBTZWUuIHtAbGluayBYRG9jQVNUTm9kZS50czo6Qm9keU5vZGV9XHJcbiAqIEBwYXJhbSB0ZXh0Pzogc3RyaW5nIC0gVGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYm9keSBub2RlLlxyXG4gKiBAcmV0dXJuIERvY3VtZW50YXRpb25Ob2RlIC0gU2VlIHtAbGluayBYRG9jQVNUTm9kZS50czo6RG9jdW1lbnRhdGlvbk5vZGV9LlxyXG4gKiBgYGBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEb2N1bWVudGF0aW9uTm9kZShcclxuICBib2R5OiBQYXJ0aWFsPEJvZHlOb2RlPixcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8RG9jdW1lbnRhdGlvbk5vZGU+IHtcclxuICByZXR1cm4geyBkb2N1bWVudGF0aW9uOiBqb2luKHNhbml0aXplKHsgYm9keSB9KSwgYm9keS50ZXh0ID8geyB0ZXh0OiBib2R5LnRleHQgfSA6IHt9KSB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRhdGlvbk5vZGUge1xyXG4gIGRvY3VtZW50YXRpb246IHtcclxuICAgIGJvZHk/OiBQYXJ0aWFsPEJvZHlOb2RlPixcclxuICAgIHRleHQ/OiBzdHJpbmdcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgQm9keSBub2RlLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJvZHlOb2RlKFxyXG4gIGFubm90YXRpb25zOiBQYXJ0aWFsPEFubm90YXRpb25zTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPEJvZHlOb2RlPiB7XHJcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBhbm5vdGF0aW9ucyB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEJvZHlOb2RlIHtcclxuICBhbm5vdGF0aW9uczogUGFydGlhbDxBbm5vdGF0aW9uc05vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgQW5ub3RhdGlvbnNOb2RlID0gUGFydGlhbDxUYWdOb2RlPltdIHwgdW5kZWZpbmVkW107XHJcblxyXG4vKiBUYWcgKi9cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWdOb2RlKFxyXG4gIG5hbWU6IFBhcnRpYWw8VGFnTmFtZU5vZGU+LFxyXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8VGFnSWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXHJcbiAgdHlwZTogUGFydGlhbDxUeXBlTm9kZT4sXHJcbiAgZXhwcmVzc2lvbjogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXHJcbiAgZGVzY3JpcHRpb246IFBhcnRpYWw8RGVzY3JpcHRpb25Ob2RlPixcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFRhZ05vZGUge1xyXG4gIGNvbnN0IG9iamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIG5hbWUsIGlkZW50aWZpZXIsIHR5cGUsIGV4cHJlc3Npb24sIGRlc2NyaXB0aW9uKTtcclxuICByZXR1cm4gam9pbihzYW5pdGl6ZShvYmplY3QpLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGFnTm9kZSB7XHJcbiAgbmFtZT86IFBhcnRpYWw8VGFnTmFtZU5vZGU+LFxyXG4gIGlkZW50aWZpZXI/OiBQYXJ0aWFsPFRhZ0lkZW50aWZpZXJOb2RlPixcclxuICB0eXBlPzogUGFydGlhbDxUeXBlTm9kZT4sXHJcbiAgZXhwcmVzc2lvbj86IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+LFxyXG4gIGRlc2NyaXB0aW9uPzogUGFydGlhbDxEZXNjcmlwdGlvbk5vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhZ05hbWVOb2RlKFxyXG4gIG5hbWU6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxUYWdOYW1lTm9kZT4ge1xyXG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgbmFtZSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGFnTmFtZU5vZGUge1xyXG4gIG5hbWU6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhZ0lkZW50aWZpZXJOb2RlKFxyXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxPcHRpb25hbElkZW50aWZpZXJOb2RlPiB8IHVuZGVmaW5lZCxcclxuICBwcm9wZXJ0eT86IFBhcnRpYWw8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT4gfCB1bmRlZmluZWQsXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPFRhZ0lkZW50aWZpZXJOb2RlPiB7XHJcbiAgbGV0IG5vZGUgPSB7fVxyXG4gIGlmIChpZGVudGlmaWVyKSBPYmplY3QuYXNzaWduKG5vZGUsIHsgaWRlbnRpZmllciB9KVxyXG4gIGVsc2UgaWYgKHByb3BlcnR5KSBPYmplY3QuYXNzaWduKG5vZGUsIHsgcHJvcGVydHkgfSlcclxuICByZXR1cm4gam9pbihzYW5pdGl6ZShub2RlKSwgdGV4dCA/IHsgdGV4dCB9IDoge30pO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRhZ0lkZW50aWZpZXJOb2RlIHtcclxuICBpZGVudGlmaWVyPzogSWRlbnRpZmllck5vZGUgfCBPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlXHJcbiAgcHJvcGVydHk/OiBQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUoXHJcbiAgaWRlbnRpZmllcjogUGFydGlhbDxPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlPlxyXG4pOiBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+IHtcclxuICByZXR1cm4gaWRlbnRpZmllcjtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSA9IE9wdGlvbmFsSWRlbnRpZmllck5vZGU7XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUoXHJcbiAgcHJvcGVydHk6IFBhcnRpYWw8KElkZW50aWZpZXJOb2RlIHwgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSk+W10gfCB1bmRlZmluZWRbXSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT4ge1xyXG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgcHJvcGVydHkgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxyXG59XHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZSB7XHJcbiAgLy8gU2hvcnRjdXQgb2YgT3B0aW9uYWxUYWdPcklkZW50aWZpZXJcclxuICBwcm9wZXJ0eTogKElkZW50aWZpZXJOb2RlIHwgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSlbXSB8IHVuZGVmaW5lZFtdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUlkZW50aWZpZXJOb2RlKFxyXG4gIHRleHQ6IHN0cmluZyxcclxuICBvcHRpb25hbCA9IGZhbHNlLFxyXG4gIHByb3BlcnR5PzogUGFydGlhbDxJZGVudGlmaWVyTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxyXG4pOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPiB7XHJcbiAgaWYgKCFvcHRpb25hbCkgb3B0aW9uYWwgPSBmYWxzZTtcclxuICBpZiAoIXByb3BlcnR5KSBwcm9wZXJ0eSA9IFtdXHJcblxyXG4gIHJldHVybiB7IGlkZW50aWZpZXI6IGpvaW4oc2FuaXRpemUoeyBvcHRpb25hbCwgcHJvcGVydHkgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSWRlbnRpZmllck5vZGUge1xyXG4gIGlkZW50aWZpZXI6IHtcclxuICAgIG9wdGlvbmFsPzogYm9vbGVhbixcclxuICAgIHByb3BlcnR5PzogSWRlbnRpZmllck5vZGVbXSB8IHVuZGVmaW5lZFtdXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT3B0aW9uYWxJZGVudGlmaWVyTm9kZShcclxuICBvcHRpb25hbCA9IHRydWUsXHJcbiAgcHJvcGVydHk6IElkZW50aWZpZXJOb2RlW10gfCB1bmRlZmluZWRbXSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8T3B0aW9uYWxJZGVudGlmaWVyTm9kZT4ge1xyXG4gIHJldHVybiBjcmVhdGVJZGVudGlmaWVyTm9kZSh0ZXh0LCBvcHRpb25hbCwgcHJvcGVydHkpO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBPcHRpb25hbElkZW50aWZpZXJOb2RlID0gSWRlbnRpZmllck5vZGVcclxuXHJcblxyXG4vKiBUeXBlICovXHJcblxyXG4vKipcclxuICogXHJcbiAqIENyZWF0ZXMgYSBUeXBlIG5vZGUuXHJcbiAqIFxyXG4gKiAjIEFQSVxyXG4gKiBcclxuICogYGBgXHJcbiAqIEBleHBvcnRcclxuICogQGZ1bmN0aW9uIGNyZWF0ZVR5cGVOb2RlXHJcbiAqIEBwYXJhbSB0eXBlOiBVbmlvblR5cGVOb2RlXHJcbiAqIHwgTGFtYmRhVHlwZU5vZGVcclxuICogfCBUdXBsZVR5cGVOb2RlXHJcbiAqIHwgUHJpbWFyeVR5cGVOb2RlXHJcbiAqIHwgUGFyZW50aGVzaXplZFR5cGVOb2RlXHJcbiAqIHwgVW5hcnlUeXBlTm9kZVxyXG4gKiB8IE9iamVjdFR5cGVOb2RlXHJcbiAqIHwgQXJyYXlUeXBlTm9kZVxyXG4gKiB8IFByb3BlcnR5VHlwZU5vZGVcclxuICogLSBUaGUgdHlwZSBvZiBub2RlIHRvIGNyZWF0ZS5cclxuICogQHBhcmFtIG9wdGlvbmFsID0gZmFsc2UgXHJcbiAqIC0gRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSB0eXBlIG9mIG5vZGUgaXMgb3B0aW9uYWwuXHJcbiAqIGBgYFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVR5cGVOb2RlKFxyXG4gIHR5cGU6IFBhcnRpYWw8SW50ZXJzZWN0VHlwZU5vZGU+XHJcbiAgICB8IFBhcnRpYWw8VW5pb25UeXBlTm9kZT5cclxuICAgIHwgUGFydGlhbDxMYW1iZGFUeXBlTm9kZT5cclxuICAgIHwgUGFydGlhbDxUdXBsZVR5cGVOb2RlPlxyXG4gICAgfCBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT5cclxuICAgIHwgUGFydGlhbDxQYXJlbnRoZXNpemVkVHlwZU5vZGU+XHJcbiAgICB8IFBhcnRpYWw8VW5hcnlUeXBlTm9kZT5cclxuICAgIHwgUGFydGlhbDxPYmplY3RUeXBlTm9kZT5cclxuICAgIHwgUGFydGlhbDxBcnJheVR5cGVOb2RlPlxyXG4gICAgfCBQYXJ0aWFsPFByb3BlcnR5SWRlbnRpZmllck5vZGU+LFxyXG4gIG9wdGlvbmFsID0gZmFsc2UsXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPFR5cGVOb2RlPiB7XHJcbiAgcmV0dXJuIGpvaW4oeyB0eXBlIH0sIHNhbml0aXplKHsgb3B0aW9uYWwgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFR5cGVOb2RlIHtcclxuICBpbnRlcnNlY3Q/OiBJbnRlcnNlY3RUeXBlTm9kZSxcclxuICB1bmlvbj86IFVuaW9uVHlwZU5vZGUsXHJcbiAgbGFtYmRhPzogTGFtYmRhVHlwZU5vZGUsXHJcbiAgdHVwbGU/OiBUdXBsZVR5cGVOb2RlLFxyXG4gIHByaW1hcnk/OiBQcmltYXJ5VHlwZU5vZGUsXHJcbiAgcGFyZW50aGVzaXplZD86IFBhcmVudGhlc2l6ZWRUeXBlTm9kZSxcclxuICB1bmFyeT86IFVuYXJ5VHlwZU5vZGUsXHJcbiAgb2JqZWN0PzogT2JqZWN0VHlwZU5vZGUsXHJcbiAgYXJyYXk/OiBBcnJheVR5cGVOb2RlLFxyXG4gIHByb3BlcnR5PzogUHJvcGVydHlJZGVudGlmaWVyTm9kZSxcclxuICBvcHRpb25hbD86IGJvb2xlYW4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhbiBJbnRlcnNlY3Rpb25UeXBlIG5vZGUuXHJcbiAqIFxyXG4gKiAjIEFQSVxyXG4gKiBcclxuICogYGBgXHJcbiAqIEBwdWJsaWMgbGVmdDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgbGVmdC1oYW5kIHNpZGUuXHJcbiAqIEBwdWJsaWMgcmlnaHQ6IFR5cGVOb2RlIC0gVGhlIHR5cGUgb2Ygbm9kZSB0aGF0IGFwcGVhcnMgb24gdGhlIHJpZ2h0LWhhbmQgc2lkZS5cclxuICogYGBgXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW50ZXJzZWN0VHlwZU5vZGUoXHJcbiAgbGVmdDogVHlwZU5vZGUsXHJcbiAgcmlnaHQ6IFR5cGVOb2RlLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxJbnRlcnNlY3RUeXBlTm9kZT4ge1xyXG4gIHJldHVybiB7IGludGVyc2VjdDogam9pbihzYW5pdGl6ZSh7IGxlZnQsIHJpZ2h0IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEludGVyc2VjdFR5cGVOb2RlIHtcclxuICBpbnRlcnNlY3Q6IHtcclxuICAgIGxlZnQ/OiBUeXBlTm9kZSxcclxuICAgIHJpZ2h0PzogVHlwZU5vZGUsXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYW4gVW5pb25UeXBlIG5vZGUuXHJcbiAqIFxyXG4gKiAjIEFQSVxyXG4gKiBcclxuICogYGBgXHJcbiAqIEBleHBvcnRcclxuICogQHB1YmxpYyBsZWZ0OiBUeXBlTm9kZSAtIFRoZSB0eXBlIG9mIG5vZGUgdGhhdCBhcHBlYXJzIG9uIHRoZSBsZWZ0LWhhbmQgc2lkZS5cclxuICogQHB1YmxpYyByaWdodDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgcmlnaHQtaGFuZCBzaWRlLlxyXG4gKiBgYGBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVbmlvblR5cGVOb2RlKFxyXG4gIGxlZnQ6IFR5cGVOb2RlLFxyXG4gIHJpZ2h0OiBUeXBlTm9kZSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8VW5pb25UeXBlTm9kZT4ge1xyXG4gIHJldHVybiB7IHVuaW9uOiBqb2luKHNhbml0aXplKHsgbGVmdCwgcmlnaHQgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVW5pb25UeXBlTm9kZSB7XHJcbiAgdW5pb246IHtcclxuICAgIGxlZnQ/OiBUeXBlTm9kZSxcclxuICAgIHJpZ2h0PzogVHlwZU5vZGUsXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIExhbWJkYVR5cGUgbm9kZS5cclxuICogXHJcbiAqICMgQVBJXHJcbiAqIFxyXG4gKiBgYGBcclxuICogLSBUaGUgc2luZ2xlIHBhcmFtZXRlciBpbiBhIGxhbWJkYSB0eXBlLlxyXG4gKiBAcGFyYW0gcGFyYW1ldGVyczogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2NlIHwgdW5kZWZpbmVkW10gfCBudWxsXHJcbiAqIC0gVGhlIHNlcXVlbmNlIG9mIHBhcmFtZXRlcnMgaW4gYSBsYW1iZGEgdHlwZS5cclxuICogQHBhcmFtIHR5cGU6IFR5cGVOb2RlXHJcbiAqIC0gVGhlIHJldHVybiB0eXBlIGluIGEgbGFtYmRhIHR5cGUuXHJcbiAqIGBgYFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxhbWJkYVR5cGVOb2RlKFxyXG4gIHBhcmFtZXRlcnM6IFBhcnRpYWw8Rm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlPiB8IHVuZGVmaW5lZFtdLFxyXG4gIHR5cGU6IFR5cGVOb2RlLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxMYW1iZGFUeXBlTm9kZT4ge1xyXG4gIGlmICghcGFyYW1ldGVycykgcGFyYW1ldGVycyA9IFtdXHJcbiAgcmV0dXJuIHsgbGFtYmRhOiBqb2luKHNhbml0aXplKHsgcGFyYW1ldGVycywgdHlwZSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMYW1iZGFUeXBlTm9kZSB7XHJcbiAgbGFtYmRhOiB7XHJcbiAgICBwYXJhbWV0ZXJzPzogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHwgdW5kZWZpbmVkW10sXHJcbiAgICB0eXBlPzogVHlwZU5vZGUsXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRm9ybWFsUGFyZW1ldGVyU2VxdWVuY2VOb2RlKFxyXG4gIHBhcmFtZXRlcnM6IFBhcnRpYWw8UGFyYW1ldGVyTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHtcclxuICByZXR1cm4geyBwYXJhbWV0ZXJzLCB0ZXh0IH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUge1xyXG4gIHBhcmFtZXRlcnM6IFBhcnRpYWw8UGFyYW1ldGVyTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcmFtZXRlck5vZGUoXHJcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXHJcbiAgdHlwZT86IFBhcnRpYWw8VHlwZU5vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxQYXJhbWV0ZXJOb2RlPiB7XHJcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBpZGVudGlmaWVyLCB0eXBlIH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSlcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQYXJhbWV0ZXJOb2RlIHtcclxuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcclxuICB0eXBlPzogUGFydGlhbDxUeXBlTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHVwbGVUeXBlTm9kZShcclxuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcclxuICB0eXBlczogUGFydGlhbDxUeXBlTm9kZSB8IFR1cGxlRXh0ZW5kZWRUeXBlTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxUdXBsZVR5cGVOb2RlPiB7XHJcbiAgcmV0dXJuIHsgdHVwbGU6IGpvaW4oc2FuaXRpemUoeyBpZGVudGlmaWVyLCB0eXBlcyB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUdXBsZVR5cGVOb2RlIHtcclxuICB0dXBsZToge1xyXG4gICAgaWRlbnRpZmllcj86IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxyXG4gICAgdHlwZXM/OiBQYXJ0aWFsPFR5cGVOb2RlIHwgVHVwbGVFeHRlbmRlZFR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHVwbGVFeHRlbmRlZFR5cGVOb2RlKFxyXG4gIHR5cGU6IFBhcnRpYWw8UHJpbWFyeVR5cGVOb2RlPixcclxuICBoZXJpdGFnZTogUGFydGlhbDxQcmltYXJ5VHlwZU5vZGU+LCB0ZXh0Pzogc3RyaW5nXHJcbik6IFR1cGxlRXh0ZW5kZWRUeXBlTm9kZSB7XHJcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyB0eXBlLCBoZXJpdGFnZSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVHVwbGVFeHRlbmRlZFR5cGVOb2RlIHtcclxuICB0eXBlPzogUGFydGlhbDxQcmltYXJ5VHlwZU5vZGU+XHJcbiAgaGVyaXRhZ2U/OiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT5cclxuICB0ZXh0Pzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQcmltYXJ5VHlwZU5vZGUoXHJcbiAgcHJpbWFyeTogUGFydGlhbDxPcHRpb25hbElkZW50aWZpZXJOb2RlPiB8IFBhcnRpYWw8KElkZW50aWZpZXJOb2RlIHwgS2V5d29yZE5vZGUpPiB8IFBhcnRpYWw8UHJvcGVydHlJZGVudGlmaWVyTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT4ge1xyXG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgcHJpbWFyeSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJpbWFyeVR5cGVOb2RlIHtcclxuICBwcmltYXJ5OiBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxJZGVudGlmaWVyTm9kZT4gfCBLZXl3b3JkTm9kZSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVLZXl3b3JkTm9kZShcclxuICB0ZXh0OiBzdHJpbmcgfCBcIm51bGxcIiB8IFwidW5kZWZpbmVkXCJcclxuKTogS2V5d29yZE5vZGUge1xyXG4gIHJldHVybiB7IGtleXdvcmQ6IHRleHQgPyB7IHRleHQgfSA6IHt9IH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBLZXl3b3JkTm9kZSB7XHJcbiAga2V5d29yZDoge1xyXG4gICAgdGV4dD86IHN0cmluZ1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcmVudGhlc2l6ZWRUeXBlTm9kZShcclxuICB0eXBlOiBQYXJ0aWFsPFR5cGVOb2RlPixcclxuICBvcHRpb25hbCA9IGZhbHNlLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxQYXJlbnRoZXNpemVkVHlwZU5vZGU+IHtcclxuICByZXR1cm4geyBwYXJlbnRoZXNpemVkOiBqb2luKHNhbml0aXplKHsgdHlwZSwgb3B0aW9uYWwgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBhcmVudGhlc2l6ZWRUeXBlTm9kZSB7XHJcbiAgcGFyZW50aGVzaXplZDoge1xyXG4gICAgdHlwZT86IFBhcnRpYWw8VHlwZU5vZGU+LFxyXG4gICAgdGV4dD86IHN0cmluZ1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVbmFyeVR5cGVOb2RlKFxyXG4gIG9wZXJhdG9yOiBzdHJpbmcgfCBcIiZcIiB8IFwiKlwiLFxyXG4gIHJpZ2h0OiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPFVuYXJ5VHlwZU5vZGU+IHtcclxuICByZXR1cm4geyB1bmFyeTogam9pbihzYW5pdGl6ZSh7IG9wZXJhdG9yLCByaWdodCB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVbmFyeVR5cGVOb2RlIHtcclxuICB1bmFyeToge1xyXG4gICAgb3BlcmF0b3I/OiBzdHJpbmcgfCBcIiZcIiB8IFwiKlwiLFxyXG4gICAgcmlnaHQ/OiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT4sXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT2JqZWN0VHlwZU5vZGUoXHJcbiAgb2JqZWN0PzogUGFydGlhbDxPYmplY3RQYWlyVHlwZU5vZGU+W10gfCB1bmRlZmluZWRbXSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8T2JqZWN0VHlwZU5vZGU+IHtcclxuICBpZiAoIW9iamVjdCkgb2JqZWN0ID0gW107XHJcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBvYmplY3QgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE9iamVjdFR5cGVOb2RlIHtcclxuICBvYmplY3Q6IFBhcnRpYWw8T2JqZWN0UGFpclR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT2JqZWN0UGFpclR5cGVOb2RlKFxyXG4gIGtleTogVHlwZU5vZGUsXHJcbiAgdmFsdWU6IFR5cGVOb2RlLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxPYmplY3RQYWlyVHlwZU5vZGU+IHtcclxuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IGtleSwgdmFsdWUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE9iamVjdFBhaXJUeXBlTm9kZSB7XHJcbiAga2V5OiBQYXJ0aWFsPFR5cGVOb2RlPixcclxuICB2YWx1ZTogUGFydGlhbDxUeXBlTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQXJyYXlUeXBlTm9kZShcclxuICB0eXBlOiBQYXJ0aWFsPFR5cGVOb2RlPixcclxuICB0eXBlczogUGFydGlhbDxUeXBlTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogQXJyYXlUeXBlTm9kZSB7XHJcbiAgaWYgKCF0eXBlcykgdHlwZXMgPSBbXTtcclxuXHJcbiAgcmV0dXJuIHsgYXJyYXk6IGpvaW4oc2FuaXRpemUoeyB0eXBlLCB0eXBlcyB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBcnJheVR5cGVOb2RlIHtcclxuICBhcnJheToge1xyXG4gICAgdHlwZT86IFBhcnRpYWw8VHlwZU5vZGU+LFxyXG4gICAgdHlwZXM/OiBQYXJ0aWFsPFR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUHJvcGVydHlJZGVudGlmaWVyTm9kZShcclxuICBwcm9wZXJ0eTogUGFydGlhbDxJZGVudGlmaWVyTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxyXG4gIHRleHQ6IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPFByb3BlcnR5SWRlbnRpZmllck5vZGU+IHtcclxuICByZXR1cm4gY3JlYXRlSWRlbnRpZmllck5vZGUodGV4dCwgZmFsc2UsIHByb3BlcnR5KVxyXG59O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQcm9wZXJ0eUlkZW50aWZpZXJOb2RlIGV4dGVuZHMgSWRlbnRpZmllck5vZGUgeyB9XHJcblxyXG5cclxuLyogRXhwcmVzc2lvbiAqL1xyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFeHByZXNzaW9uTm9kZShcclxuICBleHByZXNzaW9uOlxyXG4gICAgUGFydGlhbDxVbmFyeUV4cHJlc3Npb25Ob2RlPlxyXG4gICAgfCBQYXJ0aWFsPEJpbmFyeUV4cHJlc3Npb25Ob2RlPlxyXG4gICAgfCBQYXJ0aWFsPEFycmF5RXhwcmVzc2lvbk5vZGU+XHJcbiAgICB8IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+XHJcbiAgICB8IFBhcnRpYWw8TGFtYmRhRXhwcmVzc2lvbk5vZGU+XHJcbiAgICB8IFBhcnRpYWw8TGl0ZXJhbEV4cHJlc3Npb25Ob2RlPlxyXG4gICAgfCBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZyxcclxuKTogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4ge1xyXG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgZXhwcmVzc2lvbiB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRXhwcmVzc2lvbk5vZGUge1xyXG4gIGV4cHJlc3Npb246XHJcbiAgVW5hcnlFeHByZXNzaW9uTm9kZVxyXG4gIHwgQmluYXJ5RXhwcmVzc2lvbk5vZGVcclxuICB8IEFycmF5RXhwcmVzc2lvbk5vZGVcclxuICB8IE9iamVjdEV4cHJlc3Npb25Ob2RlXHJcbiAgfCBMYW1iZGFFeHByZXNzaW9uTm9kZVxyXG4gIHwgTGl0ZXJhbEV4cHJlc3Npb25Ob2RlXHJcbiAgfCBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGVcclxuICB0ZXh0Pzogc3RyaW5nXHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVW5hcnlFeHByZXNzaW9uTm9kZShcclxuICBvcGVyYXRvcjogc3RyaW5nIHwgJysnIHwgJy0nLFxyXG4gIHJpZ2h0OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8VW5hcnlFeHByZXNzaW9uTm9kZT4ge1xyXG4gIHJldHVybiB7IHVuYXJ5OiBqb2luKHNhbml0aXplKHsgb3BlcmF0b3IsIHJpZ2h0IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFVuYXJ5RXhwcmVzc2lvbk5vZGUge1xyXG4gIHVuYXJ5OiB7XHJcbiAgICBvcGVyYXRvcj86IHN0cmluZyB8ICcrJyB8ICctJyxcclxuICAgIHJpZ2h0PzogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXHJcbiAgICB0ZXh0Pzogc3RyaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQmluYXJ5RXhwcmVzc2lvbk5vZGUoXHJcbiAgb3BlcmF0b3I6IHN0cmluZyB8ICcrJyB8ICctJyxcclxuICBsZWZ0OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcclxuICByaWdodDogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPEJpbmFyeUV4cHJlc3Npb25Ob2RlPiB7XHJcbiAgcmV0dXJuIHsgYmluYXJ5OiBqb2luKHNhbml0aXplKHsgbGVmdCwgcmlnaHQsIG9wZXJhdG9yIH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEJpbmFyeUV4cHJlc3Npb25Ob2RlIHtcclxuICBiaW5hcnk6IHtcclxuICAgIG9wZXJhdG9yPzogc3RyaW5nIHwgJysnIHwgJy0nIHwgJyonIHwgJy8nLFxyXG4gICAgbGVmdD86IEV4cHJlc3Npb25Ob2RlLFxyXG4gICAgcmlnaHQ/OiBFeHByZXNzaW9uTm9kZSxcclxuICAgIHRleHQ/OiBzdHJpbmdcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBcnJheUV4cHJlc3Npb25Ob2RlKFxyXG4gIGFycmF5PzogUGFydGlhbDxFeHByZXNzaW9uTm9kZT5bXSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbik6IFBhcnRpYWw8QXJyYXlFeHByZXNzaW9uTm9kZT4ge1xyXG4gIGlmICghYXJyYXkpIGFycmF5ID0gW107XHJcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBhcnJheSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXJyYXlFeHByZXNzaW9uTm9kZSB7XHJcbiAgYXJyYXk/OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPltdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdEV4cHJlc3Npb25Ob2RlKFxyXG4gIG9iamVjdD86IFBhcnRpYWw8T2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlPltdLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxPYmplY3RFeHByZXNzaW9uTm9kZT4ge1xyXG4gIGlmICghb2JqZWN0KSBvYmplY3QgPSBbXVxyXG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgb2JqZWN0IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSlcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBPYmplY3RFeHByZXNzaW9uTm9kZSB7XHJcbiAgb2JqZWN0OiBQYXJ0aWFsPE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZT5bXSxcclxuICB0ZXh0Pzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUoXHJcbiAga2V5OiBQYXJ0aWFsPExpdGVyYWxFeHByZXNzaW9uTm9kZT4sXHJcbiAgdmFsdWU6IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+IHwgUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGU+IHtcclxuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IGtleSwgdmFsdWUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZSB7XHJcbiAga2V5OiBQYXJ0aWFsPExpdGVyYWxFeHByZXNzaW9uTm9kZT4sXHJcbiAgdmFsdWU6IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+IHwgUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+LFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxhbWJkYUV4cHJlc3Npb25Ob2RlKFxyXG4gIHBhcmFtZXRlcnM6IEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZSB8IHVuZGVmaW5lZFtdLFxyXG4gIHR5cGU6IFR5cGVOb2RlLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxMYW1iZGFFeHByZXNzaW9uTm9kZT4ge1xyXG4gIGlmICghcGFyYW1ldGVycykgcGFyYW1ldGVycyA9IFtdXHJcbiAgcmV0dXJuIGNyZWF0ZUxhbWJkYVR5cGVOb2RlKHBhcmFtZXRlcnMsIHR5cGUsIHRleHQpXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGFtYmRhRXhwcmVzc2lvbk5vZGUgZXh0ZW5kcyBMYW1iZGFUeXBlTm9kZSB7IH1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJlbnRoZXNpemVkRXhwcmVzc2lvbmVOb2RlKFxyXG4gIGV4cHJlc3Npb246IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+LFxyXG4gIG9wdGlvbmFsID0gZmFsc2UsXHJcbiAgdGV4dD86IHN0cmluZ1xyXG4pOiBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZT4ge1xyXG4gIHJldHVybiB7IHBhcmVudGhlc2l6ZWQ6IGpvaW4oc2FuaXRpemUoeyBleHByZXNzaW9uLCBvcHRpb25hbCB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH07XHJcbn1cclxuZXhwb3J0IGludGVyZmFjZSBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGUge1xyXG4gIHBhcmVudGhlc2l6ZWQ6IHtcclxuICAgIGV4cHJlc3Npb24/OiBFeHByZXNzaW9uTm9kZSxcclxuICAgIG9wdGlvbmFsPzogYm9vbGVhbixcclxuICAgIHRleHQ/OiBzdHJpbmdcclxuICB9XHJcbn07XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZShcclxuICB0eXBlOiBzdHJpbmcsXHJcbiAgdGV4dDogc3RyaW5nXHJcbik6IFBhcnRpYWw8TGl0ZXJhbEV4cHJlc3Npb25Ob2RlPiB7XHJcbiAgcmV0dXJuIHsgbGl0ZXJhbDogam9pbihzYW5pdGl6ZSh7IHR5cGUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGl0ZXJhbEV4cHJlc3Npb25Ob2RlIHtcclxuICBsaXRlcmFsOiB7XHJcbiAgICB0eXBlPzogc3RyaW5nLFxyXG4gICAgdGV4dD86IHN0cmluZyxcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEZXNjcmlwdGlvbk5vZGUoXHJcbiAgdGV4dDogc3RyaW5nLFxyXG4gIGlubGluZXM/OiBQYXJ0aWFsPElubGluZVRhZ05vZGU+W11cclxuKTogUGFydGlhbDxEZXNjcmlwdGlvbk5vZGU+IHtcclxuICBpZiAoIWlubGluZXMpIGlubGluZXMgPSBbXVxyXG4gIHJldHVybiB7IGRlc2NyaXB0aW9uOiBqb2luKHNhbml0aXplKHsgaW5saW5lcyB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEZXNjcmlwdGlvbk5vZGUge1xyXG4gIGRlc2NyaXB0aW9uOiB7XHJcbiAgICB0ZXh0Pzogc3RyaW5nLFxyXG4gICAgaW5saW5lcz86IFBhcnRpYWw8SW5saW5lVGFnTm9kZT5bXVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUlubGluZVRhZ05vZGUoXHJcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXHJcbiAgYm9keTogc3RyaW5nLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxuKTogUGFydGlhbDxJbmxpbmVUYWdOb2RlPiB7XHJcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBpZGVudGlmaWVyLCBib2R5IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSlcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJbmxpbmVUYWdOb2RlIHtcclxuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcclxuICBib2R5Pzogc3RyaW5nLFxyXG4gIHRleHQ/OiBzdHJpbmdcclxufSJdfQ==