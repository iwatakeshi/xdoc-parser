"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _ = require("lodash");
/* Documentation */
/**
 * Removes undefined, null, and false properties from an object.
 *
 * # API
 *
 * ```
 * @param object
 * ```
 */
function sanitize(object) {
    // Object.keys(object).forEach((key) => (object[key] == null) && delete object[key]);
    return _.pickBy(object);
}
/**
 *
 * Merges multiple objects into a single object
 *
 * # API
 *
 * ```
 * @function join
 * @param to: object - The target object.
 * @param from: object[] - The objects to merge.
 * ```
 */
function join(to, ...from) {
    return from.reduce(function (b, a) {
        for (var key in a)
            b[key] = a[key];
        return b;
    }, to);
}
/**
 * Creates a Documentation node.
 *
 * # API
 *
 * ```
 * @param body: BodyNode - The body node. See. {@link XDocASTNode.ts::BodyNode}
 * @param text?: string - The string representation of the body node.
 * @return DocumentationNode - See {@link XDocASTNode.ts::DocumentationNode}.
 * ```
 */
function createDocumentationNode(body, text) {
    return { documentation: join(sanitize({ body }), body.text ? { text: body.text } : {}) };
}
exports.createDocumentationNode = createDocumentationNode;
/**
 * Creates a Body node.
 */
function createBodyNode(annotations, text) {
    return join(sanitize({ annotations }), text ? { text } : {});
}
exports.createBodyNode = createBodyNode;
/* Tag */
function createTagNode(name, identifier, type, expression, description, text) {
    const object = Object.assign({}, name, identifier, type, expression, description);
    return join(sanitize(object), text ? { text } : {});
}
exports.createTagNode = createTagNode;
function createTagNameNode(name, text) {
    return join(sanitize({ name }), text ? { text } : {});
}
exports.createTagNameNode = createTagNameNode;
function createTagIdentifierNode(identifier, property, text) {
    let node = {};
    if (identifier)
        Object.assign(node, { identifier });
    else if (property)
        Object.assign(node, { property });
    return join(sanitize(node), text ? { text } : {});
}
exports.createTagIdentifierNode = createTagIdentifierNode;
function createOptionalTagIdentifierNode(identifier) {
    return identifier;
}
exports.createOptionalTagIdentifierNode = createOptionalTagIdentifierNode;
function createPropertyTagIdentifierNode(property, text) {
    return join(sanitize({ property }), text ? { text } : {});
}
exports.createPropertyTagIdentifierNode = createPropertyTagIdentifierNode;
function createIdentifierNode(text, optional = false, property) {
    if (!optional)
        optional = false;
    if (!property)
        property = [];
    return { identifier: join(sanitize({ optional, property }), text ? { text } : {}) };
}
exports.createIdentifierNode = createIdentifierNode;
function createOptionalIdentifierNode(optional = true, property, text) {
    return createIdentifierNode(text, optional, property);
}
exports.createOptionalIdentifierNode = createOptionalIdentifierNode;
/* Type */
/**
 *
 * Creates a Type node.
 *
 * # API
 *
 * ```
 * @export
 * @function createTypeNode
 * @param type: UnionTypeNode
 * | LambdaTypeNode
 * | TupleTypeNode
 * | PrimaryTypeNode
 * | ParenthesizedTypeNode
 * | UnaryTypeNode
 * | ObjectTypeNode
 * | ArrayTypeNode
 * | PropertyTypeNode
 * - The type of node to create.
 * @param optional = false
 * - Determines whether the type of node is optional.
 * ```
 */
function createTypeNode(type, optional = false, text) {
    return join({ type }, sanitize({ optional }), text ? { text } : {});
}
exports.createTypeNode = createTypeNode;
/**
 * Creates an IntersectionType node.
 *
 * # API
 *
 * ```
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createIntersectTypeNode(left, right, text) {
    return { intersect: join(sanitize({ left, right }), text ? { text } : {}) };
}
exports.createIntersectTypeNode = createIntersectTypeNode;
/**
 * Creates an UnionType node.
 *
 * # API
 *
 * ```
 * @export
 * @public left: TypeNode - The type of node that appears on the left-hand side.
 * @public right: TypeNode - The type of node that appears on the right-hand side.
 * ```
 */
function createUnionTypeNode(left, right, text) {
    return { union: join(sanitize({ left, right }), text ? { text } : {}) };
}
exports.createUnionTypeNode = createUnionTypeNode;
/**
 * Creates a LambdaType node.
 *
 * # API
 *
 * ```
 * - The single parameter in a lambda type.
 * @param parameters: FormalParameterSequencce | undefined[] | null
 * - The sequence of parameters in a lambda type.
 * @param type: TypeNode
 * - The return type in a lambda type.
 * ```
 */
function createLambdaTypeNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return { lambda: join(sanitize({ parameters, type }), text ? { text } : {}) };
}
exports.createLambdaTypeNode = createLambdaTypeNode;
function createFormalParemeterSequenceNode(parameters, text) {
    return { parameters, text };
}
exports.createFormalParemeterSequenceNode = createFormalParemeterSequenceNode;
function createParameterNode(identifier, type, text) {
    return join(sanitize({ identifier, type }), text ? { text } : {});
}
exports.createParameterNode = createParameterNode;
function createTupleTypeNode(identifier, types, text) {
    return { tuple: join(sanitize({ identifier, types }), text ? { text } : {}) };
}
exports.createTupleTypeNode = createTupleTypeNode;
function createTupleExtendedTypeNode(type, heritage, text) {
    return join(sanitize({ type, heritage }), text ? { text } : {});
}
exports.createTupleExtendedTypeNode = createTupleExtendedTypeNode;
function createPrimaryTypeNode(primary, text) {
    return join(sanitize({ primary }), text ? { text } : {});
}
exports.createPrimaryTypeNode = createPrimaryTypeNode;
function createKeywordNode(text) {
    return { keyword: text ? { text } : {} };
}
exports.createKeywordNode = createKeywordNode;
function createParenthesizedTypeNode(type, optional = false, text) {
    return { parenthesized: join(sanitize({ type, optional }), text ? { text } : {}) };
}
exports.createParenthesizedTypeNode = createParenthesizedTypeNode;
function createUnaryTypeNode(operator, right, text) {
    return { unary: join(sanitize({ operator, right }), text ? { text } : {}) };
}
exports.createUnaryTypeNode = createUnaryTypeNode;
function createObjectTypeNode(object, text) {
    if (!object)
        object = [];
    return join(sanitize({ object }), text ? { text } : {});
}
exports.createObjectTypeNode = createObjectTypeNode;
function createObjectPairTypeNode(key, value, text) {
    return join(sanitize({ key, value }), text ? { text } : {});
}
exports.createObjectPairTypeNode = createObjectPairTypeNode;
function createArrayTypeNode(type, types, text) {
    if (!types)
        types = [];
    return { array: join(sanitize({ type, types }), text ? { text } : {}) };
}
exports.createArrayTypeNode = createArrayTypeNode;
function createPropertyIdentifierNode(property, text) {
    return createIdentifierNode(text, false, property);
}
exports.createPropertyIdentifierNode = createPropertyIdentifierNode;
;
/* Expression */
function createExpressionNode(expression, text) {
    return join(sanitize({ expression }), text ? { text } : {});
}
exports.createExpressionNode = createExpressionNode;
function createUnaryExpressionNode(operator, right, text) {
    return { unary: join(sanitize({ operator, right }), text ? { text } : {}) };
}
exports.createUnaryExpressionNode = createUnaryExpressionNode;
function createBinaryExpressionNode(operator, left, right, text) {
    return { binary: join(sanitize({ left, right, operator }), text ? { text } : {}) };
}
exports.createBinaryExpressionNode = createBinaryExpressionNode;
function createArrayExpressionNode(array, text) {
    if (!array)
        array = [];
    return join(sanitize({ array }), text ? { text } : {});
}
exports.createArrayExpressionNode = createArrayExpressionNode;
function createObjectExpressionNode(object, text) {
    if (!object)
        object = [];
    return join(sanitize({ object }), text ? { text } : {});
}
exports.createObjectExpressionNode = createObjectExpressionNode;
function createObjectPairExpressionNode(key, value, text) {
    return join(sanitize({ key, value }), text ? { text } : {});
}
exports.createObjectPairExpressionNode = createObjectPairExpressionNode;
function createLambdaExpressionNode(parameters, type, text) {
    if (!parameters)
        parameters = [];
    return createLambdaTypeNode(parameters, type, text);
}
exports.createLambdaExpressionNode = createLambdaExpressionNode;
function createParenthesizedExpressioneNode(expression, optional = false, text) {
    return { parenthesized: join(sanitize({ expression, optional }), text ? { text } : {}) };
}
exports.createParenthesizedExpressioneNode = createParenthesizedExpressioneNode;
;
function createLiteralExpressionNode(type, text) {
    return { literal: join(sanitize({ type }), text ? { text } : {}) };
}
exports.createLiteralExpressionNode = createLiteralExpressionNode;
function createDescriptionNode(text, inlines) {
    if (!inlines)
        inlines = [];
    return { description: join(sanitize({ inlines }), text ? { text } : {}) };
}
exports.createDescriptionNode = createDescriptionNode;
function createInlineTagNode(identifier, body, text) {
    return join(sanitize({ identifier, body }), text ? { text } : {});
}
exports.createInlineTagNode = createInlineTagNode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVE5vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVE5vZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0QkFBNEI7QUFDNUIsbUJBQW1CO0FBRW5COzs7Ozs7OztHQVFHO0FBQ0gsU0FBUyxRQUFRLENBQUksTUFBYztJQUNqQyxxRkFBcUY7SUFDckYsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBZSxDQUFBO0FBQ3ZDLENBQUM7QUFFRDs7Ozs7Ozs7Ozs7R0FXRztBQUNILFNBQVMsSUFBSSxDQUFJLEVBQVUsRUFBRSxHQUFHLElBQWM7SUFDNUMsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDL0IsS0FBSyxJQUFJLEdBQUcsSUFBSSxDQUFDO1lBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuQyxPQUFPLENBQUMsQ0FBQztJQUNYLENBQUMsRUFBRSxFQUFFLENBQWUsQ0FBQztBQUN2QixDQUFDO0FBRUQ7Ozs7Ozs7Ozs7R0FVRztBQUNILFNBQWdCLHVCQUF1QixDQUNyQyxJQUF1QixFQUN2QixJQUFhO0lBRWIsT0FBTyxFQUFFLGFBQWEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUE7QUFDMUYsQ0FBQztBQUxELDBEQUtDO0FBU0Q7O0dBRUc7QUFDSCxTQUFnQixjQUFjLENBQzVCLFdBQXFDLEVBQ3JDLElBQWE7SUFFYixPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJ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QyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQTtBQUMzRSxDQUFDO0FBTkQsc0RBTUM7QUFTRCxTQUFnQixtQkFBbUIsQ0FDakMsVUFBbUMsRUFDbkMsSUFBWSxFQUNaLElBQWE7SUFFYixPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFBO0FBQ25FLENBQUM7QUFORCxrREFNQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuLyogRG9jdW1lbnRhdGlvbiAqL1xuXG4vKipcbiAqIFJlbW92ZXMgdW5kZWZpbmVkLCBudWxsLCBhbmQgZmFsc2UgcHJvcGVydGllcyBmcm9tIGFuIG9iamVjdC5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAcGFyYW0gb2JqZWN0XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gc2FuaXRpemU8VD4ob2JqZWN0OiBvYmplY3QpIHtcbiAgLy8gT2JqZWN0LmtleXMob2JqZWN0KS5mb3JFYWNoKChrZXkpID0+IChvYmplY3Rba2V5XSA9PSBudWxsKSAmJiBkZWxldGUgb2JqZWN0W2tleV0pO1xuICByZXR1cm4gXy5waWNrQnkob2JqZWN0KSBhcyBQYXJ0aWFsPFQ+XG59XG5cbi8qKlxuICogXG4gKiBNZXJnZXMgbXVsdGlwbGUgb2JqZWN0cyBpbnRvIGEgc2luZ2xlIG9iamVjdFxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBmdW5jdGlvbiBqb2luXG4gKiBAcGFyYW0gdG86IG9iamVjdCAtIFRoZSB0YXJnZXQgb2JqZWN0LlxuICogQHBhcmFtIGZyb206IG9iamVjdFtdIC0gVGhlIG9iamVjdHMgdG8gbWVyZ2UuXG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gam9pbjxUPih0bzogb2JqZWN0LCAuLi5mcm9tOiBvYmplY3RbXSkge1xuICByZXR1cm4gZnJvbS5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gYSkgYltrZXldID0gYVtrZXldO1xuICAgIHJldHVybiBiO1xuICB9LCB0bykgYXMgUGFydGlhbDxUPjtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgRG9jdW1lbnRhdGlvbiBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBwYXJhbSBib2R5OiBCb2R5Tm9kZSAtIFRoZSBib2R5IG5vZGUuIFNlZS4ge0BsaW5rIFhEb2NBU1ROb2RlLnRzOjpCb2R5Tm9kZX1cbiAqIEBwYXJhbSB0ZXh0Pzogc3RyaW5nIC0gVGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYm9keSBub2RlLlxuICogQHJldHVybiBEb2N1bWVudGF0aW9uTm9kZSAtIFNlZSB7QGxpbmsgWERvY0FTVE5vZGUudHM6OkRvY3VtZW50YXRpb25Ob2RlfS5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRhdGlvbk5vZGUoXG4gIGJvZHk6IFBhcnRpYWw8Qm9keU5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPERvY3VtZW50YXRpb25Ob2RlPiB7XG4gIHJldHVybiB7IGRvY3VtZW50YXRpb246IGpvaW4oc2FuaXRpemUoeyBib2R5IH0pLCBib2R5LnRleHQgPyB7IHRleHQ6IGJvZHkudGV4dCB9IDoge30pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudGF0aW9uTm9kZSB7XG4gIGRvY3VtZW50YXRpb246IHtcbiAgICBib2R5PzogUGFydGlhbDxCb2R5Tm9kZT4sXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIEJvZHkgbm9kZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJvZHlOb2RlKFxuICBhbm5vdGF0aW9uczogUGFydGlhbDxBbm5vdGF0aW9uc05vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPEJvZHlOb2RlPiB7XG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgYW5ub3RhdGlvbnMgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb2R5Tm9kZSB7XG4gIGFubm90YXRpb25zOiBQYXJ0aWFsPEFubm90YXRpb25zTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IHR5cGUgQW5ub3RhdGlvbnNOb2RlID0gUGFydGlhbDxUYWdOb2RlPltdIHwgdW5kZWZpbmVkW107XG5cbi8qIFRhZyAqL1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFnTm9kZShcbiAgbmFtZTogUGFydGlhbDxUYWdOYW1lTm9kZT4sXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8VGFnSWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIHR5cGU6IFBhcnRpYWw8VHlwZU5vZGU+LFxuICBleHByZXNzaW9uOiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgZGVzY3JpcHRpb246IFBhcnRpYWw8RGVzY3JpcHRpb25Ob2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogVGFnTm9kZSB7XG4gIGNvbnN0IG9iamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIG5hbWUsIGlkZW50aWZpZXIsIHR5cGUsIGV4cHJlc3Npb24sIGRlc2NyaXB0aW9uKTtcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUob2JqZWN0KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ05vZGUge1xuICBuYW1lPzogUGFydGlhbDxUYWdOYW1lTm9kZT4sXG4gIGlkZW50aWZpZXI/OiBQYXJ0aWFsPFRhZ0lkZW50aWZpZXJOb2RlPixcbiAgdHlwZT86IFBhcnRpYWw8VHlwZU5vZGU+LFxuICBleHByZXNzaW9uPzogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXG4gIGRlc2NyaXB0aW9uPzogUGFydGlhbDxEZXNjcmlwdGlvbk5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWdOYW1lTm9kZShcbiAgbmFtZTogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8VGFnTmFtZU5vZGU+IHtcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBuYW1lIH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUYWdOYW1lTm9kZSB7XG4gIG5hbWU6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWdJZGVudGlmaWVyTm9kZShcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4gfCBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+IHwgdW5kZWZpbmVkLFxuICBwcm9wZXJ0eT86IFBhcnRpYWw8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT4gfCB1bmRlZmluZWQsXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8VGFnSWRlbnRpZmllck5vZGU+IHtcbiAgbGV0IG5vZGUgPSB7fVxuICBpZiAoaWRlbnRpZmllcikgT2JqZWN0LmFzc2lnbihub2RlLCB7IGlkZW50aWZpZXIgfSlcbiAgZWxzZSBpZiAocHJvcGVydHkpIE9iamVjdC5hc3NpZ24obm9kZSwgeyBwcm9wZXJ0eSB9KVxuICByZXR1cm4gam9pbihzYW5pdGl6ZShub2RlKSwgdGV4dCA/IHsgdGV4dCB9IDoge30pO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ0lkZW50aWZpZXJOb2RlIHtcbiAgaWRlbnRpZmllcj86IElkZW50aWZpZXJOb2RlIHwgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZVxuICBwcm9wZXJ0eT86IFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUoXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8T3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZT5cbik6IFBhcnRpYWw8T3B0aW9uYWxJZGVudGlmaWVyTm9kZT4ge1xuICByZXR1cm4gaWRlbnRpZmllcjtcbn1cblxuZXhwb3J0IHR5cGUgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSA9IE9wdGlvbmFsSWRlbnRpZmllck5vZGU7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUoXG4gIHByb3BlcnR5OiBQYXJ0aWFsPChJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUpPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT4ge1xuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IHByb3BlcnR5IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSlcbn1cbmV4cG9ydCBpbnRlcmZhY2UgUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZSB7XG4gIC8vIFNob3J0Y3V0IG9mIE9wdGlvbmFsVGFnT3JJZGVudGlmaWVyXG4gIHByb3BlcnR5OiAoSWRlbnRpZmllck5vZGUgfCBPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlKVtdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUlkZW50aWZpZXJOb2RlKFxuICB0ZXh0OiBzdHJpbmcsXG4gIG9wdGlvbmFsID0gZmFsc2UsXG4gIHByb3BlcnR5PzogUGFydGlhbDxJZGVudGlmaWVyTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxuKTogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4ge1xuICBpZiAoIW9wdGlvbmFsKSBvcHRpb25hbCA9IGZhbHNlO1xuICBpZiAoIXByb3BlcnR5KSBwcm9wZXJ0eSA9IFtdXG5cbiAgcmV0dXJuIHsgaWRlbnRpZmllcjogam9pbihzYW5pdGl6ZSh7IG9wdGlvbmFsLCBwcm9wZXJ0eSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJZGVudGlmaWVyTm9kZSB7XG4gIGlkZW50aWZpZXI6IHtcbiAgICBvcHRpb25hbD86IGJvb2xlYW4sXG4gICAgcHJvcGVydHk/OiBJZGVudGlmaWVyTm9kZVtdIHwgdW5kZWZpbmVkW11cbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9wdGlvbmFsSWRlbnRpZmllck5vZGUoXG4gIG9wdGlvbmFsID0gdHJ1ZSxcbiAgcHJvcGVydHk6IElkZW50aWZpZXJOb2RlW10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxPcHRpb25hbElkZW50aWZpZXJOb2RlPiB7XG4gIHJldHVybiBjcmVhdGVJZGVudGlmaWVyTm9kZSh0ZXh0LCBvcHRpb25hbCwgcHJvcGVydHkpO1xufVxuXG5leHBvcnQgdHlwZSBPcHRpb25hbElkZW50aWZpZXJOb2RlID0gSWRlbnRpZmllck5vZGVcblxuXG4vKiBUeXBlICovXG5cbi8qKlxuICogXG4gKiBDcmVhdGVzIGEgVHlwZSBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBleHBvcnRcbiAqIEBmdW5jdGlvbiBjcmVhdGVUeXBlTm9kZVxuICogQHBhcmFtIHR5cGU6IFVuaW9uVHlwZU5vZGVcbiAqIHwgTGFtYmRhVHlwZU5vZGVcbiAqIHwgVHVwbGVUeXBlTm9kZVxuICogfCBQcmltYXJ5VHlwZU5vZGVcbiAqIHwgUGFyZW50aGVzaXplZFR5cGVOb2RlXG4gKiB8IFVuYXJ5VHlwZU5vZGVcbiAqIHwgT2JqZWN0VHlwZU5vZGVcbiAqIHwgQXJyYXlUeXBlTm9kZVxuICogfCBQcm9wZXJ0eVR5cGVOb2RlXG4gKiAtIFRoZSB0eXBlIG9mIG5vZGUgdG8gY3JlYXRlLlxuICogQHBhcmFtIG9wdGlvbmFsID0gZmFsc2UgXG4gKiAtIERldGVybWluZXMgd2hldGhlciB0aGUgdHlwZSBvZiBub2RlIGlzIG9wdGlvbmFsLlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUeXBlTm9kZShcbiAgdHlwZTogUGFydGlhbDxJbnRlcnNlY3RUeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8VW5pb25UeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8TGFtYmRhVHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPFR1cGxlVHlwZU5vZGU+XG4gICAgfCBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8UGFyZW50aGVzaXplZFR5cGVOb2RlPlxuICAgIHwgUGFydGlhbDxVbmFyeVR5cGVOb2RlPlxuICAgIHwgUGFydGlhbDxPYmplY3RUeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8QXJyYXlUeXBlTm9kZT5cbiAgICB8IFBhcnRpYWw8UHJvcGVydHlJZGVudGlmaWVyTm9kZT4sXG4gIG9wdGlvbmFsID0gZmFsc2UsXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8VHlwZU5vZGU+IHtcbiAgcmV0dXJuIGpvaW4oeyB0eXBlIH0sIHNhbml0aXplKHsgb3B0aW9uYWwgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFR5cGVOb2RlIHtcbiAgaW50ZXJzZWN0PzogSW50ZXJzZWN0VHlwZU5vZGUsXG4gIHVuaW9uPzogVW5pb25UeXBlTm9kZSxcbiAgbGFtYmRhPzogTGFtYmRhVHlwZU5vZGUsXG4gIHR1cGxlPzogVHVwbGVUeXBlTm9kZSxcbiAgcHJpbWFyeT86IFByaW1hcnlUeXBlTm9kZSxcbiAgcGFyZW50aGVzaXplZD86IFBhcmVudGhlc2l6ZWRUeXBlTm9kZSxcbiAgdW5hcnk/OiBVbmFyeVR5cGVOb2RlLFxuICBvYmplY3Q/OiBPYmplY3RUeXBlTm9kZSxcbiAgYXJyYXk/OiBBcnJheVR5cGVOb2RlLFxuICBwcm9wZXJ0eT86IFByb3BlcnR5SWRlbnRpZmllck5vZGUsXG4gIG9wdGlvbmFsPzogYm9vbGVhbixcbiAgdGV4dD86IHN0cmluZ1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gSW50ZXJzZWN0aW9uVHlwZSBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBwdWJsaWMgbGVmdDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgbGVmdC1oYW5kIHNpZGUuXG4gKiBAcHVibGljIHJpZ2h0OiBUeXBlTm9kZSAtIFRoZSB0eXBlIG9mIG5vZGUgdGhhdCBhcHBlYXJzIG9uIHRoZSByaWdodC1oYW5kIHNpZGUuXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludGVyc2VjdFR5cGVOb2RlKFxuICBsZWZ0OiBUeXBlTm9kZSxcbiAgcmlnaHQ6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPEludGVyc2VjdFR5cGVOb2RlPiB7XG4gIHJldHVybiB7IGludGVyc2VjdDogam9pbihzYW5pdGl6ZSh7IGxlZnQsIHJpZ2h0IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEludGVyc2VjdFR5cGVOb2RlIHtcbiAgaW50ZXJzZWN0OiB7XG4gICAgbGVmdD86IFR5cGVOb2RlLFxuICAgIHJpZ2h0PzogVHlwZU5vZGUsXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cblxuLyoqXG4gKiBDcmVhdGVzIGFuIFVuaW9uVHlwZSBub2RlLlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBleHBvcnRcbiAqIEBwdWJsaWMgbGVmdDogVHlwZU5vZGUgLSBUaGUgdHlwZSBvZiBub2RlIHRoYXQgYXBwZWFycyBvbiB0aGUgbGVmdC1oYW5kIHNpZGUuXG4gKiBAcHVibGljIHJpZ2h0OiBUeXBlTm9kZSAtIFRoZSB0eXBlIG9mIG5vZGUgdGhhdCBhcHBlYXJzIG9uIHRoZSByaWdodC1oYW5kIHNpZGUuXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVuaW9uVHlwZU5vZGUoXG4gIGxlZnQ6IFR5cGVOb2RlLFxuICByaWdodDogVHlwZU5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8VW5pb25UeXBlTm9kZT4ge1xuICByZXR1cm4geyB1bmlvbjogam9pbihzYW5pdGl6ZSh7IGxlZnQsIHJpZ2h0IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuaW9uVHlwZU5vZGUge1xuICB1bmlvbjoge1xuICAgIGxlZnQ/OiBUeXBlTm9kZSxcbiAgICByaWdodD86IFR5cGVOb2RlLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBMYW1iZGFUeXBlIG5vZGUuXG4gKiBcbiAqICMgQVBJXG4gKiBcbiAqIGBgYFxuICogLSBUaGUgc2luZ2xlIHBhcmFtZXRlciBpbiBhIGxhbWJkYSB0eXBlLlxuICogQHBhcmFtIHBhcmFtZXRlcnM6IEZvcm1hbFBhcmFtZXRlclNlcXVlbmNjZSB8IHVuZGVmaW5lZFtdIHwgbnVsbFxuICogLSBUaGUgc2VxdWVuY2Ugb2YgcGFyYW1ldGVycyBpbiBhIGxhbWJkYSB0eXBlLlxuICogQHBhcmFtIHR5cGU6IFR5cGVOb2RlXG4gKiAtIFRoZSByZXR1cm4gdHlwZSBpbiBhIGxhbWJkYSB0eXBlLlxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMYW1iZGFUeXBlTm9kZShcbiAgcGFyYW1ldGVyczogUGFydGlhbDxGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGU+IHwgdW5kZWZpbmVkW10sXG4gIHR5cGU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPExhbWJkYVR5cGVOb2RlPiB7XG4gIGlmICghcGFyYW1ldGVycykgcGFyYW1ldGVycyA9IFtdXG4gIHJldHVybiB7IGxhbWJkYTogam9pbihzYW5pdGl6ZSh7IHBhcmFtZXRlcnMsIHR5cGUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGFtYmRhVHlwZU5vZGUge1xuICBsYW1iZGE6IHtcbiAgICBwYXJhbWV0ZXJzPzogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHwgdW5kZWZpbmVkW10sXG4gICAgdHlwZT86IFR5cGVOb2RlLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRm9ybWFsUGFyZW1ldGVyU2VxdWVuY2VOb2RlKFxuICBwYXJhbWV0ZXJzOiBQYXJ0aWFsPFBhcmFtZXRlck5vZGU+W10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHtcbiAgcmV0dXJuIHsgcGFyYW1ldGVycywgdGV4dCB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlIHtcbiAgcGFyYW1ldGVyczogUGFydGlhbDxQYXJhbWV0ZXJOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcmFtZXRlck5vZGUoXG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxuICB0eXBlPzogUGFydGlhbDxUeXBlTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8UGFyYW1ldGVyTm9kZT4ge1xuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IGlkZW50aWZpZXIsIHR5cGUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcmFtZXRlck5vZGUge1xuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcbiAgdHlwZT86IFBhcnRpYWw8VHlwZU5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUdXBsZVR5cGVOb2RlKFxuICBpZGVudGlmaWVyOiBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPixcbiAgdHlwZXM6IFBhcnRpYWw8VHlwZU5vZGUgfCBUdXBsZUV4dGVuZGVkVHlwZU5vZGU+W10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxUdXBsZVR5cGVOb2RlPiB7XG4gIHJldHVybiB7IHR1cGxlOiBqb2luKHNhbml0aXplKHsgaWRlbnRpZmllciwgdHlwZXMgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHVwbGVUeXBlTm9kZSB7XG4gIHR1cGxlOiB7XG4gICAgaWRlbnRpZmllcj86IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxuICAgIHR5cGVzPzogUGFydGlhbDxUeXBlTm9kZSB8IFR1cGxlRXh0ZW5kZWRUeXBlTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHVwbGVFeHRlbmRlZFR5cGVOb2RlKFxuICB0eXBlOiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT4sXG4gIGhlcml0YWdlOiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT4sIHRleHQ/OiBzdHJpbmdcbik6IFR1cGxlRXh0ZW5kZWRUeXBlTm9kZSB7XG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgdHlwZSwgaGVyaXRhZ2UgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFR1cGxlRXh0ZW5kZWRUeXBlTm9kZSB7XG4gIHR5cGU/OiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT5cbiAgaGVyaXRhZ2U/OiBQYXJ0aWFsPFByaW1hcnlUeXBlTm9kZT5cbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUHJpbWFyeVR5cGVOb2RlKFxuICBwcmltYXJ5OiBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDwoSWRlbnRpZmllck5vZGUgfCBLZXl3b3JkTm9kZSk+IHwgUGFydGlhbDxQcm9wZXJ0eUlkZW50aWZpZXJOb2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxQcmltYXJ5VHlwZU5vZGU+IHtcbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBwcmltYXJ5IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcmltYXJ5VHlwZU5vZGUge1xuICBwcmltYXJ5OiBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxJZGVudGlmaWVyTm9kZT4gfCBLZXl3b3JkTm9kZSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlS2V5d29yZE5vZGUoXG4gIHRleHQ6IHN0cmluZyB8IFwibnVsbFwiIHwgXCJ1bmRlZmluZWRcIlxuKTogS2V5d29yZE5vZGUge1xuICByZXR1cm4geyBrZXl3b3JkOiB0ZXh0ID8geyB0ZXh0IH0gOiB7fSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2V5d29yZE5vZGUge1xuICBrZXl3b3JkOiB7XG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYXJlbnRoZXNpemVkVHlwZU5vZGUoXG4gIHR5cGU6IFBhcnRpYWw8VHlwZU5vZGU+LFxuICBvcHRpb25hbCA9IGZhbHNlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRUeXBlTm9kZT4ge1xuICByZXR1cm4geyBwYXJlbnRoZXNpemVkOiBqb2luKHNhbml0aXplKHsgdHlwZSwgb3B0aW9uYWwgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcmVudGhlc2l6ZWRUeXBlTm9kZSB7XG4gIHBhcmVudGhlc2l6ZWQ6IHtcbiAgICB0eXBlPzogUGFydGlhbDxUeXBlTm9kZT4sXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVuYXJ5VHlwZU5vZGUoXG4gIG9wZXJhdG9yOiBzdHJpbmcgfCBcIiZcIiB8IFwiKlwiLFxuICByaWdodDogUGFydGlhbDxQcmltYXJ5VHlwZU5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPFVuYXJ5VHlwZU5vZGU+IHtcbiAgcmV0dXJuIHsgdW5hcnk6IGpvaW4oc2FuaXRpemUoeyBvcGVyYXRvciwgcmlnaHQgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5hcnlUeXBlTm9kZSB7XG4gIHVuYXJ5OiB7XG4gICAgb3BlcmF0b3I/OiBzdHJpbmcgfCBcIiZcIiB8IFwiKlwiLFxuICAgIHJpZ2h0PzogUGFydGlhbDxQcmltYXJ5VHlwZU5vZGU+LFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT2JqZWN0VHlwZU5vZGUoXG4gIG9iamVjdD86IFBhcnRpYWw8T2JqZWN0UGFpclR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8T2JqZWN0VHlwZU5vZGU+IHtcbiAgaWYgKCFvYmplY3QpIG9iamVjdCA9IFtdO1xuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IG9iamVjdCB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0VHlwZU5vZGUge1xuICBvYmplY3Q6IFBhcnRpYWw8T2JqZWN0UGFpclR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdFBhaXJUeXBlTm9kZShcbiAga2V5OiBUeXBlTm9kZSxcbiAgdmFsdWU6IFR5cGVOb2RlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPE9iamVjdFBhaXJUeXBlTm9kZT4ge1xuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IGtleSwgdmFsdWUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9iamVjdFBhaXJUeXBlTm9kZSB7XG4gIGtleTogUGFydGlhbDxUeXBlTm9kZT4sXG4gIHZhbHVlOiBQYXJ0aWFsPFR5cGVOb2RlPixcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQXJyYXlUeXBlTm9kZShcbiAgdHlwZTogUGFydGlhbDxUeXBlTm9kZT4sXG4gIHR5cGVzOiBQYXJ0aWFsPFR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10sXG4gIHRleHQ/OiBzdHJpbmdcbik6IEFycmF5VHlwZU5vZGUge1xuICBpZiAoIXR5cGVzKSB0eXBlcyA9IFtdO1xuXG4gIHJldHVybiB7IGFycmF5OiBqb2luKHNhbml0aXplKHsgdHlwZSwgdHlwZXMgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXJyYXlUeXBlTm9kZSB7XG4gIGFycmF5OiB7XG4gICAgdHlwZT86IFBhcnRpYWw8VHlwZU5vZGU+LFxuICAgIHR5cGVzPzogUGFydGlhbDxUeXBlTm9kZT5bXSB8IHVuZGVmaW5lZFtdLFxuICAgIHRleHQ/OiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUHJvcGVydHlJZGVudGlmaWVyTm9kZShcbiAgcHJvcGVydHk6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+W10gfCB1bmRlZmluZWRbXSxcbiAgdGV4dDogc3RyaW5nXG4pOiBQYXJ0aWFsPFByb3BlcnR5SWRlbnRpZmllck5vZGU+IHtcbiAgcmV0dXJuIGNyZWF0ZUlkZW50aWZpZXJOb2RlKHRleHQsIGZhbHNlLCBwcm9wZXJ0eSlcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvcGVydHlJZGVudGlmaWVyTm9kZSBleHRlbmRzIElkZW50aWZpZXJOb2RlIHsgfVxuXG5cbi8qIEV4cHJlc3Npb24gKi9cblxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gIGV4cHJlc3Npb246XG4gICAgUGFydGlhbDxVbmFyeUV4cHJlc3Npb25Ob2RlPlxuICAgIHwgUGFydGlhbDxCaW5hcnlFeHByZXNzaW9uTm9kZT5cbiAgICB8IFBhcnRpYWw8QXJyYXlFeHByZXNzaW9uTm9kZT5cbiAgICB8IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+XG4gICAgfCBQYXJ0aWFsPExhbWJkYUV4cHJlc3Npb25Ob2RlPlxuICAgIHwgUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+XG4gICAgfCBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmcsXG4pOiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPiB7XG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgZXhwcmVzc2lvbiB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXhwcmVzc2lvbk5vZGUge1xuICBleHByZXNzaW9uOlxuICBVbmFyeUV4cHJlc3Npb25Ob2RlXG4gIHwgQmluYXJ5RXhwcmVzc2lvbk5vZGVcbiAgfCBBcnJheUV4cHJlc3Npb25Ob2RlXG4gIHwgT2JqZWN0RXhwcmVzc2lvbk5vZGVcbiAgfCBMYW1iZGFFeHByZXNzaW9uTm9kZVxuICB8IExpdGVyYWxFeHByZXNzaW9uTm9kZVxuICB8IFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZVxuICB0ZXh0Pzogc3RyaW5nXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbk5vZGUoXG4gIG9wZXJhdG9yOiBzdHJpbmcgfCAnKycgfCAnLScsXG4gIHJpZ2h0OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxVbmFyeUV4cHJlc3Npb25Ob2RlPiB7XG4gIHJldHVybiB7IHVuYXJ5OiBqb2luKHNhbml0aXplKHsgb3BlcmF0b3IsIHJpZ2h0IH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuYXJ5RXhwcmVzc2lvbk5vZGUge1xuICB1bmFyeToge1xuICAgIG9wZXJhdG9yPzogc3RyaW5nIHwgJysnIHwgJy0nLFxuICAgIHJpZ2h0PzogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXG4gICAgdGV4dD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCaW5hcnlFeHByZXNzaW9uTm9kZShcbiAgb3BlcmF0b3I6IHN0cmluZyB8ICcrJyB8ICctJyxcbiAgbGVmdDogUGFydGlhbDxFeHByZXNzaW9uTm9kZT4sXG4gIHJpZ2h0OiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxCaW5hcnlFeHByZXNzaW9uTm9kZT4ge1xuICByZXR1cm4geyBiaW5hcnk6IGpvaW4oc2FuaXRpemUoeyBsZWZ0LCByaWdodCwgb3BlcmF0b3IgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmluYXJ5RXhwcmVzc2lvbk5vZGUge1xuICBiaW5hcnk6IHtcbiAgICBvcGVyYXRvcj86IHN0cmluZyB8ICcrJyB8ICctJyB8ICcqJyB8ICcvJyxcbiAgICBsZWZ0PzogRXhwcmVzc2lvbk5vZGUsXG4gICAgcmlnaHQ/OiBFeHByZXNzaW9uTm9kZSxcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFycmF5RXhwcmVzc2lvbk5vZGUoXG4gIGFycmF5PzogUGFydGlhbDxFeHByZXNzaW9uTm9kZT5bXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxBcnJheUV4cHJlc3Npb25Ob2RlPiB7XG4gIGlmICghYXJyYXkpIGFycmF5ID0gW107XG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgYXJyYXkgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFycmF5RXhwcmVzc2lvbk5vZGUge1xuICBhcnJheT86IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+W10sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdEV4cHJlc3Npb25Ob2RlKFxuICBvYmplY3Q/OiBQYXJ0aWFsPE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZT5bXSxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxPYmplY3RFeHByZXNzaW9uTm9kZT4ge1xuICBpZiAoIW9iamVjdCkgb2JqZWN0ID0gW11cbiAgcmV0dXJuIGpvaW4oc2FuaXRpemUoeyBvYmplY3QgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9iamVjdEV4cHJlc3Npb25Ob2RlIHtcbiAgb2JqZWN0OiBQYXJ0aWFsPE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZT5bXSxcbiAgdGV4dD86IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlKFxuICBrZXk6IFBhcnRpYWw8TGl0ZXJhbEV4cHJlc3Npb25Ob2RlPixcbiAgdmFsdWU6IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+IHwgUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+LFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZT4ge1xuICByZXR1cm4gam9pbihzYW5pdGl6ZSh7IGtleSwgdmFsdWUgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZSB7XG4gIGtleTogUGFydGlhbDxMaXRlcmFsRXhwcmVzc2lvbk5vZGU+LFxuICB2YWx1ZTogUGFydGlhbDxPYmplY3RFeHByZXNzaW9uTm9kZT4gfCBQYXJ0aWFsPExpdGVyYWxFeHByZXNzaW9uTm9kZT4sXG4gIHRleHQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxhbWJkYUV4cHJlc3Npb25Ob2RlKFxuICBwYXJhbWV0ZXJzOiBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUgfCB1bmRlZmluZWRbXSxcbiAgdHlwZTogVHlwZU5vZGUsXG4gIHRleHQ/OiBzdHJpbmdcbik6IFBhcnRpYWw8TGFtYmRhRXhwcmVzc2lvbk5vZGU+IHtcbiAgaWYgKCFwYXJhbWV0ZXJzKSBwYXJhbWV0ZXJzID0gW11cbiAgcmV0dXJuIGNyZWF0ZUxhbWJkYVR5cGVOb2RlKHBhcmFtZXRlcnMsIHR5cGUsIHRleHQpXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGFtYmRhRXhwcmVzc2lvbk5vZGUgZXh0ZW5kcyBMYW1iZGFUeXBlTm9kZSB7IH1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhcmVudGhlc2l6ZWRFeHByZXNzaW9uZU5vZGUoXG4gIGV4cHJlc3Npb246IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+LFxuICBvcHRpb25hbCA9IGZhbHNlLFxuICB0ZXh0Pzogc3RyaW5nXG4pOiBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZT4ge1xuICByZXR1cm4geyBwYXJlbnRoZXNpemVkOiBqb2luKHNhbml0aXplKHsgZXhwcmVzc2lvbiwgb3B0aW9uYWwgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9O1xufVxuZXhwb3J0IGludGVyZmFjZSBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGUge1xuICBwYXJlbnRoZXNpemVkOiB7XG4gICAgZXhwcmVzc2lvbj86IEV4cHJlc3Npb25Ob2RlLFxuICAgIG9wdGlvbmFsPzogYm9vbGVhbixcbiAgICB0ZXh0Pzogc3RyaW5nXG4gIH1cbn07XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZShcbiAgdHlwZTogc3RyaW5nLFxuICB0ZXh0OiBzdHJpbmdcbik6IFBhcnRpYWw8TGl0ZXJhbEV4cHJlc3Npb25Ob2RlPiB7XG4gIHJldHVybiB7IGxpdGVyYWw6IGpvaW4oc2FuaXRpemUoeyB0eXBlIH0pLCB0ZXh0ID8geyB0ZXh0IH0gOiB7fSkgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpdGVyYWxFeHByZXNzaW9uTm9kZSB7XG4gIGxpdGVyYWw6IHtcbiAgICB0eXBlPzogc3RyaW5nLFxuICAgIHRleHQ/OiBzdHJpbmcsXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlc2NyaXB0aW9uTm9kZShcbiAgdGV4dDogc3RyaW5nLFxuICBpbmxpbmVzPzogUGFydGlhbDxJbmxpbmVUYWdOb2RlPltdXG4pOiBQYXJ0aWFsPERlc2NyaXB0aW9uTm9kZT4ge1xuICBpZiAoIWlubGluZXMpIGlubGluZXMgPSBbXVxuICByZXR1cm4geyBkZXNjcmlwdGlvbjogam9pbihzYW5pdGl6ZSh7IGlubGluZXMgfSksIHRleHQgPyB7IHRleHQgfSA6IHt9KSB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVzY3JpcHRpb25Ob2RlIHtcbiAgZGVzY3JpcHRpb246IHtcbiAgICB0ZXh0Pzogc3RyaW5nLFxuICAgIGlubGluZXM/OiBQYXJ0aWFsPElubGluZVRhZ05vZGU+W11cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW5saW5lVGFnTm9kZShcbiAgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4sXG4gIGJvZHk6IHN0cmluZyxcbiAgdGV4dD86IHN0cmluZ1xuKTogUGFydGlhbDxJbmxpbmVUYWdOb2RlPiB7XG4gIHJldHVybiBqb2luKHNhbml0aXplKHsgaWRlbnRpZmllciwgYm9keSB9KSwgdGV4dCA/IHsgdGV4dCB9IDoge30pXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5saW5lVGFnTm9kZSB7XG4gIGlkZW50aWZpZXI6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+LFxuICBib2R5Pzogc3RyaW5nLFxuICB0ZXh0Pzogc3RyaW5nXG59Il19