"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Parser = require("./XDocSyntaxParser");
require("./XDocSyntaxParserVisitor");
const XDocASTNode_1 = require("./XDocASTNode");
/**
 * XDocAST is a class that converts a Antlr parse tree
 * into a Javascript tree object.
 *
 * # API
 *
 * ```
 * @class XDocAST
 * ```
 */
class XDocASTVisitor {
    constructor(documentation, options) {
        this.options = {
            showNodeText: false
        };
        /**
         * Converts the Antlr parse tree into a JavaScript tree object.
         *
         * # API
         *
         * ```
         * @method visit
         * @param context: Parser.DocumentationConext
         * @return: {
         *  name?: string,
         *  id?: {},
         *  value?: {},
         *  type?: {},
         *  description?: {}
         * }[]
         * ```
         */
        this.visit = () => {
            return this.visitDocumentation(this.documentation);
        };
        /* Documentation visitor */
        this.visitDocumentation = (context) => {
            if (context.body()) {
                return XDocASTNode_1.createDocumentationNode(this.visitBody(context.body()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitBody = (context) => {
            if (context.annotations()) {
                return XDocASTNode_1.createBodyNode(this.visitAnnotations(context.annotations(), this.options), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitAnnotations = (context, options) => {
            if (context.tag()) {
                return (context.tag() || []).map(this.visitTag);
            }
        };
        this.visitTag = (context) => {
            let name, identifier, type, expression, description;
            if (context.tagName()) {
                name = this.visitTagName(context.tagName());
            }
            if (context.tagIdentifier()) {
                identifier = this.visitTagIdentifier(context.tagIdentifier());
            }
            if (context.type()) {
                type = this.visitType(context.type());
            }
            if (context.expression()) {
                expression = this.visitExpression(context.expression());
            }
            if (context.description()) {
                description = this.visitDescription(context.description());
            }
            return XDocASTNode_1.createTagNode(name, identifier, type, expression, description, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTagName = (context) => {
            if (context.identifier()) {
                return XDocASTNode_1.createTagNameNode(this.visitIdentifier(context.identifier()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitTagIdentifier = (context) => {
            let identifier, property;
            if (context.identifier()) {
                identifier = this.visitIdentifier(context.identifier());
            }
            if (context.optionalTagIdentifier()) {
                identifier = this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            }
            if (context.propertyTagIdentifier()) {
                property = this.visitPropertyTagIdentifier(context.propertyTagIdentifier());
            }
            return XDocASTNode_1.createTagIdentifierNode(identifier, property, this.options.showNodeText ? context.text : undefined);
        };
        this.visitPropertyTagIdentifier = (context) => {
            // Assume 'context' is defined.
            let identifier = context.identifier() ?
                this.visitIdentifier(context.identifier()) :
                this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            // A property must exist since by grammar:
            // (optionalTagIdentifier | identifier) ('.' optionalTagOrIdentifier)+
            let property = context.optionalTagOrIdentifier()
                .map(this.visitOptionalTagOrIdentifier);
            // Add the identifier to the beginning of the array
            property.unshift(identifier);
            return XDocASTNode_1.createPropertyTagIdentifierNode(property, context.text);
        };
        this.visitOptionalTagIdentifer = (context) => {
            if (context.optionalIdentifier()) {
                return XDocASTNode_1.createOptionalTagIdentifierNode(this.visitOptionalIdentifier(context.optionalIdentifier()));
            }
        };
        this.visitOptionalTagOrIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.optionalTagIdentifier()) {
                return this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            }
        };
        this.visitIdentifier = (context, optional = false) => {
            if (context.ID()) {
                return XDocASTNode_1.createIdentifierNode(context.ID().text, optional, []);
            }
        };
        /* Type visitor */
        this.visitType = (context, optional = false) => {
            // Intersections
            if (context.PIPE()) {
                return XDocASTNode_1.createTypeNode(XDocASTNode_1.createIntersectTypeNode(this.visitType(context instanceof Parser.TypeContext ? context.type(0) : context.notArrayType(0)), this.visitType(context instanceof Parser.TypeContext ? context.type(1) : context.notArrayType(1)), this.options.showNodeText ? context.text : undefined), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.AMP()) { // Unions
                return XDocASTNode_1.createTypeNode(XDocASTNode_1.createUnionTypeNode(this.visitType(context instanceof Parser.TypeContext ? context.type(0) : context.notArrayType(0)), this.visitType(context instanceof Parser.TypeContext ? context.type(1) : context.notArrayType(1)), this.options.showNodeText ? context.text : undefined), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.lambdaType()) { // Lambda functions i.e. (id) => type
                return XDocASTNode_1.createTypeNode(this.visitLambdaType(context.lambdaType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.tupleType()) { // id<type, type>
                return XDocASTNode_1.createTypeNode(this.visitTuple(context.tupleType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.primaryType()) { // Primary
                return XDocASTNode_1.createTypeNode(this.visitPrimaryType(context.primaryType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.parenthesizedType()) { // (expression)
                return XDocASTNode_1.createTypeNode(this.visitParenthesizedType(context.parenthesizedType(), optional), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.unaryType()) {
                return XDocASTNode_1.createTypeNode(this.visitUnaryType(context.unaryType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.objectType()) { // { ... }
                return XDocASTNode_1.createTypeNode(this.visitObjectType(context.objectType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context instanceof Parser.TypeContext && context.arrayType()) { // [ ... ]
                return XDocASTNode_1.createTypeNode(this.visitArrayType(context.arrayType()), optional, this.options.showNodeText ? context.text : undefined);
            }
        };
        /* Lambda visitor */
        this.visitLambdaType = (context) => {
            if (context.formalParameterSequence()) {
                return XDocASTNode_1.createLambdaTypeNode(this.visitLambdaFormalParameterSequence(context.formalParameterSequence()), this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
            }
            else if (context.parameter()) {
                return XDocASTNode_1.createLambdaTypeNode(this.visitLambdaFormalParameterSequence(context.parameter()), this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
            }
            return XDocASTNode_1.createLambdaTypeNode(null, this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitLambdaFormalParameterSequence = (context) => {
            if (context instanceof Parser.ParameterContext) {
                return XDocASTNode_1.createFormalParemeterSequenceNode([this.visitParameter(context)]);
            }
            return XDocASTNode_1.createFormalParemeterSequenceNode(this.visitParameters(context.parameter()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitParameters = (contexts) => {
            return contexts.map(context => {
                return this.visitParameter(context);
            });
        };
        this.visitParameter = (context) => {
            let identifier = this.visitIdentifier(context.identifier());
            let type;
            if (context.type()) {
                type = this.visitType(context.type());
            }
            return XDocASTNode_1.createParameterNode(identifier, type, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTuple = (context) => {
            let identifier;
            let types;
            if (context.identifier()) {
                identifier = this.visitIdentifier(context.identifier());
            }
            if (context.tupleTypeSequence()) {
                types = this.visitTupleSequenceType(context.tupleTypeSequence());
            }
            return XDocASTNode_1.createTupleTypeNode(identifier, types, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTupleSequenceType = (context) => {
            return (context.type() || []).map(type => this.visitType(type));
        };
        this.visitPrimaryType = (context) => {
            let primary;
            if (context.optionalIdentifier()) {
                primary = this.visitOptionalIdentifier(context.optionalIdentifier());
            }
            else if (context.identifierOrKeyword()) {
                primary = this.visitIdentifierOrKeyword(context.identifierOrKeyword());
            }
            else if (context.propertyIdentifier()) {
                primary = this.visitPropertyIdentifier(context.propertyIdentifier());
            }
            return XDocASTNode_1.createPrimaryTypeNode(primary, this.options.showNodeText ? context.text : undefined);
        };
        this.visitIdentifierOrKeyword = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.keyword()) {
                return this.visitKeyword(context.keyword());
            }
        };
        this.visitKeyword = (context) => {
            if (context.NullLiteral()) {
                return XDocASTNode_1.createKeywordNode(context.NullLiteral().text);
            }
        };
        this.visitParenthesizedType = (context, optional = false) => {
            if (context.type()) {
                return XDocASTNode_1.createParenthesizedTypeNode(this.visitType(context.type()), optional, this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitUnaryType = (context) => {
            return XDocASTNode_1.createUnaryTypeNode((context.AMP() || context.STAR()).text, this.visitPrimaryType(context.primaryType()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectType = (context) => {
            return XDocASTNode_1.createObjectTypeNode(this.visitObjectPairSequenceType(context.objectPairSequenceType()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectPairSequenceType = (context) => {
            return (context ? context.objectPairType() : []).map(pair => {
                return XDocASTNode_1.createObjectPairTypeNode(this.visitType(pair.type(0)), this.visitType(pair.type(1)), this.options.showNodeText ? pair.text : undefined);
            });
        };
        this.visitArrayType = (context) => {
            if (context.notArrayType()) {
                return XDocASTNode_1.createArrayTypeNode(this.visitType(context.notArrayType()), (context.type() || []).map(type => this.visitType(type)), this.options.showNodeText ? context.text : undefined);
            }
            return XDocASTNode_1.createArrayTypeNode(null, (context.type() || []).map(type => this.visitType(type)), this.options.showNodeText ? context.text : undefined);
        };
        this.visitPropertyIdentifier = (context) => {
            // Assume 'context' is defined.
            let identifier = context.identifier() ?
                this.visitIdentifier(context.identifier()) :
                this.visitOptionalIdentifier(context.optionalIdentifier());
            // A property must exist since by grammar:
            // (optionalIdentifier | identifier) ('.' optionalIdentifierOrIdentifier)+
            let property = context.optionalIdentifierOrIdentifier()
                .map(this.visitOptionalIdentifierOrIdentifier);
            // Add the identifier to the beginning of the array
            property.unshift(identifier);
            return XDocASTNode_1.createPropertyIdentifierNode(property, context.text);
        };
        this.visitOptionalIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier(), !!context.QUESTION());
            }
        };
        this.visitOptionalIdentifierOrIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.optionalIdentifier()) {
                return this.visitOptionalIdentifier(context.optionalIdentifier());
            }
        };
        /* Expression visitor */
        this.visitExpression = (context) => {
            if (context.unaryExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitUnaryExpression(context.unaryExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.expression().length > 1) {
                return XDocASTNode_1.createExpressionNode(XDocASTNode_1.createBinaryExpressionNode((context.PLUS() || context.MINUS() || context.STAR() || context.FORWARD_SLASH()).text, this.visitExpression(context.expression(0)), this.visitExpression(context.expression(1)), this.options.showNodeText ? context.text : undefined), this.options.showNodeText ? context.text : undefined);
            }
            if (context.arrayExpression()) {
                return XDocASTNode_1.createExpressionNode(XDocASTNode_1.createArrayExpressionNode(this.visitArrayExpression(context.arrayExpression()), this.options.showNodeText ? context.arrayExpression().text : undefined), this.options.showNodeText ? context.text : undefined);
            }
            if (context.objectExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitObjectExpression(context.objectExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.lambdaExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitLambdaExpression(context.lambdaExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.literalExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitLiteralExpression(context.literalExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.parenthesizedExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitParenthesizedExpression(context.parenthesizedExpression()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitUnaryExpression = (context) => {
            return XDocASTNode_1.createUnaryExpressionNode((context.PLUS() || context.MINUS()).text, this.visitExpression(context.expression()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitArrayExpression = (context) => {
            return (context ? context.expression() : []).map(expression => {
                return this.visitExpression(expression);
            });
        };
        this.visitObjectExpression = (context) => {
            return XDocASTNode_1.createObjectExpressionNode(this.visitObjectPairSequenceExpression(context.objectPairSequenceExpression()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectPairSequenceExpression = (context) => {
            return (context ? context.objectPairExpression() : []).map(pair => {
                return XDocASTNode_1.createObjectPairExpressionNode(this.visitLiteralExpression(pair.literalExpression(0)), pair.objectExpression() ?
                    this.visitObjectExpression(pair.objectExpression()) :
                    this.visitLiteralExpression(pair.literalExpression(1)), this.options.showNodeText ? context.text : undefined);
            });
        };
        this.visitLambdaExpression = (context) => {
            return this.visitLambdaType(context);
        };
        this.visitParenthesizedExpression = (context) => {
            return XDocASTNode_1.createParenthesizedExpressioneNode(this.visitExpression(context.expression()));
        };
        this.visitLiteralExpression = (context) => {
            let node = { literal: {} };
            if (context.NumberLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('number', context.NumberLiteral().text);
            }
            if (context.BooleanLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('boolean', context.BooleanLiteral().text);
            }
            if (context.CharacterLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('character', context.CharacterLiteral().text);
            }
            if (context.StringLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('string', context.StringLiteral().text);
            }
            if (context.NullLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('null', context.NullLiteral().text);
            }
        };
        /* Description visitor */
        this.visitDescription = (context) => {
            return XDocASTNode_1.createDescriptionNode(context.text, this.visitDescriptionLine(context.descriptionLine()));
        };
        this.visitDescriptionLine = (context) => {
            return this.visitDescriptionLineElement(context.descriptionLineElement());
        };
        this.visitDescriptionLineElement = (context) => {
            return (context || []).map(element => {
                return element.inlineTag() ? this.visitInlineTag(element.inlineTag()) : undefined;
            }).filter(element => element !== undefined);
        };
        this.visitInlineTag = (context) => {
            return XDocASTNode_1.createInlineTagNode(this.visitIdentifier(context.inlineTagName().identifier()), this.visitInlineTagBody(context.inlineTagBody()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitInlineTagBody = (context) => {
            return context.braceBody().map(body => body.text).join('');
        };
        Object.assign(this.options, options);
        this.documentation = documentation;
    }
}
exports.default = XDocASTVisitor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVFZpc2l0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVFZpc2l0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2Q0FBNkM7QUFDN0MscUNBQW1DO0FBQ25DLCtDQTZEdUI7QUFNdkI7Ozs7Ozs7OztHQVNHO0FBQ0gsTUFBcUIsY0FBYztJQU1qQyxZQUFZLGFBQTBDLEVBQUUsT0FBK0I7UUFKL0UsWUFBTyxHQUEwQjtZQUN2QyxZQUFZLEVBQUUsS0FBSztTQUNwQixDQUFBO1FBTUQ7Ozs7Ozs7Ozs7Ozs7Ozs7V0FnQkc7UUFDSCxVQUFLLEdBQUcsR0FBc0IsRUFBRTtZQUM5QixPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFBO1FBQ0QsMkJBQTJCO1FBRTNCLHVCQUFrQixHQUFHLENBQ25CLE9BQW9DLEVBQ2pCLEVBQUU7WUFDckIsSUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQ2xCLE9BQU8scUNBQXVCLENBQzVCLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQzlCLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQ3JELENBQUE7YUFDRjtRQUNILENBQUMsQ0FBQTtRQUVELGNBQVMsR0FBRyxDQUNWLE9BQTJCLEVBQ2pCLEVBQUU7WUFDWixJQUFJLE9BQU8sQ0FBQyxXQUFXLEVBQUUsRUFBRTtnQkFDekIsT0FBTyw0QkFBYyxDQUNuQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsRUFDMUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMs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QUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7SUFDckMsQ0FBQztDQTBpQkY7QUFuakJELGlDQW1qQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgKiBhcyBQYXJzZXIgZnJvbSAnLi9YRG9jU3ludGF4UGFyc2VyJztcbmltcG9ydCAnLi9YRG9jU3ludGF4UGFyc2VyVmlzaXRvcic7XG5pbXBvcnQge1xuICBBbm5vdGF0aW9uc05vZGUsXG4gIEFycmF5VHlwZU5vZGUsXG4gIEJvZHlOb2RlLFxuICBjcmVhdGVBcnJheUV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVBcnJheVR5cGVOb2RlLFxuICBjcmVhdGVCaW5hcnlFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlQm9keU5vZGUsXG4gIGNyZWF0ZURlc2NyaXB0aW9uTm9kZSxcbiAgY3JlYXRlRG9jdW1lbnRhdGlvbk5vZGUsXG4gIGNyZWF0ZUV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVGb3JtYWxQYXJlbWV0ZXJTZXF1ZW5jZU5vZGUsXG4gIGNyZWF0ZUlkZW50aWZpZXJOb2RlLFxuICBjcmVhdGVJbmxpbmVUYWdOb2RlLFxuICBjcmVhdGVJbnRlcnNlY3RUeXBlTm9kZSxcbiAgY3JlYXRlS2V5d29yZE5vZGUsXG4gIGNyZWF0ZUxhbWJkYVR5cGVOb2RlLFxuICBjcmVhdGVMaXRlcmFsRXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZU9iamVjdEV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZU9iamVjdFBhaXJUeXBlTm9kZSxcbiAgY3JlYXRlT2JqZWN0VHlwZU5vZGUsXG4gIGNyZWF0ZVBhcmFtZXRlck5vZGUsXG4gIGNyZWF0ZVBhcmVudGhlc2l6ZWRUeXBlTm9kZSxcbiAgY3JlYXRlUHJpbWFyeVR5cGVOb2RlLFxuICBjcmVhdGVQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlLFxuICBjcmVhdGVQcm9wZXJ0eUlkZW50aWZpZXJOb2RlLFxuICBjcmVhdGVUYWdJZGVudGlmaWVyTm9kZSwgY3JlYXRlT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSxcbiAgY3JlYXRlVGFnTmFtZU5vZGUsXG4gIGNyZWF0ZVRhZ05vZGUsXG4gIGNyZWF0ZVR1cGxlVHlwZU5vZGUsXG4gIGNyZWF0ZVR5cGVOb2RlLFxuICBjcmVhdGVVbmFyeUV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVVbmFyeVR5cGVOb2RlLFxuICBjcmVhdGVVbmlvblR5cGVOb2RlLFxuICBEZXNjcmlwdGlvbk5vZGUsXG4gIERvY3VtZW50YXRpb25Ob2RlLFxuICBFeHByZXNzaW9uTm9kZSxcbiAgRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlLFxuICBJZGVudGlmaWVyTm9kZSxcbiAgSW5saW5lVGFnTm9kZSxcbiAgS2V5d29yZE5vZGUsXG4gIExhbWJkYUV4cHJlc3Npb25Ob2RlLFxuICBMYW1iZGFUeXBlTm9kZSxcbiAgTGl0ZXJhbEV4cHJlc3Npb25Ob2RlLFxuICBPYmplY3RFeHByZXNzaW9uTm9kZSxcbiAgT2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlLFxuICBPcHRpb25hbElkZW50aWZpZXJOb2RlLFxuICBPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlLFxuICBQYXJhbWV0ZXJOb2RlLFxuICBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGUsXG4gIFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUsXG4gIFRhZ0lkZW50aWZpZXJOb2RlLFxuICBUYWdOYW1lTm9kZSxcbiAgVGFnTm9kZSxcbiAgVHVwbGVUeXBlTm9kZSxcbiAgVHlwZU5vZGUsXG4gIFVuYXJ5RXhwcmVzc2lvbk5vZGUsXG4gIFByb3BlcnR5SWRlbnRpZmllck5vZGUsXG4gIFBhcmVudGhlc2l6ZWRUeXBlTm9kZSxcbiAgY3JlYXRlUGFyZW50aGVzaXplZEV4cHJlc3Npb25lTm9kZSxcbn0gZnJvbSAnLi9YRG9jQVNUTm9kZSc7XG5cblxuZXhwb3J0IGludGVyZmFjZSBYRG9jQVNUVmlzaXRvck9wdGlvbnMge1xuICBzaG93Tm9kZVRleHQ6IGJvb2xlYW5cbn1cbi8qKlxuICogWERvY0FTVCBpcyBhIGNsYXNzIHRoYXQgY29udmVydHMgYSBBbnRsciBwYXJzZSB0cmVlXG4gKiBpbnRvIGEgSmF2YXNjcmlwdCB0cmVlIG9iamVjdC5cbiAqIFxuICogIyBBUElcbiAqIFxuICogYGBgXG4gKiBAY2xhc3MgWERvY0FTVFxuICogYGBgXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFhEb2NBU1RWaXNpdG9yIHtcbiAgcHJpdmF0ZSBkb2N1bWVudGF0aW9uOiBQYXJzZXIuRG9jdW1lbnRhdGlvbkNvbnRleHRcbiAgcHJpdmF0ZSBvcHRpb25zOiBYRG9jQVNUVmlzaXRvck9wdGlvbnMgPSB7XG4gICAgc2hvd05vZGVUZXh0OiBmYWxzZVxuICB9XG5cbiAgY29uc3RydWN0b3IoZG9jdW1lbnRhdGlvbjogUGFyc2VyLkRvY3VtZW50YXRpb25Db250ZXh0LCBvcHRpb25zPzogWERvY0FTVFZpc2l0b3JPcHRpb25zKSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgIHRoaXMuZG9jdW1lbnRhdGlvbiA9IGRvY3VtZW50YXRpb247XG4gIH1cbiAgLyoqXG4gICAqIENvbnZlcnRzIHRoZSBBbnRsciBwYXJzZSB0cmVlIGludG8gYSBKYXZhU2NyaXB0IHRyZWUgb2JqZWN0LlxuICAgKiBcbiAgICogIyBBUElcbiAgICogXG4gICAqIGBgYFxuICAgKiBAbWV0aG9kIHZpc2l0XG4gICAqIEBwYXJhbSBjb250ZXh0OiBQYXJzZXIuRG9jdW1lbnRhdGlvbkNvbmV4dFxuICAgKiBAcmV0dXJuOiB7IFxuICAgKiAgbmFtZT86IHN0cmluZywgXG4gICAqICBpZD86IHt9LCBcbiAgICogIHZhbHVlPzoge30sIFxuICAgKiAgdHlwZT86IHt9LCBcbiAgICogIGRlc2NyaXB0aW9uPzoge30gXG4gICAqIH1bXVxuICAgKiBgYGBcbiAgICovXG4gIHZpc2l0ID0gKCk6IERvY3VtZW50YXRpb25Ob2RlID0+IHtcbiAgICByZXR1cm4gdGhpcy52aXNpdERvY3VtZW50YXRpb24odGhpcy5kb2N1bWVudGF0aW9uKTtcbiAgfVxuICAvKiBEb2N1bWVudGF0aW9uIHZpc2l0b3IgKi9cblxuICB2aXNpdERvY3VtZW50YXRpb24gPSAoXG4gICAgY29udGV4dDogUGFyc2VyLkRvY3VtZW50YXRpb25Db250ZXh0XG4gICk6IERvY3VtZW50YXRpb25Ob2RlID0+IHtcbiAgICBpZiAoY29udGV4dC5ib2R5KCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVEb2N1bWVudGF0aW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdEJvZHkoY29udGV4dC5ib2R5KCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgdmlzaXRCb2R5ID0gKFxuICAgIGNvbnRleHQ6IFBhcnNlci5Cb2R5Q29udGV4dFxuICApOiBCb2R5Tm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQuYW5ub3RhdGlvbnMoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUJvZHlOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0QW5ub3RhdGlvbnMoY29udGV4dC5hbm5vdGF0aW9ucygpLCB0aGlzLm9wdGlvbnMpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0QW5ub3RhdGlvbnMgPSAoXG4gICAgY29udGV4dDogUGFyc2VyLkFubm90YXRpb25zQ29udGV4dCxcbiAgICBvcHRpb25zOiBYRG9jQVNUVmlzaXRvck9wdGlvbnNcbiAgKTogQW5ub3RhdGlvbnNOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dC50YWcoKSkge1xuICAgICAgcmV0dXJuIChjb250ZXh0LnRhZygpIHx8IFtdKS5tYXAodGhpcy52aXNpdFRhZylcbiAgICB9XG4gIH1cblxuXG4gIHZpc2l0VGFnID0gKGNvbnRleHQ6IFBhcnNlci5UYWdDb250ZXh0KTogVGFnTm9kZSA9PiB7XG4gICAgbGV0IG5hbWU6IFRhZ05hbWVOb2RlLFxuICAgICAgaWRlbnRpZmllcjogVGFnSWRlbnRpZmllck5vZGUsXG4gICAgICB0eXBlOiBUeXBlTm9kZSxcbiAgICAgIGV4cHJlc3Npb246IEV4cHJlc3Npb25Ob2RlLFxuICAgICAgZGVzY3JpcHRpb246IERlc2NyaXB0aW9uTm9kZTtcblxuICAgIGlmIChjb250ZXh0LnRhZ05hbWUoKSkge1xuICAgICAgbmFtZSA9IHRoaXMudmlzaXRUYWdOYW1lKGNvbnRleHQudGFnTmFtZSgpKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC50YWdJZGVudGlmaWVyKCkpIHtcbiAgICAgIGlkZW50aWZpZXIgPSB0aGlzLnZpc2l0VGFnSWRlbnRpZmllcihjb250ZXh0LnRhZ0lkZW50aWZpZXIoKSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQudHlwZSgpKSB7XG4gICAgICB0eXBlID0gdGhpcy52aXNpdFR5cGUoY29udGV4dC50eXBlKCkpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmV4cHJlc3Npb24oKSkge1xuICAgICAgZXhwcmVzc2lvbiA9IHRoaXMudmlzaXRFeHByZXNzaW9uKGNvbnRleHQuZXhwcmVzc2lvbigpKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmRlc2NyaXB0aW9uKCkpIHtcbiAgICAgIGRlc2NyaXB0aW9uID0gdGhpcy52aXNpdERlc2NyaXB0aW9uKGNvbnRleHQuZGVzY3JpcHRpb24oKSlcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlVGFnTm9kZShuYW1lLCBpZGVudGlmaWVyLCB0eXBlLCBleHByZXNzaW9uLCBkZXNjcmlwdGlvbiwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZClcbiAgfVxuXG4gIHZpc2l0VGFnTmFtZSA9IChjb250ZXh0OiBQYXJzZXIuVGFnTmFtZUNvbnRleHQpOiBUYWdOYW1lTm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQuaWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlVGFnTmFtZU5vZGUodGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpLCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKTtcbiAgICB9XG4gIH1cblxuICB2aXNpdFRhZ0lkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLlRhZ0lkZW50aWZpZXJDb250ZXh0KTogVGFnSWRlbnRpZmllck5vZGUgPT4ge1xuICAgIGxldCBpZGVudGlmaWVyOiBJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsSWRlbnRpZmllck5vZGUsXG4gICAgICBwcm9wZXJ0eTogUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZTtcbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIGlkZW50aWZpZXIgPSB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQub3B0aW9uYWxUYWdJZGVudGlmaWVyKCkpIHtcbiAgICAgIGlkZW50aWZpZXIgPSB0aGlzLnZpc2l0T3B0aW9uYWxUYWdJZGVudGlmZXIoY29udGV4dC5vcHRpb25hbFRhZ0lkZW50aWZpZXIoKSlcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5wcm9wZXJ0eVRhZ0lkZW50aWZpZXIoKSkge1xuICAgICAgcHJvcGVydHkgPSB0aGlzLnZpc2l0UHJvcGVydHlUYWdJZGVudGlmaWVyKGNvbnRleHQucHJvcGVydHlUYWdJZGVudGlmaWVyKCkpO1xuICAgIH1cblxuICAgIHJldHVybiBjcmVhdGVUYWdJZGVudGlmaWVyTm9kZShpZGVudGlmaWVyLCBwcm9wZXJ0eSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdFByb3BlcnR5VGFnSWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuUHJvcGVydHlUYWdJZGVudGlmaWVyQ29udGV4dCk6IFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUgPT4ge1xuXG4gICAgLy8gQXNzdW1lICdjb250ZXh0JyBpcyBkZWZpbmVkLlxuICAgIGxldCBpZGVudGlmaWVyID0gY29udGV4dC5pZGVudGlmaWVyKCkgP1xuICAgICAgdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpIDpcbiAgICAgIHRoaXMudmlzaXRPcHRpb25hbFRhZ0lkZW50aWZlcihjb250ZXh0Lm9wdGlvbmFsVGFnSWRlbnRpZmllcigpKTtcbiAgICAvLyBBIHByb3BlcnR5IG11c3QgZXhpc3Qgc2luY2UgYnkgZ3JhbW1hcjpcbiAgICAvLyAob3B0aW9uYWxUYWdJZGVudGlmaWVyIHwgaWRlbnRpZmllcikgKCcuJyBvcHRpb25hbFRhZ09ySWRlbnRpZmllcikrXG4gICAgbGV0IHByb3BlcnR5ID0gY29udGV4dC5vcHRpb25hbFRhZ09ySWRlbnRpZmllcigpXG4gICAgICAubWFwKHRoaXMudmlzaXRPcHRpb25hbFRhZ09ySWRlbnRpZmllcik7XG4gICAgLy8gQWRkIHRoZSBpZGVudGlmaWVyIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5XG4gICAgcHJvcGVydHkudW5zaGlmdChpZGVudGlmaWVyKTtcbiAgICByZXR1cm4gY3JlYXRlUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZShwcm9wZXJ0eSwgY29udGV4dC50ZXh0KTtcbiAgfVxuXG4gIHZpc2l0T3B0aW9uYWxUYWdJZGVudGlmZXIgPSAoY29udGV4dDogUGFyc2VyLk9wdGlvbmFsVGFnSWRlbnRpZmllckNvbnRleHQpOiBPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dC5vcHRpb25hbElkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZU9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUodGhpcy52aXNpdE9wdGlvbmFsSWRlbnRpZmllcihjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKSlcbiAgICB9XG4gIH1cblxuICB2aXNpdE9wdGlvbmFsVGFnT3JJZGVudGlmaWVyID0gKGNvbnRleHQ6IFBhcnNlci5PcHRpb25hbFRhZ09ySWRlbnRpZmllckNvbnRleHQpOiAoSWRlbnRpZmllck5vZGUgfCBPcHRpb25hbElkZW50aWZpZXJOb2RlKSA9PiB7XG4gICAgaWYgKGNvbnRleHQuaWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQub3B0aW9uYWxUYWdJZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0T3B0aW9uYWxUYWdJZGVudGlmZXIoY29udGV4dC5vcHRpb25hbFRhZ0lkZW50aWZpZXIoKSk7XG4gICAgfVxuICB9XG5cblxuICB2aXNpdElkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLklkZW50aWZpZXJDb250ZXh0LCBvcHRpb25hbCA9IGZhbHNlKTogSWRlbnRpZmllck5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LklEKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVJZGVudGlmaWVyTm9kZShjb250ZXh0LklEKCkudGV4dCwgb3B0aW9uYWwsIFtdKTtcbiAgICB9XG4gIH1cblxuICAvKiBUeXBlIHZpc2l0b3IgKi9cblxuICB2aXNpdFR5cGUgPSAoY29udGV4dDogUGFyc2VyLlR5cGVDb250ZXh0IHwgUGFyc2VyLk5vdEFycmF5VHlwZUNvbnRleHQsIG9wdGlvbmFsID0gZmFsc2UpOiBUeXBlTm9kZSA9PiB7XG5cbiAgICAvLyBJbnRlcnNlY3Rpb25zXG4gICAgaWYgKGNvbnRleHQuUElQRSgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIGNyZWF0ZUludGVyc2VjdFR5cGVOb2RlKFxuICAgICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQgaW5zdGFuY2VvZiBQYXJzZXIuVHlwZUNvbnRleHQgPyBjb250ZXh0LnR5cGUoMCk6IGNvbnRleHQubm90QXJyYXlUeXBlKDApKSxcbiAgICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0IGluc3RhbmNlb2YgUGFyc2VyLlR5cGVDb250ZXh0ID8gY29udGV4dC50eXBlKDEpOiBjb250ZXh0Lm5vdEFycmF5VHlwZSgxKSksXG4gICAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgICApLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5BTVAoKSkgeyAvLyBVbmlvbnNcbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgY3JlYXRlVW5pb25UeXBlTm9kZShcbiAgICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0IGluc3RhbmNlb2YgUGFyc2VyLlR5cGVDb250ZXh0ID8gY29udGV4dC50eXBlKDApOiBjb250ZXh0Lm5vdEFycmF5VHlwZSgwKSksXG4gICAgICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dCBpbnN0YW5jZW9mIFBhcnNlci5UeXBlQ29udGV4dCA/IGNvbnRleHQudHlwZSgxKTogY29udGV4dC5ub3RBcnJheVR5cGUoMSkpLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICAgKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQubGFtYmRhVHlwZSgpKSB7IC8vIExhbWJkYSBmdW5jdGlvbnMgaS5lLiAoaWQpID0+IHR5cGVcbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdExhbWJkYVR5cGUoY29udGV4dC5sYW1iZGFUeXBlKCkpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC50dXBsZVR5cGUoKSkgeyAvLyBpZDx0eXBlLCB0eXBlPlxuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0VHVwbGUoY29udGV4dC50dXBsZVR5cGUoKSksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnByaW1hcnlUeXBlKCkpIHsgLy8gUHJpbWFyeVxuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0UHJpbWFyeVR5cGUoY29udGV4dC5wcmltYXJ5VHlwZSgpKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQucGFyZW50aGVzaXplZFR5cGUoKSkgeyAvLyAoZXhwcmVzc2lvbilcbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdFBhcmVudGhlc2l6ZWRUeXBlKGNvbnRleHQucGFyZW50aGVzaXplZFR5cGUoKSwgb3B0aW9uYWwpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnVuYXJ5VHlwZSgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRVbmFyeVR5cGUoY29udGV4dC51bmFyeVR5cGUoKSksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0Lm9iamVjdFR5cGUoKSkgeyAvLyB7IC4uLiB9XG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRPYmplY3RUeXBlKGNvbnRleHQub2JqZWN0VHlwZSgpKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQgaW5zdGFuY2VvZiBQYXJzZXIuVHlwZUNvbnRleHQgJiYgY29udGV4dC5hcnJheVR5cGUoKSkgeyAvLyBbIC4uLiBdXG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRBcnJheVR5cGUoY29udGV4dC5hcnJheVR5cGUoKSksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qIExhbWJkYSB2aXNpdG9yICovXG5cbiAgdmlzaXRMYW1iZGFUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5MYW1iZGFUeXBlQ29udGV4dCk6IExhbWJkYVR5cGVOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dC5mb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZSgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGFtYmRhVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRMYW1iZGFGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZShjb250ZXh0LmZvcm1hbFBhcmFtZXRlclNlcXVlbmNlKCkpLFxuICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0LnR5cGUoKSwgISFjb250ZXh0LlFVRVNUSU9OKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuXG4gICAgfSBlbHNlIGlmIChjb250ZXh0LnBhcmFtZXRlcigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGFtYmRhVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRMYW1iZGFGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZShjb250ZXh0LnBhcmFtZXRlcigpKSxcbiAgICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dC50eXBlKCksICEhY29udGV4dC5RVUVTVElPTigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlTGFtYmRhVHlwZU5vZGUoXG4gICAgICBudWxsLFxuICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dC50eXBlKCksICEhY29udGV4dC5RVUVTVElPTigpKSxcbiAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICApXG4gIH1cblxuICB2aXNpdExhbWJkYUZvcm1hbFBhcmFtZXRlclNlcXVlbmNlID0gKGNvbnRleHQ6IFBhcnNlci5Gb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZUNvbnRleHQgfCBQYXJzZXIuUGFyYW1ldGVyQ29udGV4dCk6IEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQgaW5zdGFuY2VvZiBQYXJzZXIuUGFyYW1ldGVyQ29udGV4dCkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUZvcm1hbFBhcmVtZXRlclNlcXVlbmNlTm9kZShbdGhpcy52aXNpdFBhcmFtZXRlcihjb250ZXh0KV0pXG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVGb3JtYWxQYXJlbWV0ZXJTZXF1ZW5jZU5vZGUodGhpcy52aXNpdFBhcmFtZXRlcnMoY29udGV4dC5wYXJhbWV0ZXIoKSksIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpXG4gIH1cblxuICB2aXNpdFBhcmFtZXRlcnMgPSAoY29udGV4dHM6IFBhcnNlci5QYXJhbWV0ZXJDb250ZXh0W10pOiBQYXJhbWV0ZXJOb2RlW10gPT4ge1xuICAgIHJldHVybiBjb250ZXh0cy5tYXAoY29udGV4dCA9PiB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdFBhcmFtZXRlcihjb250ZXh0KTtcbiAgICB9KVxuICB9XG5cbiAgdmlzaXRQYXJhbWV0ZXIgPSAoY29udGV4dDogUGFyc2VyLlBhcmFtZXRlckNvbnRleHQpOiBQYXJhbWV0ZXJOb2RlID0+IHtcbiAgICBsZXQgaWRlbnRpZmllciA9IHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKTtcbiAgICBsZXQgdHlwZTogVHlwZU5vZGVcbiAgICBpZiAoY29udGV4dC50eXBlKCkpIHtcbiAgICAgIHR5cGUgPSB0aGlzLnZpc2l0VHlwZShjb250ZXh0LnR5cGUoKSk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVQYXJhbWV0ZXJOb2RlKGlkZW50aWZpZXIsIHR5cGUsIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpO1xuICB9XG5cbiAgdmlzaXRUdXBsZSA9IChjb250ZXh0OiBQYXJzZXIuVHVwbGVUeXBlQ29udGV4dCk6IFR1cGxlVHlwZU5vZGUgPT4ge1xuICAgIGxldCBpZGVudGlmaWVyOiBJZGVudGlmaWVyTm9kZVxuICAgIGxldCB0eXBlczogVHlwZU5vZGVbXVxuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgaWRlbnRpZmllciA9IHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC50dXBsZVR5cGVTZXF1ZW5jZSgpKSB7XG4gICAgICB0eXBlcyA9IHRoaXMudmlzaXRUdXBsZVNlcXVlbmNlVHlwZShjb250ZXh0LnR1cGxlVHlwZVNlcXVlbmNlKCkpO1xuICAgIH1cblxuICAgIHJldHVybiBjcmVhdGVUdXBsZVR5cGVOb2RlKGlkZW50aWZpZXIsIHR5cGVzLCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHZpc2l0VHVwbGVTZXF1ZW5jZVR5cGUgPSAoY29udGV4dDogUGFyc2VyLlR1cGxlVHlwZVNlcXVlbmNlQ29udGV4dCk6IFR5cGVOb2RlW10gfCB1bmRlZmluZWRbXSA9PiB7XG4gICAgcmV0dXJuIChjb250ZXh0LnR5cGUoKSB8fCBbXSkubWFwKHR5cGUgPT4gdGhpcy52aXNpdFR5cGUodHlwZSkpO1xuICB9XG5cbiAgdmlzaXRQcmltYXJ5VHlwZSA9IChjb250ZXh0OiBQYXJzZXIuUHJpbWFyeVR5cGVDb250ZXh0KSA9PiB7XG5cbiAgICBsZXQgcHJpbWFyeTogSWRlbnRpZmllck5vZGUgfCBLZXl3b3JkTm9kZSB8IFByb3BlcnR5SWRlbnRpZmllck5vZGU7XG5cbiAgICBpZiAoY29udGV4dC5vcHRpb25hbElkZW50aWZpZXIoKSkge1xuICAgICAgcHJpbWFyeSA9IHRoaXMudmlzaXRPcHRpb25hbElkZW50aWZpZXIoY29udGV4dC5vcHRpb25hbElkZW50aWZpZXIoKSk7XG4gICAgfSBlbHNlIGlmIChjb250ZXh0LmlkZW50aWZpZXJPcktleXdvcmQoKSkge1xuICAgICAgcHJpbWFyeSA9IHRoaXMudmlzaXRJZGVudGlmaWVyT3JLZXl3b3JkKGNvbnRleHQuaWRlbnRpZmllck9yS2V5d29yZCgpKVxuICAgIH0gZWxzZSBpZiAoY29udGV4dC5wcm9wZXJ0eUlkZW50aWZpZXIoKSkge1xuICAgICAgcHJpbWFyeSA9IHRoaXMudmlzaXRQcm9wZXJ0eUlkZW50aWZpZXIoY29udGV4dC5wcm9wZXJ0eUlkZW50aWZpZXIoKSk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVQcmltYXJ5VHlwZU5vZGUocHJpbWFyeSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdElkZW50aWZpZXJPcktleXdvcmQgPSAoY29udGV4dDogUGFyc2VyLklkZW50aWZpZXJPcktleXdvcmRDb250ZXh0KTogKElkZW50aWZpZXJOb2RlIHwgS2V5d29yZE5vZGUpID0+IHtcbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSlcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5rZXl3b3JkKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0S2V5d29yZChjb250ZXh0LmtleXdvcmQoKSlcbiAgICB9XG4gIH1cblxuICB2aXNpdEtleXdvcmQgPSAoY29udGV4dDogUGFyc2VyLktleXdvcmRDb250ZXh0KSA9PiB7XG4gICAgaWYgKGNvbnRleHQuTnVsbExpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUtleXdvcmROb2RlKGNvbnRleHQuTnVsbExpdGVyYWwoKS50ZXh0KTtcbiAgICB9XG4gIH1cblxuICB2aXNpdFBhcmVudGhlc2l6ZWRUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5QYXJlbnRoZXNpemVkVHlwZUNvbnRleHQsIG9wdGlvbmFsID0gZmFsc2UpOiBQYXJlbnRoZXNpemVkVHlwZU5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LnR5cGUoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZVBhcmVudGhlc2l6ZWRUeXBlTm9kZSh0aGlzLnZpc2l0VHlwZShjb250ZXh0LnR5cGUoKSksIG9wdGlvbmFsLCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKTtcbiAgICB9XG4gIH1cblxuICB2aXNpdFVuYXJ5VHlwZSA9IChjb250ZXh0OiBQYXJzZXIuVW5hcnlUeXBlQ29udGV4dCkgPT4ge1xuICAgIHJldHVybiBjcmVhdGVVbmFyeVR5cGVOb2RlKFxuICAgICAgKGNvbnRleHQuQU1QKCkgfHwgY29udGV4dC5TVEFSKCkpLnRleHQsXG4gICAgICB0aGlzLnZpc2l0UHJpbWFyeVR5cGUoY29udGV4dC5wcmltYXJ5VHlwZSgpKSxcbiAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICApO1xuICB9XG5cbiAgdmlzaXRPYmplY3RUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5PYmplY3RUeXBlQ29udGV4dCkgPT4ge1xuICAgIHJldHVybiBjcmVhdGVPYmplY3RUeXBlTm9kZSh0aGlzLnZpc2l0T2JqZWN0UGFpclNlcXVlbmNlVHlwZShjb250ZXh0Lm9iamVjdFBhaXJTZXF1ZW5jZVR5cGUoKSksIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpO1xuICB9XG5cbiAgdmlzaXRPYmplY3RQYWlyU2VxdWVuY2VUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5PYmplY3RQYWlyU2VxdWVuY2VUeXBlQ29udGV4dCkgPT4ge1xuICAgIHJldHVybiAoY29udGV4dCA/IGNvbnRleHQub2JqZWN0UGFpclR5cGUoKSA6IFtdKS5tYXAocGFpciA9PiB7XG4gICAgICByZXR1cm4gY3JlYXRlT2JqZWN0UGFpclR5cGVOb2RlKHRoaXMudmlzaXRUeXBlKHBhaXIudHlwZSgwKSksIHRoaXMudmlzaXRUeXBlKHBhaXIudHlwZSgxKSksIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBwYWlyLnRleHQgOiB1bmRlZmluZWQpXG4gICAgfSk7XG4gIH1cblxuICB2aXNpdEFycmF5VHlwZSA9IChjb250ZXh0OiBQYXJzZXIuQXJyYXlUeXBlQ29udGV4dCk6IEFycmF5VHlwZU5vZGUgPT4ge1xuXG4gICAgaWYgKGNvbnRleHQubm90QXJyYXlUeXBlKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVBcnJheVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0Lm5vdEFycmF5VHlwZSgpKSxcbiAgICAgICAgKGNvbnRleHQudHlwZSgpIHx8IFtdKS5tYXAodHlwZSA9PiB0aGlzLnZpc2l0VHlwZSh0eXBlKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVBcnJheVR5cGVOb2RlKFxuICAgICAgbnVsbCxcbiAgICAgIChjb250ZXh0LnR5cGUoKSB8fCBbXSkubWFwKHR5cGUgPT4gdGhpcy52aXNpdFR5cGUodHlwZSkpLFxuICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgIClcbiAgfVxuXG4gIHZpc2l0UHJvcGVydHlJZGVudGlmaWVyID0gKGNvbnRleHQ6IFBhcnNlci5Qcm9wZXJ0eUlkZW50aWZpZXJDb250ZXh0KTogUHJvcGVydHlJZGVudGlmaWVyTm9kZSA9PiB7XG5cbiAgICAvLyBBc3N1bWUgJ2NvbnRleHQnIGlzIGRlZmluZWQuXG4gICAgbGV0IGlkZW50aWZpZXIgPSBjb250ZXh0LmlkZW50aWZpZXIoKSA/XG4gICAgICB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSkgOlxuICAgICAgdGhpcy52aXNpdE9wdGlvbmFsSWRlbnRpZmllcihjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKTtcbiAgICAvLyBBIHByb3BlcnR5IG11c3QgZXhpc3Qgc2luY2UgYnkgZ3JhbW1hcjpcbiAgICAvLyAob3B0aW9uYWxJZGVudGlmaWVyIHwgaWRlbnRpZmllcikgKCcuJyBvcHRpb25hbElkZW50aWZpZXJPcklkZW50aWZpZXIpK1xuICAgIGxldCBwcm9wZXJ0eSA9IGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyT3JJZGVudGlmaWVyKClcbiAgICAgIC5tYXAodGhpcy52aXNpdE9wdGlvbmFsSWRlbnRpZmllck9ySWRlbnRpZmllcik7XG4gICAgLy8gQWRkIHRoZSBpZGVudGlmaWVyIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5XG4gICAgcHJvcGVydHkudW5zaGlmdChpZGVudGlmaWVyKTtcbiAgICByZXR1cm4gY3JlYXRlUHJvcGVydHlJZGVudGlmaWVyTm9kZShwcm9wZXJ0eSwgY29udGV4dC50ZXh0KVxuICB9XG5cbiAgdmlzaXRPcHRpb25hbElkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLk9wdGlvbmFsSWRlbnRpZmllckNvbnRleHQpOiBPcHRpb25hbElkZW50aWZpZXJOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSwgISFjb250ZXh0LlFVRVNUSU9OKCkpXG4gICAgfVxuICB9XG5cbiAgdmlzaXRPcHRpb25hbElkZW50aWZpZXJPcklkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLk9wdGlvbmFsSWRlbnRpZmllck9ySWRlbnRpZmllckNvbnRleHQpOiBPcHRpb25hbElkZW50aWZpZXJOb2RlIHwgSWRlbnRpZmllck5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdE9wdGlvbmFsSWRlbnRpZmllcihjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKVxuICAgIH1cbiAgfVxuXG4gIC8qIEV4cHJlc3Npb24gdmlzaXRvciAqL1xuXG4gIHZpc2l0RXhwcmVzc2lvbiA9IChjb250ZXh0OiBQYXJzZXIuRXhwcmVzc2lvbkNvbnRleHQpOiBFeHByZXNzaW9uTm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQudW5hcnlFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdFVuYXJ5RXhwcmVzc2lvbihjb250ZXh0LnVuYXJ5RXhwcmVzc2lvbigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmV4cHJlc3Npb24oKS5sZW5ndGggPiAxKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIGNyZWF0ZUJpbmFyeUV4cHJlc3Npb25Ob2RlKFxuICAgICAgICAgIChjb250ZXh0LlBMVVMoKSB8fCBjb250ZXh0Lk1JTlVTKCkgfHwgY29udGV4dC5TVEFSKCkgfHwgY29udGV4dC5GT1JXQVJEX1NMQVNIKCkpLnRleHQsXG4gICAgICAgICAgdGhpcy52aXNpdEV4cHJlc3Npb24oY29udGV4dC5leHByZXNzaW9uKDApKSxcbiAgICAgICAgICB0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oMSkpLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICAgKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmFycmF5RXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIGNyZWF0ZUFycmF5RXhwcmVzc2lvbk5vZGUoXG4gICAgICAgICAgdGhpcy52aXNpdEFycmF5RXhwcmVzc2lvbihjb250ZXh0LmFycmF5RXhwcmVzc2lvbigpKSxcbiAgICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC5hcnJheUV4cHJlc3Npb24oKS50ZXh0IDogdW5kZWZpbmVkXG4gICAgICAgICksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQub2JqZWN0RXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRPYmplY3RFeHByZXNzaW9uKGNvbnRleHQub2JqZWN0RXhwcmVzc2lvbigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmxhbWJkYUV4cHJlc3Npb24oKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUV4cHJlc3Npb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0TGFtYmRhRXhwcmVzc2lvbihjb250ZXh0LmxhbWJkYUV4cHJlc3Npb24oKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5saXRlcmFsRXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRMaXRlcmFsRXhwcmVzc2lvbihjb250ZXh0LmxpdGVyYWxFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQucGFyZW50aGVzaXplZEV4cHJlc3Npb24oKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUV4cHJlc3Npb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0UGFyZW50aGVzaXplZEV4cHJlc3Npb24oY29udGV4dC5wYXJlbnRoZXNpemVkRXhwcmVzc2lvbigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIHZpc2l0VW5hcnlFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5VbmFyeUV4cHJlc3Npb25Db250ZXh0KTogVW5hcnlFeHByZXNzaW9uTm9kZSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbk5vZGUoXG4gICAgICAoY29udGV4dC5QTFVTKCkgfHwgY29udGV4dC5NSU5VUygpKS50ZXh0LFxuICAgICAgdGhpcy52aXNpdEV4cHJlc3Npb24oY29udGV4dC5leHByZXNzaW9uKCkpLFxuICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgIClcbiAgfVxuXG4gIHZpc2l0QXJyYXlFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5BcnJheUV4cHJlc3Npb25Db250ZXh0KTogRXhwcmVzc2lvbk5vZGVbXSA9PiB7XG4gICAgcmV0dXJuIChjb250ZXh0ID8gY29udGV4dC5leHByZXNzaW9uKCkgOiBbXSkubWFwKGV4cHJlc3Npb24gPT4ge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRFeHByZXNzaW9uKGV4cHJlc3Npb24pXG4gICAgfSlcbiAgfVxuXG4gIHZpc2l0T2JqZWN0RXhwcmVzc2lvbiA9IChjb250ZXh0OiBQYXJzZXIuT2JqZWN0RXhwcmVzc2lvbkNvbnRleHQpOiBPYmplY3RFeHByZXNzaW9uTm9kZSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZU9iamVjdEV4cHJlc3Npb25Ob2RlKFxuICAgICAgdGhpcy52aXNpdE9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb24oY29udGV4dC5vYmplY3RQYWlyU2VxdWVuY2VFeHByZXNzaW9uKCkpLFxuICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgIClcbiAgfVxuXG5cbiAgdmlzaXRPYmplY3RQYWlyU2VxdWVuY2VFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5PYmplY3RQYWlyU2VxdWVuY2VFeHByZXNzaW9uQ29udGV4dCk6IE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZVtdID0+IHtcbiAgICByZXR1cm4gKGNvbnRleHQgPyBjb250ZXh0Lm9iamVjdFBhaXJFeHByZXNzaW9uKCkgOiBbXSkubWFwKHBhaXIgPT4ge1xuICAgICAgcmV0dXJuIGNyZWF0ZU9iamVjdFBhaXJFeHByZXNzaW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdExpdGVyYWxFeHByZXNzaW9uKHBhaXIubGl0ZXJhbEV4cHJlc3Npb24oMCkpLFxuICAgICAgICBwYWlyLm9iamVjdEV4cHJlc3Npb24oKSA/XG4gICAgICAgICAgdGhpcy52aXNpdE9iamVjdEV4cHJlc3Npb24ocGFpci5vYmplY3RFeHByZXNzaW9uKCkpIDpcbiAgICAgICAgICB0aGlzLnZpc2l0TGl0ZXJhbEV4cHJlc3Npb24ocGFpci5saXRlcmFsRXhwcmVzc2lvbigxKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgIClcbiAgICB9KTtcbiAgfVxuXG4gIHZpc2l0TGFtYmRhRXhwcmVzc2lvbiA9IChjb250ZXh0OiBQYXJzZXIuTGFtYmRhRXhwcmVzc2lvbkNvbnRleHQpOiBMYW1iZGFFeHByZXNzaW9uTm9kZSA9PiB7XG4gICAgcmV0dXJuIHRoaXMudmlzaXRMYW1iZGFUeXBlKGNvbnRleHQpO1xuICB9XG5cbiAgdmlzaXRQYXJlbnRoZXNpemVkRXhwcmVzc2lvbiA9IChjb250ZXh0OiBQYXJzZXIuUGFyZW50aGVzaXplZEV4cHJlc3Npb25Db250ZXh0KTogUGFyZW50aGVzaXplZEV4cHJlc3Npb25Ob2RlID0+IHtcbiAgICByZXR1cm4gY3JlYXRlUGFyZW50aGVzaXplZEV4cHJlc3Npb25lTm9kZSh0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oKSkpO1xuICB9XG5cbiAgdmlzaXRMaXRlcmFsRXhwcmVzc2lvbiA9IChjb250ZXh0OiBQYXJzZXIuTGl0ZXJhbEV4cHJlc3Npb25Db250ZXh0KTogTGl0ZXJhbEV4cHJlc3Npb25Ob2RlID0+IHtcbiAgICBsZXQgbm9kZSA9IHsgbGl0ZXJhbDoge30gfVxuICAgIGlmIChjb250ZXh0Lk51bWJlckxpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZShcbiAgICAgICAgJ251bWJlcicsXG4gICAgICAgIGNvbnRleHQuTnVtYmVyTGl0ZXJhbCgpLnRleHRcbiAgICAgIClcbiAgICB9XG4gICAgaWYgKGNvbnRleHQuQm9vbGVhbkxpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZSgnYm9vbGVhbicsIGNvbnRleHQuQm9vbGVhbkxpdGVyYWwoKS50ZXh0KVxuICAgIH1cbiAgICBpZiAoY29udGV4dC5DaGFyYWN0ZXJMaXRlcmFsKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVMaXRlcmFsRXhwcmVzc2lvbk5vZGUoJ2NoYXJhY3RlcicsIGNvbnRleHQuQ2hhcmFjdGVyTGl0ZXJhbCgpLnRleHQpXG4gICAgfVxuICAgIGlmIChjb250ZXh0LlN0cmluZ0xpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZSgnc3RyaW5nJywgY29udGV4dC5TdHJpbmdMaXRlcmFsKCkudGV4dClcbiAgICB9XG4gICAgaWYgKGNvbnRleHQuTnVsbExpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZSgnbnVsbCcsIGNvbnRleHQuTnVsbExpdGVyYWwoKS50ZXh0KVxuICAgIH1cbiAgfVxuXG4gIC8qIERlc2NyaXB0aW9uIHZpc2l0b3IgKi9cblxuICB2aXNpdERlc2NyaXB0aW9uID0gKGNvbnRleHQ6IFBhcnNlci5EZXNjcmlwdGlvbkNvbnRleHQpOiBEZXNjcmlwdGlvbk5vZGUgPT4ge1xuICAgIHJldHVybiBjcmVhdGVEZXNjcmlwdGlvbk5vZGUoXG4gICAgICBjb250ZXh0LnRleHQsXG4gICAgICB0aGlzLnZpc2l0RGVzY3JpcHRpb25MaW5lKGNvbnRleHQuZGVzY3JpcHRpb25MaW5lKCkpXG4gICAgKVxuICB9XG5cbiAgdmlzaXREZXNjcmlwdGlvbkxpbmUgPSAoY29udGV4dDogUGFyc2VyLkRlc2NyaXB0aW9uTGluZUNvbnRleHQpOiBJbmxpbmVUYWdOb2RlW10gPT4ge1xuICAgIHJldHVybiB0aGlzLnZpc2l0RGVzY3JpcHRpb25MaW5lRWxlbWVudChjb250ZXh0LmRlc2NyaXB0aW9uTGluZUVsZW1lbnQoKSk7XG4gIH1cblxuICB2aXNpdERlc2NyaXB0aW9uTGluZUVsZW1lbnQgPSAoY29udGV4dDogUGFyc2VyLkRlc2NyaXB0aW9uTGluZUVsZW1lbnRDb250ZXh0W10pOiBJbmxpbmVUYWdOb2RlW10gPT4ge1xuICAgIHJldHVybiAoY29udGV4dCB8fCBbXSkubWFwKGVsZW1lbnQgPT4ge1xuICAgICAgcmV0dXJuIGVsZW1lbnQuaW5saW5lVGFnKCkgPyB0aGlzLnZpc2l0SW5saW5lVGFnKGVsZW1lbnQuaW5saW5lVGFnKCkpIDogdW5kZWZpbmVkXG4gICAgfSkuZmlsdGVyKGVsZW1lbnQgPT4gZWxlbWVudCAhPT0gdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHZpc2l0SW5saW5lVGFnID0gKGNvbnRleHQ6IFBhcnNlci5JbmxpbmVUYWdDb250ZXh0KTogSW5saW5lVGFnTm9kZSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZUlubGluZVRhZ05vZGUoXG4gICAgICB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlubGluZVRhZ05hbWUoKS5pZGVudGlmaWVyKCkpLFxuICAgICAgdGhpcy52aXNpdElubGluZVRhZ0JvZHkoY29udGV4dC5pbmxpbmVUYWdCb2R5KCkpLFxuICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICk7XG4gIH1cblxuICB2aXNpdElubGluZVRhZ0JvZHkgPSAoY29udGV4dDogUGFyc2VyLklubGluZVRhZ0JvZHlDb250ZXh0KTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gY29udGV4dC5icmFjZUJvZHkoKS5tYXAoYm9keSA9PiBib2R5LnRleHQpLmpvaW4oJycpO1xuICB9XG59Il19