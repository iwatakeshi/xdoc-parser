"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Parser = require("./XDocSyntaxParser");
require("./XDocSyntaxParserVisitor");
const XDocASTNode_1 = require("./XDocASTNode");
/**
 * XDocAST is a class that converts a Antlr parse tree
 * into a Javascript tree object.
 *
 * # API
 *
 * ```
 * @class XDocAST
 * ```
 */
class XDocASTVisitor {
    constructor(options) {
        this.options = {
            showNodeText: false
        };
        /**
         * Converts the Antlr parse tree into a JavaScript tree object.
         *
         * # API
         *
         * ```
         * @method visit
         * @param context: Parser.DocumentationConext
         * @return: {
         *  name?: string,
         *  id?: {},
         *  value?: {},
         *  type?: {},
         *  description?: {}
         * }[]
         * ```
         */
        this.visit = (context) => {
            return this.visitDocumentation(context);
        };
        /* Documentation visitor */
        this.visitDocumentation = (context) => {
            if (context.body()) {
                return XDocASTNode_1.createDocumentationNode(this.visitBody(context.body()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitBody = (context) => {
            if (context.annotations()) {
                return XDocASTNode_1.createBodyNode(this.visitAnnotations(context.annotations(), this.options), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitAnnotations = (context, options) => {
            if (context.tag()) {
                return (context.tag() || []).map(this.visitTag);
            }
        };
        this.visitTag = (context) => {
            let name, identifier, type, expression, description;
            if (context.tagName()) {
                name = this.visitTagName(context.tagName());
            }
            if (context.tagIdentifier()) {
                identifier = this.visitTagIdentifier(context.tagIdentifier());
            }
            if (context.type()) {
                type = this.visitType(context.type());
            }
            if (context.expression()) {
                expression = this.visitExpression(context.expression());
            }
            if (context.description()) {
                description = this.visitDescription(context.description());
            }
            return XDocASTNode_1.createTagNode(name, identifier, type, expression, description, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTagName = (context) => {
            if (context.identifier()) {
                return XDocASTNode_1.createTagNameNode(this.visitIdentifier(context.identifier()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitTagIdentifier = (context) => {
            let identifier, property;
            if (context.identifier()) {
                identifier = this.visitIdentifier(context.identifier());
            }
            if (context.optionalTagIdentifier()) {
                identifier = this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            }
            if (context.propertyTagIdentifier()) {
                property = this.visitPropertyTagIdentifier(context.propertyTagIdentifier());
            }
            return XDocASTNode_1.createTagIdentifierNode(identifier, property, this.options.showNodeText ? context.text : undefined);
        };
        this.visitPropertyTagIdentifier = (context) => {
            // Assume 'context' is defined.
            let identifier = context.identifier() ?
                this.visitIdentifier(context.identifier()) :
                this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            // A property must exist since by grammar:
            // (optionalTagIdentifier | identifier) ('.' optionalTagOrIdentifier)+
            let property = context.optionalTagOrIdentifier()
                .map(this.visitOptionalTagOrIdentifier);
            // Add the identifier to the beginning of the array
            property.unshift(identifier);
            return XDocASTNode_1.createPropertyTagIdentifierNode(property, context.text);
        };
        this.visitOptionalTagIdentifer = (context) => {
            if (context.optionalIdentifier()) {
                return XDocASTNode_1.createOptionalTagIdentifierNode(this.visitOptionalIdentifier(context.optionalIdentifier()));
            }
        };
        this.visitOptionalTagOrIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.optionalTagIdentifier()) {
                return this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            }
        };
        this.visitIdentifier = (context, optional = false) => {
            if (context.ID()) {
                return XDocASTNode_1.createIdentifierNode(context.ID().text, optional, []);
            }
        };
        /* Type visitor */
        this.visitType = (context, optional = false) => {
            // Intersections
            if (context.PIPE()) {
                return XDocASTNode_1.createTypeNode(XDocASTNode_1.createIntersectTypeNode(this.visitType(context instanceof Parser.TypeContext ? context.type(0) : context.notArrayType(0)), this.visitType(context instanceof Parser.TypeContext ? context.type(1) : context.notArrayType(1)), this.options.showNodeText ? context.text : undefined), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.AMP()) { // Unions
                return XDocASTNode_1.createTypeNode(XDocASTNode_1.createUnionTypeNode(this.visitType(context instanceof Parser.TypeContext ? context.type(0) : context.notArrayType(0)), this.visitType(context instanceof Parser.TypeContext ? context.type(1) : context.notArrayType(1)), this.options.showNodeText ? context.text : undefined), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.lambdaType()) { // Lambda functions i.e. (id) => type
                return XDocASTNode_1.createTypeNode(this.visitLambdaType(context.lambdaType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.tupleType()) { // id<type, type>
                return XDocASTNode_1.createTypeNode(this.visitTuple(context.tupleType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.primaryType()) { // Primary
                return XDocASTNode_1.createTypeNode(this.visitPrimaryType(context.primaryType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.parenthesizedType()) { // (expression)
                return XDocASTNode_1.createTypeNode(this.visitParenthesizedType(context.parenthesizedType(), optional), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.unaryType()) {
                return XDocASTNode_1.createTypeNode(this.visitUnaryType(context.unaryType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.objectType()) { // { ... }
                return XDocASTNode_1.createTypeNode(this.visitObjectType(context.objectType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context instanceof Parser.TypeContext && context.arrayType()) { // [ ... ]
                return XDocASTNode_1.createTypeNode(this.visitArrayType(context.arrayType()), optional, this.options.showNodeText ? context.text : undefined);
            }
        };
        /* Lambda visitor */
        this.visitLambdaType = (context) => {
            if (context.formalParameterSequence()) {
                return XDocASTNode_1.createLambdaTypeNode(this.visitLambdaFormalParameterSequence(context.formalParameterSequence()), this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
            }
            else if (context.parameter()) {
                return XDocASTNode_1.createLambdaTypeNode(this.visitLambdaFormalParameterSequence(context.parameter()), this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
            }
            return XDocASTNode_1.createLambdaTypeNode(null, this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitLambdaFormalParameterSequence = (context) => {
            if (context instanceof Parser.ParameterContext) {
                return XDocASTNode_1.createFormalParemeterSequenceNode([this.visitParameter(context)]);
            }
            return XDocASTNode_1.createFormalParemeterSequenceNode(this.visitParameters(context.parameter()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitParameters = (contexts) => {
            return contexts.map(context => {
                return this.visitParameter(context);
            });
        };
        this.visitParameter = (context) => {
            let identifier = this.visitIdentifier(context.identifier());
            let type;
            if (context.type()) {
                type = this.visitType(context.type());
            }
            return XDocASTNode_1.createParameterNode(identifier, type, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTuple = (context) => {
            let identifier;
            let types;
            if (context.identifier()) {
                identifier = this.visitIdentifier(context.identifier());
            }
            if (context.tupleTypeSequence()) {
                types = this.visitTupleSequenceType(context.tupleTypeSequence());
            }
            return XDocASTNode_1.createTupleTypeNode(identifier, types, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTupleSequenceType = (context) => {
            return (context.type() || []).map(type => this.visitType(type));
        };
        this.visitPrimaryType = (context) => {
            let primary;
            if (context.optionalIdentifier()) {
                primary = this.visitOptionalIdentifier(context.optionalIdentifier());
            }
            else if (context.identifierOrKeyword()) {
                primary = this.visitIdentifierOrKeyword(context.identifierOrKeyword());
            }
            else if (context.propertyIdentifier()) {
                primary = this.visitPropertyIdentifier(context.propertyIdentifier());
            }
            return XDocASTNode_1.createPrimaryTypeNode(primary, this.options.showNodeText ? context.text : undefined);
        };
        this.visitIdentifierOrKeyword = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.keyword()) {
                return this.visitKeyword(context.keyword());
            }
        };
        this.visitKeyword = (context) => {
            if (context.NullLiteral()) {
                return XDocASTNode_1.createKeywordNode(context.NullLiteral().text);
            }
        };
        this.visitParenthesizedType = (context, optional = false) => {
            if (context.type()) {
                return XDocASTNode_1.createParenthesizedTypeNode(this.visitType(context.type()), optional, this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitUnaryType = (context) => {
            return XDocASTNode_1.createUnaryTypeNode((context.AMP() || context.STAR()).text, this.visitPrimaryType(context.primaryType()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectType = (context) => {
            return XDocASTNode_1.createObjectTypeNode(this.visitObjectPairSequenceType(context.objectPairSequenceType()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectPairSequenceType = (context) => {
            return (context ? context.objectPairType() : []).map(pair => {
                return XDocASTNode_1.createObjectPairTypeNode(this.visitType(pair.type(0)), this.visitType(pair.type(1)), this.options.showNodeText ? pair.text : undefined);
            });
        };
        this.visitArrayType = (context) => {
            if (context.notArrayType()) {
                return XDocASTNode_1.createArrayTypeNode(this.visitType(context.notArrayType()), (context.type() || []).map(type => this.visitType(type)), this.options.showNodeText ? context.text : undefined);
            }
            return XDocASTNode_1.createArrayTypeNode(null, (context.type() || []).map(type => this.visitType(type)), this.options.showNodeText ? context.text : undefined);
        };
        this.visitPropertyIdentifier = (context) => {
            // Assume 'context' is defined.
            let identifier = context.identifier() ?
                this.visitIdentifier(context.identifier()) :
                this.visitOptionalIdentifier(context.optionalIdentifier());
            // A property must exist since by grammar:
            // (optionalIdentifier | identifier) ('.' optionalIdentifierOrIdentifier)+
            let property = context.optionalIdentifierOrIdentifier()
                .map(this.visitOptionalIdentifierOrIdentifier);
            // Add the identifier to the beginning of the array
            property.unshift(identifier);
            return XDocASTNode_1.createPropertyIdentifierNode(property, context.text);
        };
        this.visitOptionalIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier(), !!context.QUESTION());
            }
        };
        this.visitOptionalIdentifierOrIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.optionalIdentifier()) {
                return this.visitOptionalIdentifier(context.optionalIdentifier());
            }
        };
        /* Expression visitor */
        this.visitExpression = (context) => {
            if (context.unaryExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitUnaryExpression(context.unaryExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.expression().length > 1) {
                return XDocASTNode_1.createExpressionNode(XDocASTNode_1.createBinaryExpressionNode((context.PLUS() || context.MINUS() || context.STAR() || context.FORWARD_SLASH()).text, this.visitExpression(context.expression(0)), this.visitExpression(context.expression(1)), this.options.showNodeText ? context.text : undefined), this.options.showNodeText ? context.text : undefined);
            }
            if (context.arrayExpression()) {
                return XDocASTNode_1.createExpressionNode(XDocASTNode_1.createArrayExpressionNode(this.visitArrayExpression(context.arrayExpression()), this.options.showNodeText ? context.arrayExpression().text : undefined), this.options.showNodeText ? context.text : undefined);
            }
            if (context.objectExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitObjectExpression(context.objectExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.lambdaExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitLambdaExpression(context.lambdaExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.literalExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitLiteralExpression(context.literalExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.parenthesizedExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitParenthesizedExpression(context.parenthesizedExpression()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitUnaryExpression = (context) => {
            return XDocASTNode_1.createUnaryExpressionNode((context.PLUS() || context.MINUS()).text, this.visitExpression(context.expression()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitArrayExpression = (context) => {
            return (context ? context.expression() : []).map(expression => {
                return this.visitExpression(expression);
            });
        };
        this.visitObjectExpression = (context) => {
            return XDocASTNode_1.createObjectExpressionNode(this.visitObjectPairSequenceExpression(context.objectPairSequenceExpression()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectPairSequenceExpression = (context) => {
            return (context ? context.objectPairExpression() : []).map(pair => {
                return XDocASTNode_1.createObjectPairExpressionNode(this.visitLiteralExpression(pair.literalExpression(0)), pair.objectExpression() ?
                    this.visitObjectExpression(pair.objectExpression()) :
                    this.visitLiteralExpression(pair.literalExpression(1)), this.options.showNodeText ? context.text : undefined);
            });
        };
        this.visitLambdaExpression = (context) => {
            return this.visitLambdaType(context);
        };
        this.visitParenthesizedExpression = (context) => {
            return XDocASTNode_1.createParenthesizedExpressioneNode(this.visitExpression(context.expression()));
        };
        this.visitLiteralExpression = (context) => {
            let node = { literal: {} };
            if (context.NumberLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('number', context.NumberLiteral().text);
            }
            if (context.BooleanLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('boolean', context.BooleanLiteral().text);
            }
            if (context.CharacterLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('character', context.CharacterLiteral().text);
            }
            if (context.StringLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('string', context.StringLiteral().text);
            }
            if (context.NullLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('null', context.NullLiteral().text);
            }
        };
        /* Description visitor */
        this.visitDescription = (context) => {
            return XDocASTNode_1.createDescriptionNode(context.text, this.visitDescriptionLine(context.descriptionLine()));
        };
        this.visitDescriptionLine = (context) => {
            return this.visitDescriptionLineElement(context.descriptionLineElement());
        };
        this.visitDescriptionLineElement = (context) => {
            return (context || []).map(element => {
                return element.inlineTag() ? this.visitInlineTag(element.inlineTag()) : undefined;
            }).filter(element => element !== undefined);
        };
        this.visitInlineTag = (context) => {
            return XDocASTNode_1.createInlineTagNode(this.visitIdentifier(context.inlineTagName().identifier()), this.visitInlineTagBody(context.inlineTagBody()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitInlineTagBody = (context) => {
            return context.braceBody().map(body => body.text).join('');
        };
        Object.assign(this.options, options);
    }
}
exports.default = XDocASTVisitor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVFZpc2l0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVFZpc2l0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2Q0FBNkM7QUFDN0MscUNBQW1DO0FBQ25DLCtDQTZEdUI7QUFNdkI7Ozs7Ozs7OztHQVNHO0FBQ0g7SUFLRSxZQUFZLE9BQStCO1FBSm5DLFlBQU8sR0FBMEI7WUFDdkMsWUFBWSxFQUFFLEtBQUs7U0FDcEIsQ0FBQTtRQUtEOzs7Ozs7Ozs7Ozs7Ozs7O1dBZ0JHO1FBQ0gsVUFBSyxHQUFHLENBQUMsT0FBb0MsRUFBcUIsRUFBRTtZQUNsRSxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMxQyxDQUFDLENBQUE7UUFDRCwyQkFBMkI7UUFFM0IsdUJBQWtCLEdBQUcsQ0FDbkIsT0FBb0MsRUFDakIsRUFBRTtZQUNyQixJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDbEIsT0FBTyxxQ0FBdUIsQ0FDNUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsRUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FDckQsQ0FBQTthQUNGO1FBQ0gsQ0FBQyxDQUFBO1FBRUQsY0FBUyxHQUFHLENBQ1YsT0FBMkIsRUFDakIsRUFBRTtZQUNaLElBQUksT0FBTyxDQUFDLFdBQVcsRUFBRSxFQUFFO2dCQUN6QixPQUFPLDRCQUFjLENBQ25CLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUMxRCxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUNyRCxD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InNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCAqIGFzIFBhcnNlciBmcm9tICcuL1hEb2NTeW50YXhQYXJzZXInO1xuaW1wb3J0ICcuL1hEb2NTeW50YXhQYXJzZXJWaXNpdG9yJztcbmltcG9ydCB7XG4gIEFubm90YXRpb25zTm9kZSxcbiAgQXJyYXlUeXBlTm9kZSxcbiAgQm9keU5vZGUsXG4gIGNyZWF0ZUFycmF5RXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZUFycmF5VHlwZU5vZGUsXG4gIGNyZWF0ZUJpbmFyeUV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVCb2R5Tm9kZSxcbiAgY3JlYXRlRGVzY3JpcHRpb25Ob2RlLFxuICBjcmVhdGVEb2N1bWVudGF0aW9uTm9kZSxcbiAgY3JlYXRlRXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZUZvcm1hbFBhcmVtZXRlclNlcXVlbmNlTm9kZSxcbiAgY3JlYXRlSWRlbnRpZmllck5vZGUsXG4gIGNyZWF0ZUlubGluZVRhZ05vZGUsXG4gIGNyZWF0ZUludGVyc2VjdFR5cGVOb2RlLFxuICBjcmVhdGVLZXl3b3JkTm9kZSxcbiAgY3JlYXRlTGFtYmRhVHlwZU5vZGUsXG4gIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlT2JqZWN0RXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZU9iamVjdFBhaXJFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlT2JqZWN0UGFpclR5cGVOb2RlLFxuICBjcmVhdGVPYmplY3RUeXBlTm9kZSxcbiAgY3JlYXRlUGFyYW1ldGVyTm9kZSxcbiAgY3JlYXRlUGFyZW50aGVzaXplZFR5cGVOb2RlLFxuICBjcmVhdGVQcmltYXJ5VHlwZU5vZGUsXG4gIGNyZWF0ZVByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUsXG4gIGNyZWF0ZVByb3BlcnR5SWRlbnRpZmllck5vZGUsXG4gIGNyZWF0ZVRhZ0lkZW50aWZpZXJOb2RlLCBjcmVhdGVPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlLFxuICBjcmVhdGVUYWdOYW1lTm9kZSxcbiAgY3JlYXRlVGFnTm9kZSxcbiAgY3JlYXRlVHVwbGVUeXBlTm9kZSxcbiAgY3JlYXRlVHlwZU5vZGUsXG4gIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZVVuYXJ5VHlwZU5vZGUsXG4gIGNyZWF0ZVVuaW9uVHlwZU5vZGUsXG4gIERlc2NyaXB0aW9uTm9kZSxcbiAgRG9jdW1lbnRhdGlvbk5vZGUsXG4gIEV4cHJlc3Npb25Ob2RlLFxuICBGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZU5vZGUsXG4gIElkZW50aWZpZXJOb2RlLFxuICBJbmxpbmVUYWdOb2RlLFxuICBLZXl3b3JkTm9kZSxcbiAgTGFtYmRhRXhwcmVzc2lvbk5vZGUsXG4gIExhbWJkYVR5cGVOb2RlLFxuICBMaXRlcmFsRXhwcmVzc2lvbk5vZGUsXG4gIE9iamVjdEV4cHJlc3Npb25Ob2RlLFxuICBPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGUsXG4gIE9wdGlvbmFsSWRlbnRpZmllck5vZGUsXG4gIE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUsXG4gIFBhcmFtZXRlck5vZGUsXG4gIFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZSxcbiAgUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZSxcbiAgVGFnSWRlbnRpZmllck5vZGUsXG4gIFRhZ05hbWVOb2RlLFxuICBUYWdOb2RlLFxuICBUdXBsZVR5cGVOb2RlLFxuICBUeXBlTm9kZSxcbiAgVW5hcnlFeHByZXNzaW9uTm9kZSxcbiAgUHJvcGVydHlJZGVudGlmaWVyTm9kZSxcbiAgUGFyZW50aGVzaXplZFR5cGVOb2RlLFxuICBjcmVhdGVQYXJlbnRoZXNpemVkRXhwcmVzc2lvbmVOb2RlLFxufSBmcm9tICcuL1hEb2NBU1ROb2RlJztcblxuXG5leHBvcnQgaW50ZXJmYWNlIFhEb2NBU1RWaXNpdG9yT3B0aW9ucyB7XG4gIHNob3dOb2RlVGV4dDogYm9vbGVhblxufVxuLyoqXG4gKiBYRG9jQVNUIGlzIGEgY2xhc3MgdGhhdCBjb252ZXJ0cyBhIEFudGxyIHBhcnNlIHRyZWVcbiAqIGludG8gYSBKYXZhc2NyaXB0IHRyZWUgb2JqZWN0LlxuICogXG4gKiAjIEFQSVxuICogXG4gKiBgYGBcbiAqIEBjbGFzcyBYRG9jQVNUXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWERvY0FTVFZpc2l0b3Ige1xuICBwcml2YXRlIG9wdGlvbnM6IFhEb2NBU1RWaXNpdG9yT3B0aW9ucyA9IHtcbiAgICBzaG93Tm9kZVRleHQ6IGZhbHNlXG4gIH1cblxuICBjb25zdHJ1Y3RvcihvcHRpb25zPzogWERvY0FTVFZpc2l0b3JPcHRpb25zKSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuICB9XG4gIC8qKlxuICAgKiBDb252ZXJ0cyB0aGUgQW50bHIgcGFyc2UgdHJlZSBpbnRvIGEgSmF2YVNjcmlwdCB0cmVlIG9iamVjdC5cbiAgICogXG4gICAqICMgQVBJXG4gICAqIFxuICAgKiBgYGBcbiAgICogQG1ldGhvZCB2aXNpdFxuICAgKiBAcGFyYW0gY29udGV4dDogUGFyc2VyLkRvY3VtZW50YXRpb25Db25leHRcbiAgICogQHJldHVybjogeyBcbiAgICogIG5hbWU/OiBzdHJpbmcsIFxuICAgKiAgaWQ/OiB7fSwgXG4gICAqICB2YWx1ZT86IHt9LCBcbiAgICogIHR5cGU/OiB7fSwgXG4gICAqICBkZXNjcmlwdGlvbj86IHt9IFxuICAgKiB9W11cbiAgICogYGBgXG4gICAqL1xuICB2aXNpdCA9IChjb250ZXh0OiBQYXJzZXIuRG9jdW1lbnRhdGlvbkNvbnRleHQpOiBEb2N1bWVudGF0aW9uTm9kZSA9PiB7XG4gICAgcmV0dXJuIHRoaXMudmlzaXREb2N1bWVudGF0aW9uKGNvbnRleHQpO1xuICB9XG4gIC8qIERvY3VtZW50YXRpb24gdmlzaXRvciAqL1xuXG4gIHZpc2l0RG9jdW1lbnRhdGlvbiA9IChcbiAgICBjb250ZXh0OiBQYXJzZXIuRG9jdW1lbnRhdGlvbkNvbnRleHRcbiAgKTogRG9jdW1lbnRhdGlvbk5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LmJvZHkoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZURvY3VtZW50YXRpb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0Qm9keShjb250ZXh0LmJvZHkoKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICB2aXNpdEJvZHkgPSAoXG4gICAgY29udGV4dDogUGFyc2VyLkJvZHlDb250ZXh0XG4gICk6IEJvZHlOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dC5hbm5vdGF0aW9ucygpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlQm9keU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRBbm5vdGF0aW9ucyhjb250ZXh0LmFubm90YXRpb25zKCksIHRoaXMub3B0aW9ucyksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRBbm5vdGF0aW9ucyA9IChcbiAgICBjb250ZXh0OiBQYXJzZXIuQW5ub3RhdGlvbnNDb250ZXh0LFxuICAgIG9wdGlvbnM6IFhEb2NBU1RWaXNpdG9yT3B0aW9uc1xuICApOiBBbm5vdGF0aW9uc05vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LnRhZygpKSB7XG4gICAgICByZXR1cm4gKGNvbnRleHQudGFnKCkgfHwgW10pLm1hcCh0aGlzLnZpc2l0VGFnKVxuICAgIH1cbiAgfVxuXG5cbiAgdmlzaXRUYWcgPSAoY29udGV4dDogUGFyc2VyLlRhZ0NvbnRleHQpOiBUYWdOb2RlID0+IHtcbiAgICBsZXQgbmFtZTogVGFnTmFtZU5vZGUsXG4gICAgICBpZGVudGlmaWVyOiBUYWdJZGVudGlmaWVyTm9kZSxcbiAgICAgIHR5cGU6IFR5cGVOb2RlLFxuICAgICAgZXhwcmVzc2lvbjogRXhwcmVzc2lvbk5vZGUsXG4gICAgICBkZXNjcmlwdGlvbjogRGVzY3JpcHRpb25Ob2RlO1xuXG4gICAgaWYgKGNvbnRleHQudGFnTmFtZSgpKSB7XG4gICAgICBuYW1lID0gdGhpcy52aXNpdFRhZ05hbWUoY29udGV4dC50YWdOYW1lKCkpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnRhZ0lkZW50aWZpZXIoKSkge1xuICAgICAgaWRlbnRpZmllciA9IHRoaXMudmlzaXRUYWdJZGVudGlmaWVyKGNvbnRleHQudGFnSWRlbnRpZmllcigpKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC50eXBlKCkpIHtcbiAgICAgIHR5cGUgPSB0aGlzLnZpc2l0VHlwZShjb250ZXh0LnR5cGUoKSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuZXhwcmVzc2lvbigpKSB7XG4gICAgICBleHByZXNzaW9uID0gdGhpcy52aXNpdEV4cHJlc3Npb24oY29udGV4dC5leHByZXNzaW9uKCkpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuZGVzY3JpcHRpb24oKSkge1xuICAgICAgZGVzY3JpcHRpb24gPSB0aGlzLnZpc2l0RGVzY3JpcHRpb24oY29udGV4dC5kZXNjcmlwdGlvbigpKVxuICAgIH1cblxuICAgIHJldHVybiBjcmVhdGVUYWdOb2RlKG5hbWUsIGlkZW50aWZpZXIsIHR5cGUsIGV4cHJlc3Npb24sIGRlc2NyaXB0aW9uLCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKVxuICB9XG5cbiAgdmlzaXRUYWdOYW1lID0gKGNvbnRleHQ6IFBhcnNlci5UYWdOYW1lQ29udGV4dCk6IFRhZ05hbWVOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVUYWdOYW1lTm9kZSh0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSksIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0VGFnSWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuVGFnSWRlbnRpZmllckNvbnRleHQpOiBUYWdJZGVudGlmaWVyTm9kZSA9PiB7XG4gICAgbGV0IGlkZW50aWZpZXI6IElkZW50aWZpZXJOb2RlIHwgT3B0aW9uYWxJZGVudGlmaWVyTm9kZSxcbiAgICAgIHByb3BlcnR5OiBQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlO1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgaWRlbnRpZmllciA9IHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5vcHRpb25hbFRhZ0lkZW50aWZpZXIoKSkge1xuICAgICAgaWRlbnRpZmllciA9IHRoaXMudmlzaXRPcHRpb25hbFRhZ0lkZW50aWZlcihjb250ZXh0Lm9wdGlvbmFsVGFnSWRlbnRpZmllcigpKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnByb3BlcnR5VGFnSWRlbnRpZmllcigpKSB7XG4gICAgICBwcm9wZXJ0eSA9IHRoaXMudmlzaXRQcm9wZXJ0eVRhZ0lkZW50aWZpZXIoY29udGV4dC5wcm9wZXJ0eVRhZ0lkZW50aWZpZXIoKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZVRhZ0lkZW50aWZpZXJOb2RlKGlkZW50aWZpZXIsIHByb3BlcnR5LCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHZpc2l0UHJvcGVydHlUYWdJZGVudGlmaWVyID0gKGNvbnRleHQ6IFBhcnNlci5Qcm9wZXJ0eVRhZ0lkZW50aWZpZXJDb250ZXh0KTogUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZSA9PiB7XG5cbiAgICAvLyBBc3N1bWUgJ2NvbnRleHQnIGlzIGRlZmluZWQuXG4gICAgbGV0IGlkZW50aWZpZXIgPSBjb250ZXh0LmlkZW50aWZpZXIoKSA/XG4gICAgICB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSkgOlxuICAgICAgdGhpcy52aXNpdE9wdGlvbmFsVGFnSWRlbnRpZmVyKGNvbnRleHQub3B0aW9uYWxUYWdJZGVudGlmaWVyKCkpO1xuICAgIC8vIEEgcHJvcGVydHkgbXVzdCBleGlzdCBzaW5jZSBieSBncmFtbWFyOlxuICAgIC8vIChvcHRpb25hbFRhZ0lkZW50aWZpZXIgfCBpZGVudGlmaWVyKSAoJy4nIG9wdGlvbmFsVGFnT3JJZGVudGlmaWVyKStcbiAgICBsZXQgcHJvcGVydHkgPSBjb250ZXh0Lm9wdGlvbmFsVGFnT3JJZGVudGlmaWVyKClcbiAgICAgIC5tYXAodGhpcy52aXNpdE9wdGlvbmFsVGFnT3JJZGVudGlmaWVyKTtcbiAgICAvLyBBZGQgdGhlIGlkZW50aWZpZXIgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgYXJyYXlcbiAgICBwcm9wZXJ0eS51bnNoaWZ0KGlkZW50aWZpZXIpO1xuICAgIHJldHVybiBjcmVhdGVQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlKHByb3BlcnR5LCBjb250ZXh0LnRleHQpO1xuICB9XG5cbiAgdmlzaXRPcHRpb25hbFRhZ0lkZW50aWZlciA9IChjb250ZXh0OiBQYXJzZXIuT3B0aW9uYWxUYWdJZGVudGlmaWVyQ29udGV4dCk6IE9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSh0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpKVxuICAgIH1cbiAgfVxuXG4gIHZpc2l0T3B0aW9uYWxUYWdPcklkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLk9wdGlvbmFsVGFnT3JJZGVudGlmaWVyQ29udGV4dCk6IChJZGVudGlmaWVyTm9kZSB8IE9wdGlvbmFsSWRlbnRpZmllck5vZGUpID0+IHtcbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSlcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5vcHRpb25hbFRhZ0lkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRPcHRpb25hbFRhZ0lkZW50aWZlcihjb250ZXh0Lm9wdGlvbmFsVGFnSWRlbnRpZmllcigpKTtcbiAgICB9XG4gIH1cblxuXG4gIHZpc2l0SWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuSWRlbnRpZmllckNvbnRleHQsIG9wdGlvbmFsID0gZmFsc2UpOiBJZGVudGlmaWVyTm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQuSUQoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUlkZW50aWZpZXJOb2RlKGNvbnRleHQuSUQoKS50ZXh0LCBvcHRpb25hbCwgW10pO1xuICAgIH1cbiAgfVxuXG4gIC8qIFR5cGUgdmlzaXRvciAqL1xuXG4gIHZpc2l0VHlwZSA9IChjb250ZXh0OiBQYXJzZXIuVHlwZUNvbnRleHQgfCBQYXJzZXIuTm90QXJyYXlUeXBlQ29udGV4dCwgb3B0aW9uYWwgPSBmYWxzZSk6IFR5cGVOb2RlID0+IHtcblxuICAgIC8vIEludGVyc2VjdGlvbnNcbiAgICBpZiAoY29udGV4dC5QSVBFKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgY3JlYXRlSW50ZXJzZWN0VHlwZU5vZGUoXG4gICAgICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dCBpbnN0YW5jZW9mIFBhcnNlci5UeXBlQ29udGV4dCA/IGNvbnRleHQudHlwZSgwKTogY29udGV4dC5ub3RBcnJheVR5cGUoMCkpLFxuICAgICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQgaW5zdGFuY2VvZiBQYXJzZXIuVHlwZUNvbnRleHQgPyBjb250ZXh0LnR5cGUoMSk6IGNvbnRleHQubm90QXJyYXlUeXBlKDEpKSxcbiAgICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICAgICksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LkFNUCgpKSB7IC8vIFVuaW9uc1xuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICBjcmVhdGVVbmlvblR5cGVOb2RlKFxuICAgICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQgaW5zdGFuY2VvZiBQYXJzZXIuVHlwZUNvbnRleHQgPyBjb250ZXh0LnR5cGUoMCk6IGNvbnRleHQubm90QXJyYXlUeXBlKDApKSxcbiAgICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0IGluc3RhbmNlb2YgUGFyc2VyLlR5cGVDb250ZXh0ID8gY29udGV4dC50eXBlKDEpOiBjb250ZXh0Lm5vdEFycmF5VHlwZSgxKSksXG4gICAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgICApLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5sYW1iZGFUeXBlKCkpIHsgLy8gTGFtYmRhIGZ1bmN0aW9ucyBpLmUuIChpZCkgPT4gdHlwZVxuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0TGFtYmRhVHlwZShjb250ZXh0LmxhbWJkYVR5cGUoKSksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnR1cGxlVHlwZSgpKSB7IC8vIGlkPHR5cGUsIHR5cGU+XG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRUdXBsZShjb250ZXh0LnR1cGxlVHlwZSgpKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQucHJpbWFyeVR5cGUoKSkgeyAvLyBQcmltYXJ5XG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRQcmltYXJ5VHlwZShjb250ZXh0LnByaW1hcnlUeXBlKCkpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5wYXJlbnRoZXNpemVkVHlwZSgpKSB7IC8vIChleHByZXNzaW9uKVxuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0UGFyZW50aGVzaXplZFR5cGUoY29udGV4dC5wYXJlbnRoZXNpemVkVHlwZSgpLCBvcHRpb25hbCksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQudW5hcnlUeXBlKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdFVuYXJ5VHlwZShjb250ZXh0LnVuYXJ5VHlwZSgpKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQub2JqZWN0VHlwZSgpKSB7IC8vIHsgLi4uIH1cbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdE9iamVjdFR5cGUoY29udGV4dC5vYmplY3RUeXBlKCkpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCBpbnN0YW5jZW9mIFBhcnNlci5UeXBlQ29udGV4dCAmJiBjb250ZXh0LmFycmF5VHlwZSgpKSB7IC8vIFsgLi4uIF1cbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdEFycmF5VHlwZShjb250ZXh0LmFycmF5VHlwZSgpKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyogTGFtYmRhIHZpc2l0b3IgKi9cblxuICB2aXNpdExhbWJkYVR5cGUgPSAoY29udGV4dDogUGFyc2VyLkxhbWJkYVR5cGVDb250ZXh0KTogTGFtYmRhVHlwZU5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LmZvcm1hbFBhcmFtZXRlclNlcXVlbmNlKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVMYW1iZGFUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdExhbWJkYUZvcm1hbFBhcmFtZXRlclNlcXVlbmNlKGNvbnRleHQuZm9ybWFsUGFyYW1ldGVyU2VxdWVuY2UoKSksXG4gICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQudHlwZSgpLCAhIWNvbnRleHQuUVVFU1RJT04oKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG5cbiAgICB9IGVsc2UgaWYgKGNvbnRleHQucGFyYW1ldGVyKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVMYW1iZGFUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdExhbWJkYUZvcm1hbFBhcmFtZXRlclNlcXVlbmNlKGNvbnRleHQucGFyYW1ldGVyKCkpLFxuICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0LnR5cGUoKSwgISFjb250ZXh0LlFVRVNUSU9OKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBjcmVhdGVMYW1iZGFUeXBlTm9kZShcbiAgICAgIG51bGwsXG4gICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0LnR5cGUoKSwgISFjb250ZXh0LlFVRVNUSU9OKCkpLFxuICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgIClcbiAgfVxuXG4gIHZpc2l0TGFtYmRhRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2UgPSAoY29udGV4dDogUGFyc2VyLkZvcm1hbFBhcmFtZXRlclNlcXVlbmNlQ29udGV4dCB8IFBhcnNlci5QYXJhbWV0ZXJDb250ZXh0KTogRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VOb2RlID0+IHtcbiAgICBpZiAoY29udGV4dCBpbnN0YW5jZW9mIFBhcnNlci5QYXJhbWV0ZXJDb250ZXh0KSB7XG4gICAgICByZXR1cm4gY3JlYXRlRm9ybWFsUGFyZW1ldGVyU2VxdWVuY2VOb2RlKFt0aGlzLnZpc2l0UGFyYW1ldGVyKGNvbnRleHQpXSlcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUZvcm1hbFBhcmVtZXRlclNlcXVlbmNlTm9kZSh0aGlzLnZpc2l0UGFyYW1ldGVycyhjb250ZXh0LnBhcmFtZXRlcigpKSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZClcbiAgfVxuXG4gIHZpc2l0UGFyYW1ldGVycyA9IChjb250ZXh0czogUGFyc2VyLlBhcmFtZXRlckNvbnRleHRbXSk6IFBhcmFtZXRlck5vZGVbXSA9PiB7XG4gICAgcmV0dXJuIGNvbnRleHRzLm1hcChjb250ZXh0ID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0UGFyYW1ldGVyKGNvbnRleHQpO1xuICAgIH0pXG4gIH1cblxuICB2aXNpdFBhcmFtZXRlciA9IChjb250ZXh0OiBQYXJzZXIuUGFyYW1ldGVyQ29udGV4dCk6IFBhcmFtZXRlck5vZGUgPT4ge1xuICAgIGxldCBpZGVudGlmaWVyID0gdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpO1xuICAgIGxldCB0eXBlOiBUeXBlTm9kZVxuICAgIGlmIChjb250ZXh0LnR5cGUoKSkge1xuICAgICAgdHlwZSA9IHRoaXMudmlzaXRUeXBlKGNvbnRleHQudHlwZSgpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZVBhcmFtZXRlck5vZGUoaWRlbnRpZmllciwgdHlwZSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdFR1cGxlID0gKGNvbnRleHQ6IFBhcnNlci5UdXBsZVR5cGVDb250ZXh0KTogVHVwbGVUeXBlTm9kZSA9PiB7XG4gICAgbGV0IGlkZW50aWZpZXI6IElkZW50aWZpZXJOb2RlXG4gICAgbGV0IHR5cGVzOiBUeXBlTm9kZVtdXG4gICAgaWYgKGNvbnRleHQuaWRlbnRpZmllcigpKSB7XG4gICAgICBpZGVudGlmaWVyID0gdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnR1cGxlVHlwZVNlcXVlbmNlKCkpIHtcbiAgICAgIHR5cGVzID0gdGhpcy52aXNpdFR1cGxlU2VxdWVuY2VUeXBlKGNvbnRleHQudHVwbGVUeXBlU2VxdWVuY2UoKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZVR1cGxlVHlwZU5vZGUoaWRlbnRpZmllciwgdHlwZXMsIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpO1xuICB9XG5cbiAgdmlzaXRUdXBsZVNlcXVlbmNlVHlwZSA9IChjb250ZXh0OiBQYXJzZXIuVHVwbGVUeXBlU2VxdWVuY2VDb250ZXh0KTogVHlwZU5vZGVbXSB8IHVuZGVmaW5lZFtdID0+IHtcbiAgICByZXR1cm4gKGNvbnRleHQudHlwZSgpIHx8IFtdKS5tYXAodHlwZSA9PiB0aGlzLnZpc2l0VHlwZSh0eXBlKSk7XG4gIH1cblxuICB2aXNpdFByaW1hcnlUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5QcmltYXJ5VHlwZUNvbnRleHQpID0+IHtcblxuICAgIGxldCBwcmltYXJ5OiBJZGVudGlmaWVyTm9kZSB8IEtleXdvcmROb2RlIHwgUHJvcGVydHlJZGVudGlmaWVyTm9kZTtcblxuICAgIGlmIChjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKSB7XG4gICAgICBwcmltYXJ5ID0gdGhpcy52aXNpdE9wdGlvbmFsSWRlbnRpZmllcihjb250ZXh0Lm9wdGlvbmFsSWRlbnRpZmllcigpKTtcbiAgICB9IGVsc2UgaWYgKGNvbnRleHQuaWRlbnRpZmllck9yS2V5d29yZCgpKSB7XG4gICAgICBwcmltYXJ5ID0gdGhpcy52aXNpdElkZW50aWZpZXJPcktleXdvcmQoY29udGV4dC5pZGVudGlmaWVyT3JLZXl3b3JkKCkpXG4gICAgfSBlbHNlIGlmIChjb250ZXh0LnByb3BlcnR5SWRlbnRpZmllcigpKSB7XG4gICAgICBwcmltYXJ5ID0gdGhpcy52aXNpdFByb3BlcnR5SWRlbnRpZmllcihjb250ZXh0LnByb3BlcnR5SWRlbnRpZmllcigpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZVByaW1hcnlUeXBlTm9kZShwcmltYXJ5LCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHZpc2l0SWRlbnRpZmllck9yS2V5d29yZCA9IChjb250ZXh0OiBQYXJzZXIuSWRlbnRpZmllck9yS2V5d29yZENvbnRleHQpOiAoSWRlbnRpZmllck5vZGUgfCBLZXl3b3JkTm9kZSkgPT4ge1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmtleXdvcmQoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRLZXl3b3JkKGNvbnRleHQua2V5d29yZCgpKVxuICAgIH1cbiAgfVxuXG4gIHZpc2l0S2V5d29yZCA9IChjb250ZXh0OiBQYXJzZXIuS2V5d29yZENvbnRleHQpID0+IHtcbiAgICBpZiAoY29udGV4dC5OdWxsTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlS2V5d29yZE5vZGUoY29udGV4dC5OdWxsTGl0ZXJhbCgpLnRleHQpO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0UGFyZW50aGVzaXplZFR5cGUgPSAoY29udGV4dDogUGFyc2VyLlBhcmVudGhlc2l6ZWRUeXBlQ29udGV4dCwgb3B0aW9uYWwgPSBmYWxzZSk6IFBhcmVudGhlc2l6ZWRUeXBlTm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQudHlwZSgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlUGFyZW50aGVzaXplZFR5cGVOb2RlKHRoaXMudmlzaXRUeXBlKGNvbnRleHQudHlwZSgpKSwgb3B0aW9uYWwsIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0VW5hcnlUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5VbmFyeVR5cGVDb250ZXh0KSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZVVuYXJ5VHlwZU5vZGUoXG4gICAgICAoY29udGV4dC5BTVAoKSB8fCBjb250ZXh0LlNUQVIoKSkudGV4dCxcbiAgICAgIHRoaXMudmlzaXRQcmltYXJ5VHlwZShjb250ZXh0LnByaW1hcnlUeXBlKCkpLFxuICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICk7XG4gIH1cblxuICB2aXNpdE9iamVjdFR5cGUgPSAoY29udGV4dDogUGFyc2VyLk9iamVjdFR5cGVDb250ZXh0KSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZU9iamVjdFR5cGVOb2RlKHRoaXMudmlzaXRPYmplY3RQYWlyU2VxdWVuY2VUeXBlKGNvbnRleHQub2JqZWN0UGFpclNlcXVlbmNlVHlwZSgpKSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdE9iamVjdFBhaXJTZXF1ZW5jZVR5cGUgPSAoY29udGV4dDogUGFyc2VyLk9iamVjdFBhaXJTZXF1ZW5jZVR5cGVDb250ZXh0KSA9PiB7XG4gICAgcmV0dXJuIChjb250ZXh0ID8gY29udGV4dC5vYmplY3RQYWlyVHlwZSgpIDogW10pLm1hcChwYWlyID0+IHtcbiAgICAgIHJldHVybiBjcmVhdGVPYmplY3RQYWlyVHlwZU5vZGUodGhpcy52aXNpdFR5cGUocGFpci50eXBlKDApKSwgdGhpcy52aXNpdFR5cGUocGFpci50eXBlKDEpKSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IHBhaXIudGV4dCA6IHVuZGVmaW5lZClcbiAgICB9KTtcbiAgfVxuXG4gIHZpc2l0QXJyYXlUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5BcnJheVR5cGVDb250ZXh0KTogQXJyYXlUeXBlTm9kZSA9PiB7XG5cbiAgICBpZiAoY29udGV4dC5ub3RBcnJheVR5cGUoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUFycmF5VHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQubm90QXJyYXlUeXBlKCkpLFxuICAgICAgICAoY29udGV4dC50eXBlKCkgfHwgW10pLm1hcCh0eXBlID0+IHRoaXMudmlzaXRUeXBlKHR5cGUpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUFycmF5VHlwZU5vZGUoXG4gICAgICBudWxsLFxuICAgICAgKGNvbnRleHQudHlwZSgpIHx8IFtdKS5tYXAodHlwZSA9PiB0aGlzLnZpc2l0VHlwZSh0eXBlKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cbiAgdmlzaXRQcm9wZXJ0eUlkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLlByb3BlcnR5SWRlbnRpZmllckNvbnRleHQpOiBQcm9wZXJ0eUlkZW50aWZpZXJOb2RlID0+IHtcblxuICAgIC8vIEFzc3VtZSAnY29udGV4dCcgaXMgZGVmaW5lZC5cbiAgICBsZXQgaWRlbnRpZmllciA9IGNvbnRleHQuaWRlbnRpZmllcigpID9cbiAgICAgIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKSA6XG4gICAgICB0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpO1xuICAgIC8vIEEgcHJvcGVydHkgbXVzdCBleGlzdCBzaW5jZSBieSBncmFtbWFyOlxuICAgIC8vIChvcHRpb25hbElkZW50aWZpZXIgfCBpZGVudGlmaWVyKSAoJy4nIG9wdGlvbmFsSWRlbnRpZmllck9ySWRlbnRpZmllcikrXG4gICAgbGV0IHByb3BlcnR5ID0gY29udGV4dC5vcHRpb25hbElkZW50aWZpZXJPcklkZW50aWZpZXIoKVxuICAgICAgLm1hcCh0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyT3JJZGVudGlmaWVyKTtcbiAgICAvLyBBZGQgdGhlIGlkZW50aWZpZXIgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgYXJyYXlcbiAgICBwcm9wZXJ0eS51bnNoaWZ0KGlkZW50aWZpZXIpO1xuICAgIHJldHVybiBjcmVhdGVQcm9wZXJ0eUlkZW50aWZpZXJOb2RlKHByb3BlcnR5LCBjb250ZXh0LnRleHQpXG4gIH1cblxuICB2aXNpdE9wdGlvbmFsSWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuT3B0aW9uYWxJZGVudGlmaWVyQ29udGV4dCk6IE9wdGlvbmFsSWRlbnRpZmllck5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpLCAhIWNvbnRleHQuUVVFU1RJT04oKSlcbiAgICB9XG4gIH1cblxuICB2aXNpdE9wdGlvbmFsSWRlbnRpZmllck9ySWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuT3B0aW9uYWxJZGVudGlmaWVyT3JJZGVudGlmaWVyQ29udGV4dCk6IE9wdGlvbmFsSWRlbnRpZmllck5vZGUgfCBJZGVudGlmaWVyTm9kZSA9PiB7XG4gICAgaWYgKGNvbnRleHQuaWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpXG4gICAgfVxuICB9XG5cbiAgLyogRXhwcmVzc2lvbiB2aXNpdG9yICovXG5cbiAgdmlzaXRFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5FeHByZXNzaW9uQ29udGV4dCk6IEV4cHJlc3Npb25Ob2RlID0+IHtcbiAgICBpZiAoY29udGV4dC51bmFyeUV4cHJlc3Npb24oKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUV4cHJlc3Npb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0VW5hcnlFeHByZXNzaW9uKGNvbnRleHQudW5hcnlFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuZXhwcmVzc2lvbigpLmxlbmd0aCA+IDEpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgY3JlYXRlQmluYXJ5RXhwcmVzc2lvbk5vZGUoXG4gICAgICAgICAgKGNvbnRleHQuUExVUygpIHx8IGNvbnRleHQuTUlOVVMoKSB8fCBjb250ZXh0LlNUQVIoKSB8fCBjb250ZXh0LkZPUldBUkRfU0xBU0goKSkudGV4dCxcbiAgICAgICAgICB0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oMCkpLFxuICAgICAgICAgIHRoaXMudmlzaXRFeHByZXNzaW9uKGNvbnRleHQuZXhwcmVzc2lvbigxKSksXG4gICAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgICApLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuYXJyYXlFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgY3JlYXRlQXJyYXlFeHByZXNzaW9uTm9kZShcbiAgICAgICAgICB0aGlzLnZpc2l0QXJyYXlFeHByZXNzaW9uKGNvbnRleHQuYXJyYXlFeHByZXNzaW9uKCkpLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LmFycmF5RXhwcmVzc2lvbigpLnRleHQgOiB1bmRlZmluZWRcbiAgICAgICAgKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5vYmplY3RFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdE9iamVjdEV4cHJlc3Npb24oY29udGV4dC5vYmplY3RFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQubGFtYmRhRXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRMYW1iZGFFeHByZXNzaW9uKGNvbnRleHQubGFtYmRhRXhwcmVzc2lvbigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmxpdGVyYWxFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdExpdGVyYWxFeHByZXNzaW9uKGNvbnRleHQubGl0ZXJhbEV4cHJlc3Npb24oKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5wYXJlbnRoZXNpemVkRXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRQYXJlbnRoZXNpemVkRXhwcmVzc2lvbihjb250ZXh0LnBhcmVudGhlc2l6ZWRFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgdmlzaXRVbmFyeUV4cHJlc3Npb24gPSAoY29udGV4dDogUGFyc2VyLlVuYXJ5RXhwcmVzc2lvbkNvbnRleHQpOiBVbmFyeUV4cHJlc3Npb25Ob2RlID0+IHtcbiAgICByZXR1cm4gY3JlYXRlVW5hcnlFeHByZXNzaW9uTm9kZShcbiAgICAgIChjb250ZXh0LlBMVVMoKSB8fCBjb250ZXh0Lk1JTlVTKCkpLnRleHQsXG4gICAgICB0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cbiAgdmlzaXRBcnJheUV4cHJlc3Npb24gPSAoY29udGV4dDogUGFyc2VyLkFycmF5RXhwcmVzc2lvbkNvbnRleHQpOiBFeHByZXNzaW9uTm9kZVtdID0+IHtcbiAgICByZXR1cm4gKGNvbnRleHQgPyBjb250ZXh0LmV4cHJlc3Npb24oKSA6IFtdKS5tYXAoZXhwcmVzc2lvbiA9PiB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdEV4cHJlc3Npb24oZXhwcmVzc2lvbilcbiAgICB9KVxuICB9XG5cbiAgdmlzaXRPYmplY3RFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5PYmplY3RFeHByZXNzaW9uQ29udGV4dCk6IE9iamVjdEV4cHJlc3Npb25Ob2RlID0+IHtcbiAgICByZXR1cm4gY3JlYXRlT2JqZWN0RXhwcmVzc2lvbk5vZGUoXG4gICAgICB0aGlzLnZpc2l0T2JqZWN0UGFpclNlcXVlbmNlRXhwcmVzc2lvbihjb250ZXh0Lm9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb24oKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cblxuICB2aXNpdE9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb24gPSAoY29udGV4dDogUGFyc2VyLk9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb25Db250ZXh0KTogT2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlW10gPT4ge1xuICAgIHJldHVybiAoY29udGV4dCA/IGNvbnRleHQub2JqZWN0UGFpckV4cHJlc3Npb24oKSA6IFtdKS5tYXAocGFpciA9PiB7XG4gICAgICByZXR1cm4gY3JlYXRlT2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0TGl0ZXJhbEV4cHJlc3Npb24ocGFpci5saXRlcmFsRXhwcmVzc2lvbigwKSksXG4gICAgICAgIHBhaXIub2JqZWN0RXhwcmVzc2lvbigpID9cbiAgICAgICAgICB0aGlzLnZpc2l0T2JqZWN0RXhwcmVzc2lvbihwYWlyLm9iamVjdEV4cHJlc3Npb24oKSkgOlxuICAgICAgICAgIHRoaXMudmlzaXRMaXRlcmFsRXhwcmVzc2lvbihwYWlyLmxpdGVyYWxFeHByZXNzaW9uKDEpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH0pO1xuICB9XG5cbiAgdmlzaXRMYW1iZGFFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5MYW1iZGFFeHByZXNzaW9uQ29udGV4dCk6IExhbWJkYUV4cHJlc3Npb25Ob2RlID0+IHtcbiAgICByZXR1cm4gdGhpcy52aXNpdExhbWJkYVR5cGUoY29udGV4dCk7XG4gIH1cblxuICB2aXNpdFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5QYXJlbnRoZXNpemVkRXhwcmVzc2lvbkNvbnRleHQpOiBQYXJlbnRoZXNpemVkRXhwcmVzc2lvbk5vZGUgPT4ge1xuICAgIHJldHVybiBjcmVhdGVQYXJlbnRoZXNpemVkRXhwcmVzc2lvbmVOb2RlKHRoaXMudmlzaXRFeHByZXNzaW9uKGNvbnRleHQuZXhwcmVzc2lvbigpKSk7XG4gIH1cblxuICB2aXNpdExpdGVyYWxFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5MaXRlcmFsRXhwcmVzc2lvbkNvbnRleHQpOiBMaXRlcmFsRXhwcmVzc2lvbk5vZGUgPT4ge1xuICAgIGxldCBub2RlID0geyBsaXRlcmFsOiB7fSB9XG4gICAgaWYgKGNvbnRleHQuTnVtYmVyTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKFxuICAgICAgICAnbnVtYmVyJyxcbiAgICAgICAgY29udGV4dC5OdW1iZXJMaXRlcmFsKCkudGV4dFxuICAgICAgKVxuICAgIH1cbiAgICBpZiAoY29udGV4dC5Cb29sZWFuTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKCdib29sZWFuJywgY29udGV4dC5Cb29sZWFuTGl0ZXJhbCgpLnRleHQpXG4gICAgfVxuICAgIGlmIChjb250ZXh0LkNoYXJhY3RlckxpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZSgnY2hhcmFjdGVyJywgY29udGV4dC5DaGFyYWN0ZXJMaXRlcmFsKCkudGV4dClcbiAgICB9XG4gICAgaWYgKGNvbnRleHQuU3RyaW5nTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKCdzdHJpbmcnLCBjb250ZXh0LlN0cmluZ0xpdGVyYWwoKS50ZXh0KVxuICAgIH1cbiAgICBpZiAoY29udGV4dC5OdWxsTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKCdudWxsJywgY29udGV4dC5OdWxsTGl0ZXJhbCgpLnRleHQpXG4gICAgfVxuICB9XG5cbiAgLyogRGVzY3JpcHRpb24gdmlzaXRvciAqL1xuXG4gIHZpc2l0RGVzY3JpcHRpb24gPSAoY29udGV4dDogUGFyc2VyLkRlc2NyaXB0aW9uQ29udGV4dCk6IERlc2NyaXB0aW9uTm9kZSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZURlc2NyaXB0aW9uTm9kZShcbiAgICAgIGNvbnRleHQudGV4dCxcbiAgICAgIHRoaXMudmlzaXREZXNjcmlwdGlvbkxpbmUoY29udGV4dC5kZXNjcmlwdGlvbkxpbmUoKSlcbiAgICApXG4gIH1cblxuICB2aXNpdERlc2NyaXB0aW9uTGluZSA9IChjb250ZXh0OiBQYXJzZXIuRGVzY3JpcHRpb25MaW5lQ29udGV4dCk6IElubGluZVRhZ05vZGVbXSA9PiB7XG4gICAgcmV0dXJuIHRoaXMudmlzaXREZXNjcmlwdGlvbkxpbmVFbGVtZW50KGNvbnRleHQuZGVzY3JpcHRpb25MaW5lRWxlbWVudCgpKTtcbiAgfVxuXG4gIHZpc2l0RGVzY3JpcHRpb25MaW5lRWxlbWVudCA9IChjb250ZXh0OiBQYXJzZXIuRGVzY3JpcHRpb25MaW5lRWxlbWVudENvbnRleHRbXSk6IElubGluZVRhZ05vZGVbXSA9PiB7XG4gICAgcmV0dXJuIChjb250ZXh0IHx8IFtdKS5tYXAoZWxlbWVudCA9PiB7XG4gICAgICByZXR1cm4gZWxlbWVudC5pbmxpbmVUYWcoKSA/IHRoaXMudmlzaXRJbmxpbmVUYWcoZWxlbWVudC5pbmxpbmVUYWcoKSkgOiB1bmRlZmluZWRcbiAgICB9KS5maWx0ZXIoZWxlbWVudCA9PiBlbGVtZW50ICE9PSB1bmRlZmluZWQpO1xuICB9XG5cbiAgdmlzaXRJbmxpbmVUYWcgPSAoY29udGV4dDogUGFyc2VyLklubGluZVRhZ0NvbnRleHQpOiBJbmxpbmVUYWdOb2RlID0+IHtcbiAgICByZXR1cm4gY3JlYXRlSW5saW5lVGFnTm9kZShcbiAgICAgIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaW5saW5lVGFnTmFtZSgpLmlkZW50aWZpZXIoKSksXG4gICAgICB0aGlzLnZpc2l0SW5saW5lVGFnQm9keShjb250ZXh0LmlubGluZVRhZ0JvZHkoKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKTtcbiAgfVxuXG4gIHZpc2l0SW5saW5lVGFnQm9keSA9IChjb250ZXh0OiBQYXJzZXIuSW5saW5lVGFnQm9keUNvbnRleHQpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBjb250ZXh0LmJyYWNlQm9keSgpLm1hcChib2R5ID0+IGJvZHkudGV4dCkuam9pbignJyk7XG4gIH1cbn0iXX0=