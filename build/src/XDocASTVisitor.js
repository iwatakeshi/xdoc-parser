"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Parser = require("./XDocSyntaxParser");
require("./XDocSyntaxParserVisitor");
const XDocASTNode_1 = require("./XDocASTNode");
/**
 * XDocAST is a class that converts a Antlr parse tree
 * into a Javascript tree object.
 *
 * # API
 *
 * ```
 * @class XDocAST
 * ```
 */
class XDocASTVisitor {
    constructor(documentation, options) {
        this.options = {
            showNodeText: false
        };
        /**
         * Converts the Antlr parse tree into a JavaScript tree object.
         *
         * # API
         *
         * ```
         * @method visit
         * @param context: Parser.DocumentationConext
         * @return: {
         *  name?: string,
         *  id?: {},
         *  value?: {},
         *  type?: {},
         *  description?: {}
         * }[]
         * ```
         */
        this.visit = () => {
            return this.visitDocumentation(this.documentation);
        };
        /* Documentation visitor */
        this.visitDocumentation = (context) => {
            if (context.body()) {
                return XDocASTNode_1.createDocumentationNode(this.visitBody(context.body()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitBody = (context) => {
            if (context.annotations()) {
                return XDocASTNode_1.createBodyNode(this.visitAnnotations(context.annotations(), this.options), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitAnnotations = (context, options) => {
            if (context.tag()) {
                return (context.tag() || []).map(this.visitTag);
            }
        };
        this.visitTag = (context) => {
            let name, identifier, type, expression, description;
            if (context.tagName()) {
                name = this.visitTagName(context.tagName());
            }
            if (context.tagIdentifier()) {
                identifier = this.visitTagIdentifier(context.tagIdentifier());
            }
            if (context.type()) {
                type = this.visitType(context.type());
            }
            if (context.expression()) {
                expression = this.visitExpression(context.expression());
            }
            if (context.description()) {
                description = this.visitDescription(context.description());
            }
            return XDocASTNode_1.createTagNode(name, identifier, type, expression, description, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTagName = (context) => {
            if (context.identifier()) {
                return XDocASTNode_1.createTagNameNode(this.visitIdentifier(context.identifier()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitTagIdentifier = (context) => {
            let identifier, property;
            if (context.identifier()) {
                identifier = this.visitIdentifier(context.identifier());
            }
            if (context.optionalTagIdentifier()) {
                identifier = this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            }
            if (context.propertyTagIdentifier()) {
                property = this.visitPropertyTagIdentifier(context.propertyTagIdentifier());
            }
            return XDocASTNode_1.createTagIdentifierNode(identifier, property, this.options.showNodeText ? context.text : undefined);
        };
        this.visitPropertyTagIdentifier = (context) => {
            // Assume 'context' is defined.
            let identifier = context.identifier() ?
                this.visitIdentifier(context.identifier()) :
                this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            // A property must exist since by grammar:
            // (optionalTagIdentifier | identifier) ('.' optionalTagOrIdentifier)+
            let property = context.optionalTagOrIdentifier()
                .map(this.visitOptionalTagOrIdentifier);
            // Add the identifier to the beginning of the array
            property.unshift(identifier);
            return XDocASTNode_1.createPropertyTagIdentifierNode(property, context.text);
        };
        this.visitOptionalTagIdentifer = (context) => {
            if (context.optionalIdentifier()) {
                return XDocASTNode_1.createOptionalTagIdentifierNode(this.visitOptionalIdentifier(context.optionalIdentifier()));
            }
        };
        this.visitOptionalTagOrIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.optionalTagIdentifier()) {
                return this.visitOptionalTagIdentifer(context.optionalTagIdentifier());
            }
        };
        this.visitIdentifier = (context, optional = false) => {
            if (context.ID()) {
                return XDocASTNode_1.createIdentifierNode(context.ID().text, optional, []);
            }
        };
        /* Type visitor */
        this.visitType = (context, optional = false) => {
            // Intersections
            if (context.PIPE()) {
                return XDocASTNode_1.createTypeNode(XDocASTNode_1.createIntersectTypeNode(this.visitType(context instanceof Parser.TypeContext ? context.type(0) : context.notArrayType(0)), this.visitType(context instanceof Parser.TypeContext ? context.type(1) : context.notArrayType(1)), this.options.showNodeText ? context.text : undefined), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.AMP()) { // Unions
                return XDocASTNode_1.createTypeNode(XDocASTNode_1.createUnionTypeNode(this.visitType(context instanceof Parser.TypeContext ? context.type(0) : context.notArrayType(0)), this.visitType(context instanceof Parser.TypeContext ? context.type(1) : context.notArrayType(1)), this.options.showNodeText ? context.text : undefined), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.lambdaType()) { // Lambda functions i.e. (id) => type
                return XDocASTNode_1.createTypeNode(this.visitLambdaType(context.lambdaType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.tupleType()) { // id<type, type>
                return XDocASTNode_1.createTypeNode(this.visitTuple(context.tupleType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.primaryType()) { // Primary
                return XDocASTNode_1.createTypeNode(this.visitPrimaryType(context.primaryType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.parenthesizedType()) { // (expression)
                return XDocASTNode_1.createTypeNode(this.visitParenthesizedType(context.parenthesizedType(), optional), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.unaryType()) {
                return XDocASTNode_1.createTypeNode(this.visitUnaryType(context.unaryType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context.objectType()) { // { ... }
                return XDocASTNode_1.createTypeNode(this.visitObjectType(context.objectType()), optional, this.options.showNodeText ? context.text : undefined);
            }
            if (context instanceof Parser.TypeContext && context.arrayType()) { // [ ... ]
                return XDocASTNode_1.createTypeNode(this.visitArrayType(context.arrayType()), optional, this.options.showNodeText ? context.text : undefined);
            }
        };
        /* Lambda visitor */
        this.visitLambdaType = (context) => {
            if (context.formalParameterSequence()) {
                return XDocASTNode_1.createLambdaTypeNode(this.visitLambdaFormalParameterSequence(context.formalParameterSequence()), this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
            }
            else if (context.parameter()) {
                return XDocASTNode_1.createLambdaTypeNode(this.visitLambdaFormalParameterSequence(context.parameter()), this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
            }
            return XDocASTNode_1.createLambdaTypeNode(null, this.visitType(context.type(), !!context.QUESTION()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitLambdaFormalParameterSequence = (context) => {
            if (context instanceof Parser.ParameterContext) {
                return XDocASTNode_1.createFormalParemeterSequenceNode([this.visitParameter(context)]);
            }
            return XDocASTNode_1.createFormalParemeterSequenceNode(this.visitParameters(context.parameter()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitParameters = (contexts) => {
            return contexts.map(context => {
                return this.visitParameter(context);
            });
        };
        this.visitParameter = (context) => {
            let identifier = this.visitIdentifier(context.identifier());
            let type;
            if (context.type()) {
                type = this.visitType(context.type());
            }
            return XDocASTNode_1.createParameterNode(identifier, type, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTuple = (context) => {
            let identifier;
            let types;
            if (context.identifier()) {
                identifier = this.visitIdentifier(context.identifier());
            }
            if (context.tupleTypeSequence()) {
                types = this.visitTupleSequenceType(context.tupleTypeSequence());
            }
            return XDocASTNode_1.createTupleTypeNode(identifier, types, this.options.showNodeText ? context.text : undefined);
        };
        this.visitTupleSequenceType = (context) => {
            return (context.type() || []).map(type => this.visitType(type));
        };
        this.visitPrimaryType = (context) => {
            let primary;
            if (context.optionalIdentifier()) {
                primary = this.visitOptionalIdentifier(context.optionalIdentifier());
            }
            else if (context.identifierOrKeyword()) {
                primary = this.visitIdentifierOrKeyword(context.identifierOrKeyword());
            }
            else if (context.propertyIdentifier()) {
                primary = this.visitPropertyIdentifier(context.propertyIdentifier());
            }
            return XDocASTNode_1.createPrimaryTypeNode(primary, this.options.showNodeText ? context.text : undefined);
        };
        this.visitIdentifierOrKeyword = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.keyword()) {
                return this.visitKeyword(context.keyword());
            }
        };
        this.visitKeyword = (context) => {
            if (context.NullLiteral()) {
                return XDocASTNode_1.createKeywordNode(context.NullLiteral().text);
            }
        };
        this.visitParenthesizedType = (context, optional = false) => {
            if (context.type()) {
                return XDocASTNode_1.createParenthesizedTypeNode(this.visitType(context.type()), optional, this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitUnaryType = (context) => {
            return XDocASTNode_1.createUnaryTypeNode((context.AMP() || context.STAR()).text, this.visitPrimaryType(context.primaryType()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectType = (context) => {
            return XDocASTNode_1.createObjectTypeNode(this.visitObjectPairSequenceType(context.objectPairSequenceType()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectPairSequenceType = (context) => {
            return (context ? context.objectPairType() : []).map(pair => {
                return XDocASTNode_1.createObjectPairTypeNode(this.visitType(pair.type(0)), this.visitType(pair.type(1)), this.options.showNodeText ? pair.text : undefined);
            });
        };
        this.visitArrayType = (context) => {
            if (context.notArrayType()) {
                return XDocASTNode_1.createArrayTypeNode(this.visitType(context.notArrayType()), (context.type() || []).map(type => this.visitType(type)), this.options.showNodeText ? context.text : undefined);
            }
            return XDocASTNode_1.createArrayTypeNode(null, (context.type() || []).map(type => this.visitType(type)), this.options.showNodeText ? context.text : undefined);
        };
        this.visitPropertyIdentifier = (context) => {
            // Assume 'context' is defined.
            let identifier = context.identifier() ?
                this.visitIdentifier(context.identifier()) :
                this.visitOptionalIdentifier(context.optionalIdentifier());
            // A property must exist since by grammar:
            // (optionalIdentifier | identifier) ('.' optionalIdentifierOrIdentifier)+
            let property = context.optionalIdentifierOrIdentifier()
                .map(this.visitOptionalIdentifierOrIdentifier);
            // Add the identifier to the beginning of the array
            property.unshift(identifier);
            return XDocASTNode_1.createPropertyIdentifierNode(property, context.text);
        };
        this.visitOptionalIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier(), !!context.QUESTION());
            }
        };
        this.visitOptionalIdentifierOrIdentifier = (context) => {
            if (context.identifier()) {
                return this.visitIdentifier(context.identifier());
            }
            if (context.optionalIdentifier()) {
                return this.visitOptionalIdentifier(context.optionalIdentifier());
            }
        };
        /* Expression visitor */
        this.visitExpression = (context) => {
            if (context.unaryExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitUnaryExpression(context.unaryExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.expression().length > 1) {
                return XDocASTNode_1.createExpressionNode(XDocASTNode_1.createBinaryExpressionNode((context.PLUS() || context.MINUS() || context.STAR() || context.FORWARD_SLASH()).text, this.visitExpression(context.expression(0)), this.visitExpression(context.expression(1)), this.options.showNodeText ? context.text : undefined), this.options.showNodeText ? context.text : undefined);
            }
            if (context.arrayExpression()) {
                return XDocASTNode_1.createExpressionNode(XDocASTNode_1.createArrayExpressionNode(this.visitArrayExpression(context.arrayExpression()), this.options.showNodeText ? context.arrayExpression().text : undefined), this.options.showNodeText ? context.text : undefined);
            }
            if (context.objectExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitObjectExpression(context.objectExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.lambdaExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitLambdaExpression(context.lambdaExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.literalExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitLiteralExpression(context.literalExpression()), this.options.showNodeText ? context.text : undefined);
            }
            if (context.parenthesizedExpression()) {
                return XDocASTNode_1.createExpressionNode(this.visitParenthesizedExpression(context.parenthesizedExpression()), this.options.showNodeText ? context.text : undefined);
            }
        };
        this.visitUnaryExpression = (context) => {
            return XDocASTNode_1.createUnaryExpressionNode((context.PLUS() || context.MINUS()).text, this.visitExpression(context.expression()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitArrayExpression = (context) => {
            return (context ? context.expression() : []).map(expression => {
                return this.visitExpression(expression);
            });
        };
        this.visitObjectExpression = (context) => {
            return XDocASTNode_1.createObjectExpressionNode(this.visitObjectPairSequenceExpression(context.objectPairSequenceExpression()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitObjectPairSequenceExpression = (context) => {
            return (context ? context.objectPairExpression() : []).map(pair => {
                return XDocASTNode_1.createObjectPairExpressionNode(this.visitLiteralExpression(pair.literalExpression(0)), pair.objectExpression() ?
                    this.visitObjectExpression(pair.objectExpression()) :
                    this.visitLiteralExpression(pair.literalExpression(1)), this.options.showNodeText ? context.text : undefined);
            });
        };
        this.visitLambdaExpression = (context) => {
            return this.visitLambdaType(context);
        };
        this.visitParenthesizedExpression = (context) => {
            return XDocASTNode_1.createParenthesizedExpressioneNode(this.visitExpression(context.expression()));
        };
        this.visitLiteralExpression = (context) => {
            let node = { literal: {} };
            if (context.NumberLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('number', context.NumberLiteral().text);
            }
            if (context.BooleanLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('boolean', context.BooleanLiteral().text);
            }
            if (context.CharacterLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('character', context.CharacterLiteral().text);
            }
            if (context.StringLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('string', context.StringLiteral().text);
            }
            if (context.NullLiteral()) {
                return XDocASTNode_1.createLiteralExpressionNode('null', context.NullLiteral().text);
            }
        };
        /* Description visitor */
        this.visitDescription = (context) => {
            return XDocASTNode_1.createDescriptionNode(context.text, this.visitDescriptionLine(context.descriptionLine()));
        };
        this.visitDescriptionLine = (context) => {
            return this.visitDescriptionLineElement(context.descriptionLineElement());
        };
        this.visitDescriptionLineElement = (context) => {
            return (context || []).map(element => {
                return element.inlineTag() ? this.visitInlineTag(element.inlineTag()) : undefined;
            }).filter(element => element !== undefined);
        };
        this.visitInlineTag = (context) => {
            return XDocASTNode_1.createInlineTagNode(this.visitIdentifier(context.inlineTagName().identifier()), this.visitInlineTagBody(context.inlineTagBody()), this.options.showNodeText ? context.text : undefined);
        };
        this.visitInlineTagBody = (context) => {
            return context.braceBody().map(body => body.text).join('');
        };
        Object.assign(this.options, options);
        this.documentation = documentation;
    }
}
exports.default = XDocASTVisitor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWERvY0FTVFZpc2l0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvWERvY0FTVFZpc2l0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2Q0FBNkM7QUFDN0MscUNBQW1DO0FBQ25DLCtDQWdFdUI7QUFNdkI7Ozs7Ozs7OztHQVNHO0FBQ0gsTUFBcUIsY0FBYztJQU1qQyxZQUFZLGFBQTBDLEVBQUUsT0FBd0M7UUFKeEYsWUFBTyxHQUEwQjtZQUN2QyxZQUFZLEVBQUUsS0FBSztTQUNwQixDQUFBO1FBTUQ7Ozs7Ozs7Ozs7Ozs7Ozs7V0FnQkc7UUFDSCxVQUFLLEdBQUcsR0FBK0IsRUFBRTtZQUN2QyxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFBO1FBQ0QsMkJBQTJCO1FBRTNCLHVCQUFrQixHQUFHLENBQ25CLE9BQW9DLEVBQ1IsRUFBRTtZQUM5QixJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDbEIsT0FBTyxxQ0FBdUIsQ0FDNUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsRUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FDckQsQ0FBQTthQUNGO1FBQ0gsQ0FBQyxDQUFBO1FBRUQsY0FBUyxHQUFHLENBQ1YsT0FBMkIsRUFDUixFQUFFO1lBQ3JCLElBQUksT0FBTyxDQUFDLFdBQVcsRUFBRSxFQUFFO2dCQUN6QixPQUFPLDRCQUFjLENBQ25CLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUMxRCxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxD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LElBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO0lBQ3JDLENBQUM7Q0EwaUJGO0FBbmpCRCxpQ0FtakJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0ICogYXMgUGFyc2VyIGZyb20gJy4vWERvY1N5bnRheFBhcnNlcic7XG5pbXBvcnQgJy4vWERvY1N5bnRheFBhcnNlclZpc2l0b3InO1xuaW1wb3J0IHtcbiAgQW5ub3RhdGlvbnNOb2RlLFxuICBBcnJheVR5cGVOb2RlLFxuICBCb2R5Tm9kZSxcbiAgY3JlYXRlQXJyYXlFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlQXJyYXlUeXBlTm9kZSxcbiAgY3JlYXRlQmluYXJ5RXhwcmVzc2lvbk5vZGUsXG4gIGNyZWF0ZUJvZHlOb2RlLFxuICBjcmVhdGVEZXNjcmlwdGlvbk5vZGUsXG4gIGNyZWF0ZURvY3VtZW50YXRpb25Ob2RlLFxuICBjcmVhdGVFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlRm9ybWFsUGFyZW1ldGVyU2VxdWVuY2VOb2RlLFxuICBjcmVhdGVJZGVudGlmaWVyTm9kZSxcbiAgY3JlYXRlSW5saW5lVGFnTm9kZSxcbiAgY3JlYXRlSW50ZXJzZWN0VHlwZU5vZGUsXG4gIGNyZWF0ZUtleXdvcmROb2RlLFxuICBjcmVhdGVMYW1iZGFUeXBlTm9kZSxcbiAgY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVPYmplY3RFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlT2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlLFxuICBjcmVhdGVPYmplY3RQYWlyVHlwZU5vZGUsXG4gIGNyZWF0ZU9iamVjdFR5cGVOb2RlLFxuICBjcmVhdGVQYXJhbWV0ZXJOb2RlLFxuICBjcmVhdGVQYXJlbnRoZXNpemVkVHlwZU5vZGUsXG4gIGNyZWF0ZVByaW1hcnlUeXBlTm9kZSxcbiAgY3JlYXRlUHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZSxcbiAgY3JlYXRlUHJvcGVydHlJZGVudGlmaWVyTm9kZSxcbiAgY3JlYXRlVGFnSWRlbnRpZmllck5vZGUsIGNyZWF0ZU9wdGlvbmFsVGFnSWRlbnRpZmllck5vZGUsXG4gIGNyZWF0ZVRhZ05hbWVOb2RlLFxuICBjcmVhdGVUYWdOb2RlLFxuICBjcmVhdGVUdXBsZVR5cGVOb2RlLFxuICBjcmVhdGVUeXBlTm9kZSxcbiAgY3JlYXRlVW5hcnlFeHByZXNzaW9uTm9kZSxcbiAgY3JlYXRlVW5hcnlUeXBlTm9kZSxcbiAgY3JlYXRlVW5pb25UeXBlTm9kZSxcbiAgRGVzY3JpcHRpb25Ob2RlLFxuICBEb2N1bWVudGF0aW9uTm9kZSxcbiAgRXhwcmVzc2lvbk5vZGUsXG4gIEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZSxcbiAgSWRlbnRpZmllck5vZGUsXG4gIElubGluZVRhZ05vZGUsXG4gIEtleXdvcmROb2RlLFxuICBMYW1iZGFFeHByZXNzaW9uTm9kZSxcbiAgTGFtYmRhVHlwZU5vZGUsXG4gIExpdGVyYWxFeHByZXNzaW9uTm9kZSxcbiAgT2JqZWN0RXhwcmVzc2lvbk5vZGUsXG4gIE9iamVjdFBhaXJFeHByZXNzaW9uTm9kZSxcbiAgT3B0aW9uYWxJZGVudGlmaWVyTm9kZSxcbiAgT3B0aW9uYWxUYWdJZGVudGlmaWVyTm9kZSxcbiAgUGFyYW1ldGVyTm9kZSxcbiAgUGFyZW50aGVzaXplZEV4cHJlc3Npb25Ob2RlLFxuICBQcm9wZXJ0eVRhZ0lkZW50aWZpZXJOb2RlLFxuICBUYWdJZGVudGlmaWVyTm9kZSxcbiAgVGFnTmFtZU5vZGUsXG4gIFRhZ05vZGUsXG4gIFR1cGxlVHlwZU5vZGUsXG4gIFR5cGVOb2RlLFxuICBVbmFyeUV4cHJlc3Npb25Ob2RlLFxuICBQcm9wZXJ0eUlkZW50aWZpZXJOb2RlLFxuICBQYXJlbnRoZXNpemVkVHlwZU5vZGUsXG4gIGNyZWF0ZVBhcmVudGhlc2l6ZWRFeHByZXNzaW9uZU5vZGUsXG4gIFByaW1hcnlUeXBlTm9kZSxcbiAgVW5hcnlUeXBlTm9kZSxcbiAgT2JqZWN0VHlwZU5vZGUsXG59IGZyb20gJy4vWERvY0FTVE5vZGUnO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgWERvY0FTVFZpc2l0b3JPcHRpb25zIHtcbiAgc2hvd05vZGVUZXh0OiBib29sZWFuXG59XG4vKipcbiAqIFhEb2NBU1QgaXMgYSBjbGFzcyB0aGF0IGNvbnZlcnRzIGEgQW50bHIgcGFyc2UgdHJlZVxuICogaW50byBhIEphdmFzY3JpcHQgdHJlZSBvYmplY3QuXG4gKiBcbiAqICMgQVBJXG4gKiBcbiAqIGBgYFxuICogQGNsYXNzIFhEb2NBU1RcbiAqIGBgYFxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBYRG9jQVNUVmlzaXRvciB7XG4gIHByaXZhdGUgZG9jdW1lbnRhdGlvbjogUGFyc2VyLkRvY3VtZW50YXRpb25Db250ZXh0XG4gIHByaXZhdGUgb3B0aW9uczogWERvY0FTVFZpc2l0b3JPcHRpb25zID0ge1xuICAgIHNob3dOb2RlVGV4dDogZmFsc2VcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGRvY3VtZW50YXRpb246IFBhcnNlci5Eb2N1bWVudGF0aW9uQ29udGV4dCwgb3B0aW9ucz86IFBhcnRpYWw8WERvY0FTVFZpc2l0b3JPcHRpb25zPikge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcy5vcHRpb25zLCBvcHRpb25zKTtcbiAgICB0aGlzLmRvY3VtZW50YXRpb24gPSBkb2N1bWVudGF0aW9uO1xuICB9XG4gIC8qKlxuICAgKiBDb252ZXJ0cyB0aGUgQW50bHIgcGFyc2UgdHJlZSBpbnRvIGEgSmF2YVNjcmlwdCB0cmVlIG9iamVjdC5cbiAgICogXG4gICAqICMgQVBJXG4gICAqIFxuICAgKiBgYGBcbiAgICogQG1ldGhvZCB2aXNpdFxuICAgKiBAcGFyYW0gY29udGV4dDogUGFyc2VyLkRvY3VtZW50YXRpb25Db25leHRcbiAgICogQHJldHVybjogeyBcbiAgICogIG5hbWU/OiBzdHJpbmcsIFxuICAgKiAgaWQ/OiB7fSwgXG4gICAqICB2YWx1ZT86IHt9LCBcbiAgICogIHR5cGU/OiB7fSwgXG4gICAqICBkZXNjcmlwdGlvbj86IHt9IFxuICAgKiB9W11cbiAgICogYGBgXG4gICAqL1xuICB2aXNpdCA9ICgpOiBQYXJ0aWFsPERvY3VtZW50YXRpb25Ob2RlPiA9PiB7XG4gICAgcmV0dXJuIHRoaXMudmlzaXREb2N1bWVudGF0aW9uKHRoaXMuZG9jdW1lbnRhdGlvbik7XG4gIH1cbiAgLyogRG9jdW1lbnRhdGlvbiB2aXNpdG9yICovXG5cbiAgdmlzaXREb2N1bWVudGF0aW9uID0gKFxuICAgIGNvbnRleHQ6IFBhcnNlci5Eb2N1bWVudGF0aW9uQ29udGV4dFxuICApOiBQYXJ0aWFsPERvY3VtZW50YXRpb25Ob2RlPiA9PiB7XG4gICAgaWYgKGNvbnRleHQuYm9keSgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRG9jdW1lbnRhdGlvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRCb2R5KGNvbnRleHQuYm9keSgpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIHZpc2l0Qm9keSA9IChcbiAgICBjb250ZXh0OiBQYXJzZXIuQm9keUNvbnRleHRcbiAgKTogUGFydGlhbDxCb2R5Tm9kZT4gPT4ge1xuICAgIGlmIChjb250ZXh0LmFubm90YXRpb25zKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVCb2R5Tm9kZShcbiAgICAgICAgdGhpcy52aXNpdEFubm90YXRpb25zKGNvbnRleHQuYW5ub3RhdGlvbnMoKSwgdGhpcy5vcHRpb25zKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICB2aXNpdEFubm90YXRpb25zID0gKFxuICAgIGNvbnRleHQ6IFBhcnNlci5Bbm5vdGF0aW9uc0NvbnRleHQsXG4gICAgb3B0aW9uczogWERvY0FTVFZpc2l0b3JPcHRpb25zXG4gICk6IFBhcnRpYWw8QW5ub3RhdGlvbnNOb2RlPiA9PiB7XG4gICAgaWYgKGNvbnRleHQudGFnKCkpIHtcbiAgICAgIHJldHVybiAoY29udGV4dC50YWcoKSB8fCBbXSkubWFwKHRoaXMudmlzaXRUYWcpXG4gICAgfVxuICB9XG5cblxuICB2aXNpdFRhZyA9IChjb250ZXh0OiBQYXJzZXIuVGFnQ29udGV4dCk6IFBhcnRpYWw8VGFnTm9kZT4gPT4ge1xuICAgIGxldCBuYW1lOiBQYXJ0aWFsPFRhZ05hbWVOb2RlPixcbiAgICAgIGlkZW50aWZpZXI6IFBhcnRpYWw8VGFnSWRlbnRpZmllck5vZGU+LFxuICAgICAgdHlwZTogUGFydGlhbDxUeXBlTm9kZT4sXG4gICAgICBleHByZXNzaW9uOiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPixcbiAgICAgIGRlc2NyaXB0aW9uOiBQYXJ0aWFsPERlc2NyaXB0aW9uTm9kZT47XG5cbiAgICBpZiAoY29udGV4dC50YWdOYW1lKCkpIHtcbiAgICAgIG5hbWUgPSB0aGlzLnZpc2l0VGFnTmFtZShjb250ZXh0LnRhZ05hbWUoKSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQudGFnSWRlbnRpZmllcigpKSB7XG4gICAgICBpZGVudGlmaWVyID0gdGhpcy52aXNpdFRhZ0lkZW50aWZpZXIoY29udGV4dC50YWdJZGVudGlmaWVyKCkpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnR5cGUoKSkge1xuICAgICAgdHlwZSA9IHRoaXMudmlzaXRUeXBlKGNvbnRleHQudHlwZSgpKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5leHByZXNzaW9uKCkpIHtcbiAgICAgIGV4cHJlc3Npb24gPSB0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oKSlcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5kZXNjcmlwdGlvbigpKSB7XG4gICAgICBkZXNjcmlwdGlvbiA9IHRoaXMudmlzaXREZXNjcmlwdGlvbihjb250ZXh0LmRlc2NyaXB0aW9uKCkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZVRhZ05vZGUobmFtZSwgaWRlbnRpZmllciwgdHlwZSwgZXhwcmVzc2lvbiwgZGVzY3JpcHRpb24sIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpXG4gIH1cblxuICB2aXNpdFRhZ05hbWUgPSAoY29udGV4dDogUGFyc2VyLlRhZ05hbWVDb250ZXh0KTogUGFydGlhbDxUYWdOYW1lTm9kZT4gPT4ge1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZVRhZ05hbWVOb2RlKHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRUYWdJZGVudGlmaWVyID0gKGNvbnRleHQ6IFBhcnNlci5UYWdJZGVudGlmaWVyQ29udGV4dCk6IFBhcnRpYWw8VGFnSWRlbnRpZmllck5vZGU+ID0+IHtcbiAgICBsZXQgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4gfCBQYXJ0aWFsPE9wdGlvbmFsSWRlbnRpZmllck5vZGU+LFxuICAgICAgcHJvcGVydHk6IFBhcnRpYWw8UHJvcGVydHlUYWdJZGVudGlmaWVyTm9kZT47XG4gICAgaWYgKGNvbnRleHQuaWRlbnRpZmllcigpKSB7XG4gICAgICBpZGVudGlmaWVyID0gdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0Lm9wdGlvbmFsVGFnSWRlbnRpZmllcigpKSB7XG4gICAgICBpZGVudGlmaWVyID0gdGhpcy52aXNpdE9wdGlvbmFsVGFnSWRlbnRpZmVyKGNvbnRleHQub3B0aW9uYWxUYWdJZGVudGlmaWVyKCkpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQucHJvcGVydHlUYWdJZGVudGlmaWVyKCkpIHtcbiAgICAgIHByb3BlcnR5ID0gdGhpcy52aXNpdFByb3BlcnR5VGFnSWRlbnRpZmllcihjb250ZXh0LnByb3BlcnR5VGFnSWRlbnRpZmllcigpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlVGFnSWRlbnRpZmllck5vZGUoaWRlbnRpZmllciwgcHJvcGVydHksIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWQpO1xuICB9XG5cbiAgdmlzaXRQcm9wZXJ0eVRhZ0lkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLlByb3BlcnR5VGFnSWRlbnRpZmllckNvbnRleHQpOiBQYXJ0aWFsPFByb3BlcnR5VGFnSWRlbnRpZmllck5vZGU+ID0+IHtcblxuICAgIC8vIEFzc3VtZSAnY29udGV4dCcgaXMgZGVmaW5lZC5cbiAgICBsZXQgaWRlbnRpZmllciA9IGNvbnRleHQuaWRlbnRpZmllcigpID9cbiAgICAgIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKSA6XG4gICAgICB0aGlzLnZpc2l0T3B0aW9uYWxUYWdJZGVudGlmZXIoY29udGV4dC5vcHRpb25hbFRhZ0lkZW50aWZpZXIoKSk7XG4gICAgLy8gQSBwcm9wZXJ0eSBtdXN0IGV4aXN0IHNpbmNlIGJ5IGdyYW1tYXI6XG4gICAgLy8gKG9wdGlvbmFsVGFnSWRlbnRpZmllciB8IGlkZW50aWZpZXIpICgnLicgb3B0aW9uYWxUYWdPcklkZW50aWZpZXIpK1xuICAgIGxldCBwcm9wZXJ0eSA9IGNvbnRleHQub3B0aW9uYWxUYWdPcklkZW50aWZpZXIoKVxuICAgICAgLm1hcCh0aGlzLnZpc2l0T3B0aW9uYWxUYWdPcklkZW50aWZpZXIpO1xuICAgIC8vIEFkZCB0aGUgaWRlbnRpZmllciB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBhcnJheVxuICAgIHByb3BlcnR5LnVuc2hpZnQoaWRlbnRpZmllcik7XG4gICAgcmV0dXJuIGNyZWF0ZVByb3BlcnR5VGFnSWRlbnRpZmllck5vZGUocHJvcGVydHksIGNvbnRleHQudGV4dCk7XG4gIH1cblxuICB2aXNpdE9wdGlvbmFsVGFnSWRlbnRpZmVyID0gKGNvbnRleHQ6IFBhcnNlci5PcHRpb25hbFRhZ0lkZW50aWZpZXJDb250ZXh0KTogUGFydGlhbDxPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlPiA9PiB7XG4gICAgaWYgKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVPcHRpb25hbFRhZ0lkZW50aWZpZXJOb2RlKHRoaXMudmlzaXRPcHRpb25hbElkZW50aWZpZXIoY29udGV4dC5vcHRpb25hbElkZW50aWZpZXIoKSkpXG4gICAgfVxuICB9XG5cbiAgdmlzaXRPcHRpb25hbFRhZ09ySWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuT3B0aW9uYWxUYWdPcklkZW50aWZpZXJDb250ZXh0KTogKFBhcnRpYWw8SWRlbnRpZmllck5vZGU+IHwgUGFydGlhbDxPcHRpb25hbElkZW50aWZpZXJOb2RlPikgPT4ge1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0Lm9wdGlvbmFsVGFnSWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdE9wdGlvbmFsVGFnSWRlbnRpZmVyKGNvbnRleHQub3B0aW9uYWxUYWdJZGVudGlmaWVyKCkpO1xuICAgIH1cbiAgfVxuXG5cbiAgdmlzaXRJZGVudGlmaWVyID0gKGNvbnRleHQ6IFBhcnNlci5JZGVudGlmaWVyQ29udGV4dCwgb3B0aW9uYWwgPSBmYWxzZSk6IFBhcnRpYWw8SWRlbnRpZmllck5vZGU+ID0+IHtcbiAgICBpZiAoY29udGV4dC5JRCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlSWRlbnRpZmllck5vZGUoY29udGV4dC5JRCgpLnRleHQsIG9wdGlvbmFsLCBbXSk7XG4gICAgfVxuICB9XG5cbiAgLyogVHlwZSB2aXNpdG9yICovXG5cbiAgdmlzaXRUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5UeXBlQ29udGV4dCB8IFBhcnNlci5Ob3RBcnJheVR5cGVDb250ZXh0LCBvcHRpb25hbCA9IGZhbHNlKTogUGFydGlhbDxUeXBlTm9kZT4gPT4ge1xuXG4gICAgLy8gSW50ZXJzZWN0aW9uc1xuICAgIGlmIChjb250ZXh0LlBJUEUoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICBjcmVhdGVJbnRlcnNlY3RUeXBlTm9kZShcbiAgICAgICAgICB0aGlzLnZpc2l0VHlwZShjb250ZXh0IGluc3RhbmNlb2YgUGFyc2VyLlR5cGVDb250ZXh0ID8gY29udGV4dC50eXBlKDApOiBjb250ZXh0Lm5vdEFycmF5VHlwZSgwKSksXG4gICAgICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dCBpbnN0YW5jZW9mIFBhcnNlci5UeXBlQ29udGV4dCA/IGNvbnRleHQudHlwZSgxKTogY29udGV4dC5ub3RBcnJheVR5cGUoMSkpLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICAgKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuQU1QKCkpIHsgLy8gVW5pb25zXG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIGNyZWF0ZVVuaW9uVHlwZU5vZGUoXG4gICAgICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dCBpbnN0YW5jZW9mIFBhcnNlci5UeXBlQ29udGV4dCA/IGNvbnRleHQudHlwZSgwKTogY29udGV4dC5ub3RBcnJheVR5cGUoMCkpLFxuICAgICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQgaW5zdGFuY2VvZiBQYXJzZXIuVHlwZUNvbnRleHQgPyBjb250ZXh0LnR5cGUoMSk6IGNvbnRleHQubm90QXJyYXlUeXBlKDEpKSxcbiAgICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICAgICksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmxhbWJkYVR5cGUoKSkgeyAvLyBMYW1iZGEgZnVuY3Rpb25zIGkuZS4gKGlkKSA9PiB0eXBlXG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRMYW1iZGFUeXBlKGNvbnRleHQubGFtYmRhVHlwZSgpKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQudHVwbGVUeXBlKCkpIHsgLy8gaWQ8dHlwZSwgdHlwZT5cbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdFR1cGxlKGNvbnRleHQudHVwbGVUeXBlKCkpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5wcmltYXJ5VHlwZSgpKSB7IC8vIFByaW1hcnlcbiAgICAgIHJldHVybiBjcmVhdGVUeXBlTm9kZShcbiAgICAgICAgdGhpcy52aXNpdFByaW1hcnlUeXBlKGNvbnRleHQucHJpbWFyeVR5cGUoKSksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnBhcmVudGhlc2l6ZWRUeXBlKCkpIHsgLy8gKGV4cHJlc3Npb24pXG4gICAgICByZXR1cm4gY3JlYXRlVHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRQYXJlbnRoZXNpemVkVHlwZShjb250ZXh0LnBhcmVudGhlc2l6ZWRUeXBlKCksIG9wdGlvbmFsKSxcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC51bmFyeVR5cGUoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0VW5hcnlUeXBlKGNvbnRleHQudW5hcnlUeXBlKCkpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5vYmplY3RUeXBlKCkpIHsgLy8geyAuLi4gfVxuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0T2JqZWN0VHlwZShjb250ZXh0Lm9iamVjdFR5cGUoKSksXG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0IGluc3RhbmNlb2YgUGFyc2VyLlR5cGVDb250ZXh0ICYmIGNvbnRleHQuYXJyYXlUeXBlKCkpIHsgLy8gWyAuLi4gXVxuICAgICAgcmV0dXJuIGNyZWF0ZVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0QXJyYXlUeXBlKGNvbnRleHQuYXJyYXlUeXBlKCkpLFxuICAgICAgICBvcHRpb25hbCxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKiBMYW1iZGEgdmlzaXRvciAqL1xuXG4gIHZpc2l0TGFtYmRhVHlwZSA9IChjb250ZXh0OiBQYXJzZXIuTGFtYmRhVHlwZUNvbnRleHQpOiBQYXJ0aWFsPExhbWJkYVR5cGVOb2RlPiA9PiB7XG4gICAgaWYgKGNvbnRleHQuZm9ybWFsUGFyYW1ldGVyU2VxdWVuY2UoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxhbWJkYVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0TGFtYmRhRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2UoY29udGV4dC5mb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZSgpKSxcbiAgICAgICAgdGhpcy52aXNpdFR5cGUoY29udGV4dC50eXBlKCksICEhY29udGV4dC5RVUVTVElPTigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcblxuICAgIH0gZWxzZSBpZiAoY29udGV4dC5wYXJhbWV0ZXIoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxhbWJkYVR5cGVOb2RlKFxuICAgICAgICB0aGlzLnZpc2l0TGFtYmRhRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2UoY29udGV4dC5wYXJhbWV0ZXIoKSksXG4gICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQudHlwZSgpLCAhIWNvbnRleHQuUVVFU1RJT04oKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZUxhbWJkYVR5cGVOb2RlKFxuICAgICAgbnVsbCxcbiAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQudHlwZSgpLCAhIWNvbnRleHQuUVVFU1RJT04oKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cbiAgdmlzaXRMYW1iZGFGb3JtYWxQYXJhbWV0ZXJTZXF1ZW5jZSA9IChjb250ZXh0OiBQYXJzZXIuRm9ybWFsUGFyYW1ldGVyU2VxdWVuY2VDb250ZXh0IHwgUGFyc2VyLlBhcmFtZXRlckNvbnRleHQpOiBQYXJ0aWFsPEZvcm1hbFBhcmFtZXRlclNlcXVlbmNlTm9kZT4gPT4ge1xuICAgIGlmIChjb250ZXh0IGluc3RhbmNlb2YgUGFyc2VyLlBhcmFtZXRlckNvbnRleHQpIHtcbiAgICAgIHJldHVybiBjcmVhdGVGb3JtYWxQYXJlbWV0ZXJTZXF1ZW5jZU5vZGUoW3RoaXMudmlzaXRQYXJhbWV0ZXIoY29udGV4dCldKVxuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlRm9ybWFsUGFyZW1ldGVyU2VxdWVuY2VOb2RlKHRoaXMudmlzaXRQYXJhbWV0ZXJzKGNvbnRleHQucGFyYW1ldGVyKCkpLCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKVxuICB9XG5cbiAgdmlzaXRQYXJhbWV0ZXJzID0gKGNvbnRleHRzOiBQYXJzZXIuUGFyYW1ldGVyQ29udGV4dFtdKTogUGFydGlhbDxQYXJhbWV0ZXJOb2RlPltdID0+IHtcbiAgICByZXR1cm4gY29udGV4dHMubWFwKGNvbnRleHQgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRQYXJhbWV0ZXIoY29udGV4dCk7XG4gICAgfSlcbiAgfVxuXG4gIHZpc2l0UGFyYW1ldGVyID0gKGNvbnRleHQ6IFBhcnNlci5QYXJhbWV0ZXJDb250ZXh0KTogUGFydGlhbDxQYXJhbWV0ZXJOb2RlPiA9PiB7XG4gICAgbGV0IGlkZW50aWZpZXIgPSB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSk7XG4gICAgbGV0IHR5cGU6IFR5cGVOb2RlXG4gICAgaWYgKGNvbnRleHQudHlwZSgpKSB7XG4gICAgICB0eXBlID0gdGhpcy52aXNpdFR5cGUoY29udGV4dC50eXBlKCkpO1xuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlUGFyYW1ldGVyTm9kZShpZGVudGlmaWVyLCB0eXBlLCB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHZpc2l0VHVwbGUgPSAoY29udGV4dDogUGFyc2VyLlR1cGxlVHlwZUNvbnRleHQpOiBQYXJ0aWFsPFR1cGxlVHlwZU5vZGU+ID0+IHtcbiAgICBsZXQgaWRlbnRpZmllcjogUGFydGlhbDxJZGVudGlmaWVyTm9kZT5cbiAgICBsZXQgdHlwZXM6IFBhcnRpYWw8VHlwZU5vZGU+W11cbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIGlkZW50aWZpZXIgPSB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQudHVwbGVUeXBlU2VxdWVuY2UoKSkge1xuICAgICAgdHlwZXMgPSB0aGlzLnZpc2l0VHVwbGVTZXF1ZW5jZVR5cGUoY29udGV4dC50dXBsZVR5cGVTZXF1ZW5jZSgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlVHVwbGVUeXBlTm9kZShpZGVudGlmaWVyLCB0eXBlcywgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdFR1cGxlU2VxdWVuY2VUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5UdXBsZVR5cGVTZXF1ZW5jZUNvbnRleHQpOiBQYXJ0aWFsPFR5cGVOb2RlPltdIHwgdW5kZWZpbmVkW10gPT4ge1xuICAgIHJldHVybiAoY29udGV4dC50eXBlKCkgfHwgW10pLm1hcCh0eXBlID0+IHRoaXMudmlzaXRUeXBlKHR5cGUpKTtcbiAgfVxuXG4gIHZpc2l0UHJpbWFyeVR5cGUgPSAoY29udGV4dDogUGFyc2VyLlByaW1hcnlUeXBlQ29udGV4dCk6IFBhcnRpYWw8UHJpbWFyeVR5cGVOb2RlPiA9PiB7XG5cbiAgICBsZXQgcHJpbWFyeTogUGFydGlhbDxJZGVudGlmaWVyTm9kZT4gfCBQYXJ0aWFsPEtleXdvcmROb2RlPiB8IFBhcnRpYWw8UHJvcGVydHlJZGVudGlmaWVyTm9kZT47XG5cbiAgICBpZiAoY29udGV4dC5vcHRpb25hbElkZW50aWZpZXIoKSkge1xuICAgICAgcHJpbWFyeSA9IHRoaXMudmlzaXRPcHRpb25hbElkZW50aWZpZXIoY29udGV4dC5vcHRpb25hbElkZW50aWZpZXIoKSk7XG4gICAgfSBlbHNlIGlmIChjb250ZXh0LmlkZW50aWZpZXJPcktleXdvcmQoKSkge1xuICAgICAgcHJpbWFyeSA9IHRoaXMudmlzaXRJZGVudGlmaWVyT3JLZXl3b3JkKGNvbnRleHQuaWRlbnRpZmllck9yS2V5d29yZCgpKVxuICAgIH0gZWxzZSBpZiAoY29udGV4dC5wcm9wZXJ0eUlkZW50aWZpZXIoKSkge1xuICAgICAgcHJpbWFyeSA9IHRoaXMudmlzaXRQcm9wZXJ0eUlkZW50aWZpZXIoY29udGV4dC5wcm9wZXJ0eUlkZW50aWZpZXIoKSk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVQcmltYXJ5VHlwZU5vZGUocHJpbWFyeSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdElkZW50aWZpZXJPcktleXdvcmQgPSAoY29udGV4dDogUGFyc2VyLklkZW50aWZpZXJPcktleXdvcmRDb250ZXh0KTogUGFydGlhbDwoSWRlbnRpZmllck5vZGUgfCBLZXl3b3JkTm9kZSk+ID0+IHtcbiAgICBpZiAoY29udGV4dC5pZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0SWRlbnRpZmllcihjb250ZXh0LmlkZW50aWZpZXIoKSlcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5rZXl3b3JkKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0S2V5d29yZChjb250ZXh0LmtleXdvcmQoKSlcbiAgICB9XG4gIH1cblxuICB2aXNpdEtleXdvcmQgPSAoY29udGV4dDogUGFyc2VyLktleXdvcmRDb250ZXh0KTogS2V5d29yZE5vZGUgPT4ge1xuICAgIGlmIChjb250ZXh0Lk51bGxMaXRlcmFsKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVLZXl3b3JkTm9kZShjb250ZXh0Lk51bGxMaXRlcmFsKCkudGV4dCk7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRQYXJlbnRoZXNpemVkVHlwZSA9IChjb250ZXh0OiBQYXJzZXIuUGFyZW50aGVzaXplZFR5cGVDb250ZXh0LCBvcHRpb25hbCA9IGZhbHNlKTogUGFydGlhbDxQYXJlbnRoZXNpemVkVHlwZU5vZGU+ID0+IHtcbiAgICBpZiAoY29udGV4dC50eXBlKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVQYXJlbnRoZXNpemVkVHlwZU5vZGUodGhpcy52aXNpdFR5cGUoY29udGV4dC50eXBlKCkpLCBvcHRpb25hbCwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRVbmFyeVR5cGUgPSAoY29udGV4dDogUGFyc2VyLlVuYXJ5VHlwZUNvbnRleHQpOiBQYXJ0aWFsPFVuYXJ5VHlwZU5vZGU+ID0+IHtcbiAgICByZXR1cm4gY3JlYXRlVW5hcnlUeXBlTm9kZShcbiAgICAgIChjb250ZXh0LkFNUCgpIHx8IGNvbnRleHQuU1RBUigpKS50ZXh0LFxuICAgICAgdGhpcy52aXNpdFByaW1hcnlUeXBlKGNvbnRleHQucHJpbWFyeVR5cGUoKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKTtcbiAgfVxuXG4gIHZpc2l0T2JqZWN0VHlwZSA9IChjb250ZXh0OiBQYXJzZXIuT2JqZWN0VHlwZUNvbnRleHQpOiBQYXJ0aWFsPE9iamVjdFR5cGVOb2RlPiA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZU9iamVjdFR5cGVOb2RlKHRoaXMudmlzaXRPYmplY3RQYWlyU2VxdWVuY2VUeXBlKGNvbnRleHQub2JqZWN0UGFpclNlcXVlbmNlVHlwZSgpKSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZCk7XG4gIH1cblxuICB2aXNpdE9iamVjdFBhaXJTZXF1ZW5jZVR5cGUgPSAoY29udGV4dDogUGFyc2VyLk9iamVjdFBhaXJTZXF1ZW5jZVR5cGVDb250ZXh0KSA9PiB7XG4gICAgcmV0dXJuIChjb250ZXh0ID8gY29udGV4dC5vYmplY3RQYWlyVHlwZSgpIDogW10pLm1hcChwYWlyID0+IHtcbiAgICAgIHJldHVybiBjcmVhdGVPYmplY3RQYWlyVHlwZU5vZGUodGhpcy52aXNpdFR5cGUocGFpci50eXBlKDApKSwgdGhpcy52aXNpdFR5cGUocGFpci50eXBlKDEpKSwgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IHBhaXIudGV4dCA6IHVuZGVmaW5lZClcbiAgICB9KTtcbiAgfVxuXG4gIHZpc2l0QXJyYXlUeXBlID0gKGNvbnRleHQ6IFBhcnNlci5BcnJheVR5cGVDb250ZXh0KTogUGFydGlhbDxBcnJheVR5cGVOb2RlPiA9PiB7XG5cbiAgICBpZiAoY29udGV4dC5ub3RBcnJheVR5cGUoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUFycmF5VHlwZU5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRUeXBlKGNvbnRleHQubm90QXJyYXlUeXBlKCkpLFxuICAgICAgICAoY29udGV4dC50eXBlKCkgfHwgW10pLm1hcCh0eXBlID0+IHRoaXMudmlzaXRUeXBlKHR5cGUpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUFycmF5VHlwZU5vZGUoXG4gICAgICBudWxsLFxuICAgICAgKGNvbnRleHQudHlwZSgpIHx8IFtdKS5tYXAodHlwZSA9PiB0aGlzLnZpc2l0VHlwZSh0eXBlKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cbiAgdmlzaXRQcm9wZXJ0eUlkZW50aWZpZXIgPSAoY29udGV4dDogUGFyc2VyLlByb3BlcnR5SWRlbnRpZmllckNvbnRleHQpOiBQYXJ0aWFsPFByb3BlcnR5SWRlbnRpZmllck5vZGU+ID0+IHtcblxuICAgIC8vIEFzc3VtZSAnY29udGV4dCcgaXMgZGVmaW5lZC5cbiAgICBsZXQgaWRlbnRpZmllciA9IGNvbnRleHQuaWRlbnRpZmllcigpID9cbiAgICAgIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpKSA6XG4gICAgICB0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpO1xuICAgIC8vIEEgcHJvcGVydHkgbXVzdCBleGlzdCBzaW5jZSBieSBncmFtbWFyOlxuICAgIC8vIChvcHRpb25hbElkZW50aWZpZXIgfCBpZGVudGlmaWVyKSAoJy4nIG9wdGlvbmFsSWRlbnRpZmllck9ySWRlbnRpZmllcikrXG4gICAgbGV0IHByb3BlcnR5ID0gY29udGV4dC5vcHRpb25hbElkZW50aWZpZXJPcklkZW50aWZpZXIoKVxuICAgICAgLm1hcCh0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyT3JJZGVudGlmaWVyKTtcbiAgICAvLyBBZGQgdGhlIGlkZW50aWZpZXIgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgYXJyYXlcbiAgICBwcm9wZXJ0eS51bnNoaWZ0KGlkZW50aWZpZXIpO1xuICAgIHJldHVybiBjcmVhdGVQcm9wZXJ0eUlkZW50aWZpZXJOb2RlKHByb3BlcnR5LCBjb250ZXh0LnRleHQpXG4gIH1cblxuICB2aXNpdE9wdGlvbmFsSWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuT3B0aW9uYWxJZGVudGlmaWVyQ29udGV4dCk6IFBhcnRpYWw8T3B0aW9uYWxJZGVudGlmaWVyTm9kZT4gPT4ge1xuICAgIGlmIChjb250ZXh0LmlkZW50aWZpZXIoKSkge1xuICAgICAgcmV0dXJuIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaWRlbnRpZmllcigpLCAhIWNvbnRleHQuUVVFU1RJT04oKSlcbiAgICB9XG4gIH1cblxuICB2aXNpdE9wdGlvbmFsSWRlbnRpZmllck9ySWRlbnRpZmllciA9IChjb250ZXh0OiBQYXJzZXIuT3B0aW9uYWxJZGVudGlmaWVyT3JJZGVudGlmaWVyQ29udGV4dCk6IFBhcnRpYWw8T3B0aW9uYWxJZGVudGlmaWVyTm9kZT4gfCBQYXJ0aWFsPElkZW50aWZpZXJOb2RlPiA9PiB7XG4gICAgaWYgKGNvbnRleHQuaWRlbnRpZmllcigpKSB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdElkZW50aWZpZXIoY29udGV4dC5pZGVudGlmaWVyKCkpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnZpc2l0T3B0aW9uYWxJZGVudGlmaWVyKGNvbnRleHQub3B0aW9uYWxJZGVudGlmaWVyKCkpXG4gICAgfVxuICB9XG5cbiAgLyogRXhwcmVzc2lvbiB2aXNpdG9yICovXG5cbiAgdmlzaXRFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5FeHByZXNzaW9uQ29udGV4dCk6IFBhcnRpYWw8RXhwcmVzc2lvbk5vZGU+ID0+IHtcbiAgICBpZiAoY29udGV4dC51bmFyeUV4cHJlc3Npb24oKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUV4cHJlc3Npb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0VW5hcnlFeHByZXNzaW9uKGNvbnRleHQudW5hcnlFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuZXhwcmVzc2lvbigpLmxlbmd0aCA+IDEpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgY3JlYXRlQmluYXJ5RXhwcmVzc2lvbk5vZGUoXG4gICAgICAgICAgKGNvbnRleHQuUExVUygpIHx8IGNvbnRleHQuTUlOVVMoKSB8fCBjb250ZXh0LlNUQVIoKSB8fCBjb250ZXh0LkZPUldBUkRfU0xBU0goKSkudGV4dCxcbiAgICAgICAgICB0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oMCkpLFxuICAgICAgICAgIHRoaXMudmlzaXRFeHByZXNzaW9uKGNvbnRleHQuZXhwcmVzc2lvbigxKSksXG4gICAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgICApLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQuYXJyYXlFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgY3JlYXRlQXJyYXlFeHByZXNzaW9uTm9kZShcbiAgICAgICAgICB0aGlzLnZpc2l0QXJyYXlFeHByZXNzaW9uKGNvbnRleHQuYXJyYXlFeHByZXNzaW9uKCkpLFxuICAgICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LmFycmF5RXhwcmVzc2lvbigpLnRleHQgOiB1bmRlZmluZWRcbiAgICAgICAgKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5vYmplY3RFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdE9iamVjdEV4cHJlc3Npb24oY29udGV4dC5vYmplY3RFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQubGFtYmRhRXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRMYW1iZGFFeHByZXNzaW9uKGNvbnRleHQubGFtYmRhRXhwcmVzc2lvbigpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmxpdGVyYWxFeHByZXNzaW9uKCkpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFeHByZXNzaW9uTm9kZShcbiAgICAgICAgdGhpcy52aXNpdExpdGVyYWxFeHByZXNzaW9uKGNvbnRleHQubGl0ZXJhbEV4cHJlc3Npb24oKSksXG4gICAgICAgIHRoaXMub3B0aW9ucy5zaG93Tm9kZVRleHQgPyBjb250ZXh0LnRleHQgOiB1bmRlZmluZWRcbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dC5wYXJlbnRoZXNpemVkRXhwcmVzc2lvbigpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXhwcmVzc2lvbk5vZGUoXG4gICAgICAgIHRoaXMudmlzaXRQYXJlbnRoZXNpemVkRXhwcmVzc2lvbihjb250ZXh0LnBhcmVudGhlc2l6ZWRFeHByZXNzaW9uKCkpLFxuICAgICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgdmlzaXRVbmFyeUV4cHJlc3Npb24gPSAoY29udGV4dDogUGFyc2VyLlVuYXJ5RXhwcmVzc2lvbkNvbnRleHQpOiBQYXJ0aWFsPFVuYXJ5RXhwcmVzc2lvbk5vZGU+ID0+IHtcbiAgICByZXR1cm4gY3JlYXRlVW5hcnlFeHByZXNzaW9uTm9kZShcbiAgICAgIChjb250ZXh0LlBMVVMoKSB8fCBjb250ZXh0Lk1JTlVTKCkpLnRleHQsXG4gICAgICB0aGlzLnZpc2l0RXhwcmVzc2lvbihjb250ZXh0LmV4cHJlc3Npb24oKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cbiAgdmlzaXRBcnJheUV4cHJlc3Npb24gPSAoY29udGV4dDogUGFyc2VyLkFycmF5RXhwcmVzc2lvbkNvbnRleHQpOiBQYXJ0aWFsPEV4cHJlc3Npb25Ob2RlPltdID0+IHtcbiAgICByZXR1cm4gKGNvbnRleHQgPyBjb250ZXh0LmV4cHJlc3Npb24oKSA6IFtdKS5tYXAoZXhwcmVzc2lvbiA9PiB7XG4gICAgICByZXR1cm4gdGhpcy52aXNpdEV4cHJlc3Npb24oZXhwcmVzc2lvbilcbiAgICB9KVxuICB9XG5cbiAgdmlzaXRPYmplY3RFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5PYmplY3RFeHByZXNzaW9uQ29udGV4dCk6IFBhcnRpYWw8T2JqZWN0RXhwcmVzc2lvbk5vZGU+ID0+IHtcbiAgICByZXR1cm4gY3JlYXRlT2JqZWN0RXhwcmVzc2lvbk5vZGUoXG4gICAgICB0aGlzLnZpc2l0T2JqZWN0UGFpclNlcXVlbmNlRXhwcmVzc2lvbihjb250ZXh0Lm9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb24oKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKVxuICB9XG5cblxuICB2aXNpdE9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb24gPSAoY29udGV4dDogUGFyc2VyLk9iamVjdFBhaXJTZXF1ZW5jZUV4cHJlc3Npb25Db250ZXh0KTogUGFydGlhbDxPYmplY3RQYWlyRXhwcmVzc2lvbk5vZGU+W10gPT4ge1xuICAgIHJldHVybiAoY29udGV4dCA/IGNvbnRleHQub2JqZWN0UGFpckV4cHJlc3Npb24oKSA6IFtdKS5tYXAocGFpciA9PiB7XG4gICAgICByZXR1cm4gY3JlYXRlT2JqZWN0UGFpckV4cHJlc3Npb25Ob2RlKFxuICAgICAgICB0aGlzLnZpc2l0TGl0ZXJhbEV4cHJlc3Npb24ocGFpci5saXRlcmFsRXhwcmVzc2lvbigwKSksXG4gICAgICAgIHBhaXIub2JqZWN0RXhwcmVzc2lvbigpID9cbiAgICAgICAgICB0aGlzLnZpc2l0T2JqZWN0RXhwcmVzc2lvbihwYWlyLm9iamVjdEV4cHJlc3Npb24oKSkgOlxuICAgICAgICAgIHRoaXMudmlzaXRMaXRlcmFsRXhwcmVzc2lvbihwYWlyLmxpdGVyYWxFeHByZXNzaW9uKDEpKSxcbiAgICAgICAgdGhpcy5vcHRpb25zLnNob3dOb2RlVGV4dCA/IGNvbnRleHQudGV4dCA6IHVuZGVmaW5lZFxuICAgICAgKVxuICAgIH0pO1xuICB9XG5cbiAgdmlzaXRMYW1iZGFFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5MYW1iZGFFeHByZXNzaW9uQ29udGV4dCk6IFBhcnRpYWw8TGFtYmRhRXhwcmVzc2lvbk5vZGU+ID0+IHtcbiAgICByZXR1cm4gdGhpcy52aXNpdExhbWJkYVR5cGUoY29udGV4dCk7XG4gIH1cblxuICB2aXNpdFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5QYXJlbnRoZXNpemVkRXhwcmVzc2lvbkNvbnRleHQpOiBQYXJ0aWFsPFBhcmVudGhlc2l6ZWRFeHByZXNzaW9uTm9kZT4gPT4ge1xuICAgIHJldHVybiBjcmVhdGVQYXJlbnRoZXNpemVkRXhwcmVzc2lvbmVOb2RlKHRoaXMudmlzaXRFeHByZXNzaW9uKGNvbnRleHQuZXhwcmVzc2lvbigpKSk7XG4gIH1cblxuICB2aXNpdExpdGVyYWxFeHByZXNzaW9uID0gKGNvbnRleHQ6IFBhcnNlci5MaXRlcmFsRXhwcmVzc2lvbkNvbnRleHQpOiBQYXJ0aWFsPExpdGVyYWxFeHByZXNzaW9uTm9kZT4gPT4ge1xuICAgIGxldCBub2RlID0geyBsaXRlcmFsOiB7fSB9XG4gICAgaWYgKGNvbnRleHQuTnVtYmVyTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKFxuICAgICAgICAnbnVtYmVyJyxcbiAgICAgICAgY29udGV4dC5OdW1iZXJMaXRlcmFsKCkudGV4dFxuICAgICAgKVxuICAgIH1cbiAgICBpZiAoY29udGV4dC5Cb29sZWFuTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKCdib29sZWFuJywgY29udGV4dC5Cb29sZWFuTGl0ZXJhbCgpLnRleHQpXG4gICAgfVxuICAgIGlmIChjb250ZXh0LkNoYXJhY3RlckxpdGVyYWwoKSkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUxpdGVyYWxFeHByZXNzaW9uTm9kZSgnY2hhcmFjdGVyJywgY29udGV4dC5DaGFyYWN0ZXJMaXRlcmFsKCkudGV4dClcbiAgICB9XG4gICAgaWYgKGNvbnRleHQuU3RyaW5nTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKCdzdHJpbmcnLCBjb250ZXh0LlN0cmluZ0xpdGVyYWwoKS50ZXh0KVxuICAgIH1cbiAgICBpZiAoY29udGV4dC5OdWxsTGl0ZXJhbCgpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTGl0ZXJhbEV4cHJlc3Npb25Ob2RlKCdudWxsJywgY29udGV4dC5OdWxsTGl0ZXJhbCgpLnRleHQpXG4gICAgfVxuICB9XG5cbiAgLyogRGVzY3JpcHRpb24gdmlzaXRvciAqL1xuXG4gIHZpc2l0RGVzY3JpcHRpb24gPSAoY29udGV4dDogUGFyc2VyLkRlc2NyaXB0aW9uQ29udGV4dCk6IFBhcnRpYWw8RGVzY3JpcHRpb25Ob2RlPiA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZURlc2NyaXB0aW9uTm9kZShcbiAgICAgIGNvbnRleHQudGV4dCxcbiAgICAgIHRoaXMudmlzaXREZXNjcmlwdGlvbkxpbmUoY29udGV4dC5kZXNjcmlwdGlvbkxpbmUoKSlcbiAgICApXG4gIH1cblxuICB2aXNpdERlc2NyaXB0aW9uTGluZSA9IChjb250ZXh0OiBQYXJzZXIuRGVzY3JpcHRpb25MaW5lQ29udGV4dCk6IFBhcnRpYWw8SW5saW5lVGFnTm9kZT5bXSA9PiB7XG4gICAgcmV0dXJuIHRoaXMudmlzaXREZXNjcmlwdGlvbkxpbmVFbGVtZW50KGNvbnRleHQuZGVzY3JpcHRpb25MaW5lRWxlbWVudCgpKTtcbiAgfVxuXG4gIHZpc2l0RGVzY3JpcHRpb25MaW5lRWxlbWVudCA9IChjb250ZXh0OiBQYXJzZXIuRGVzY3JpcHRpb25MaW5lRWxlbWVudENvbnRleHRbXSk6IFBhcnRpYWw8SW5saW5lVGFnTm9kZT5bXSA9PiB7XG4gICAgcmV0dXJuIChjb250ZXh0IHx8IFtdKS5tYXAoZWxlbWVudCA9PiB7XG4gICAgICByZXR1cm4gZWxlbWVudC5pbmxpbmVUYWcoKSA/IHRoaXMudmlzaXRJbmxpbmVUYWcoZWxlbWVudC5pbmxpbmVUYWcoKSkgOiB1bmRlZmluZWRcbiAgICB9KS5maWx0ZXIoZWxlbWVudCA9PiBlbGVtZW50ICE9PSB1bmRlZmluZWQpO1xuICB9XG5cbiAgdmlzaXRJbmxpbmVUYWcgPSAoY29udGV4dDogUGFyc2VyLklubGluZVRhZ0NvbnRleHQpOiBQYXJ0aWFsPElubGluZVRhZ05vZGU+ID0+IHtcbiAgICByZXR1cm4gY3JlYXRlSW5saW5lVGFnTm9kZShcbiAgICAgIHRoaXMudmlzaXRJZGVudGlmaWVyKGNvbnRleHQuaW5saW5lVGFnTmFtZSgpLmlkZW50aWZpZXIoKSksXG4gICAgICB0aGlzLnZpc2l0SW5saW5lVGFnQm9keShjb250ZXh0LmlubGluZVRhZ0JvZHkoKSksXG4gICAgICB0aGlzLm9wdGlvbnMuc2hvd05vZGVUZXh0ID8gY29udGV4dC50ZXh0IDogdW5kZWZpbmVkXG4gICAgKTtcbiAgfVxuXG4gIHZpc2l0SW5saW5lVGFnQm9keSA9IChjb250ZXh0OiBQYXJzZXIuSW5saW5lVGFnQm9keUNvbnRleHQpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBjb250ZXh0LmJyYWNlQm9keSgpLm1hcChib2R5ID0+IGJvZHkudGV4dCkuam9pbignJyk7XG4gIH1cbn0iXX0=